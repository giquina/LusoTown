{"version":3,"sources":["/workspaces/LusoTown/web-app/src/hooks/useAriaAnnouncements.ts"],"sourcesContent":["'use client'\n\nimport { useEffect, useRef } from 'react'\nimport { useLanguage } from '@/context/LanguageContext'\n\nexport interface AriaAnnouncementOptions {\n  priority?: 'polite' | 'assertive'\n  delay?: number\n  clearOnUnmount?: boolean\n  bilingual?: boolean\n}\n\nexport interface BilingualMessage {\n  en: string\n  pt: string\n}\n\n/**\n * Custom hook for managing ARIA live region announcements\n * Supports bilingual announcements for Portuguese-speaking community\n */\nexport function useAriaAnnouncements() {\n  const { language } = useLanguage()\n  const liveRegionRef = useRef<HTMLDivElement | null>(null)\n  const timeoutRef = useRef<NodeJS.Timeout | null>(null)\n\n  useEffect(() => {\n    // Create live region if it doesn't exist\n    if (!liveRegionRef.current) {\n      const liveRegion = document.createElement('div')\n      liveRegion.id = 'lusotown-aria-live-region'\n      liveRegion.setAttribute('aria-live', 'polite')\n      liveRegion.setAttribute('aria-atomic', 'true')\n      liveRegion.className = 'sr-only'\n      liveRegion.style.cssText = `\n        position: absolute !important;\n        width: 1px !important;\n        height: 1px !important;\n        padding: 0 !important;\n        margin: -1px !important;\n        overflow: hidden !important;\n        clip: rect(0,0,0,0) !important;\n        white-space: nowrap !important;\n        border: 0 !important;\n      `\n      document.body.appendChild(liveRegion)\n      liveRegionRef.current = liveRegion\n    }\n\n    return () => {\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current)\n      }\n    }\n  }, [])\n\n  const announce = (\n    message: string | BilingualMessage,\n    options: AriaAnnouncementOptions = {}\n  ) => {\n    const {\n      priority = 'polite',\n      delay = 100,\n      bilingual = false\n    } = options\n\n    if (!liveRegionRef.current) return\n\n    // Clear any pending announcements\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current)\n    }\n\n    const liveRegion = liveRegionRef.current\n    \n    // Update live region priority if needed\n    if (liveRegion.getAttribute('aria-live') !== priority) {\n      liveRegion.setAttribute('aria-live', priority)\n    }\n\n    // Determine message text\n    let messageText: string\n    if (typeof message === 'string') {\n      messageText = message\n    } else {\n      messageText = language === 'pt' ? message.pt : message.en\n      // If bilingual is enabled, announce in both languages\n      if (bilingual) {\n        messageText = `${message.en}. ${message.pt}`\n      }\n    }\n\n    timeoutRef.current = setTimeout(() => {\n      if (liveRegion) {\n        // Clear first to ensure announcement\n        liveRegion.textContent = ''\n        // Small delay to ensure screen readers register the change\n        setTimeout(() => {\n          liveRegion.textContent = messageText\n        }, 50)\n      }\n    }, delay)\n  }\n\n  const announcePolite = (message: string | BilingualMessage, bilingual = false) => {\n    announce(message, { priority: 'polite', bilingual })\n  }\n\n  const announceAssertive = (message: string | BilingualMessage, bilingual = false) => {\n    announce(message, { priority: 'assertive', bilingual })\n  }\n\n  const clear = () => {\n    if (liveRegionRef.current) {\n      liveRegionRef.current.textContent = ''\n    }\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current)\n    }\n  }\n\n  return {\n    announce,\n    announcePolite,\n    announceAssertive,\n    clear\n  }\n}\n\n/**\n * Pre-defined announcement messages for common widget states\n */\nexport const ARIA_MESSAGES = {\n  widget: {\n    opened: {\n      en: 'Widget opened',\n      pt: 'Widget aberto'\n    },\n    closed: {\n      en: 'Widget closed',\n      pt: 'Widget fechado'\n    },\n    minimized: {\n      en: 'Widget minimized',\n      pt: 'Widget minimizado'\n    },\n    maximized: {\n      en: 'Widget maximized',\n      pt: 'Widget maximizado'\n    }\n  },\n  lusobot: {\n    opened: {\n      en: 'LusoBot chat assistant opened. Portuguese cultural assistant ready to help.',\n      pt: 'Assistente de chat LusoBot aberto. Assistente cultural português pronto para ajudar.'\n    },\n    closed: {\n      en: 'LusoBot chat assistant closed',\n      pt: 'Assistente de chat LusoBot fechado'\n    },\n    minimized: {\n      en: 'LusoBot chat minimized. Click to expand.',\n      pt: 'Chat LusoBot minimizado. Clique para expandir.'\n    },\n    messageSent: {\n      en: 'Message sent to LusoBot',\n      pt: 'Mensagem enviada para LusoBot'\n    },\n    messageReceived: {\n      en: 'New message from LusoBot received',\n      pt: 'Nova mensagem do LusoBot recebida'\n    }\n  },\n  appDownloadBar: {\n    shown: {\n      en: 'App download banner appeared. LusoTown mobile app is available.',\n      pt: 'Banner de download da app apareceu. App móvel LusoTown está disponível.'\n    },\n    dismissed: {\n      en: 'App download banner dismissed',\n      pt: 'Banner de download da app dispensado'\n    },\n    downloadStarted: {\n      en: 'App download started',\n      pt: 'Download da app iniciado'\n    }\n  },\n  culturalEvents: {\n    eventFocused: {\n      en: 'Cultural event focused. Press Enter to view details.',\n      pt: 'Evento cultural focado. Prima Enter para ver detalhes.'\n    },\n    eventSelected: {\n      en: 'Event selected. Details panel opened.',\n      pt: 'Evento selecionado. Painel de detalhes aberto.'\n    },\n    favoriteAdded: {\n      en: 'Event added to favorites',\n      pt: 'Evento adicionado aos favoritos'\n    },\n    favoriteRemoved: {\n      en: 'Event removed from favorites',\n      pt: 'Evento removido dos favoritos'\n    },\n    reminderSet: {\n      en: 'Reminder set for this event',\n      pt: 'Lembrete definido para este evento'\n    }\n  },\n  navigation: {\n    menuOpened: {\n      en: 'Navigation menu opened',\n      pt: 'Menu de navegação aberto'\n    },\n    menuClosed: {\n      en: 'Navigation menu closed',\n      pt: 'Menu de navegação fechado'\n    },\n    pageChanged: {\n      en: 'Page changed',\n      pt: 'Página alterada'\n    }\n  },\n  forms: {\n    validationError: {\n      en: 'Form has validation errors. Please check the highlighted fields.',\n      pt: 'Formulário tem erros de validação. Verifique os campos destacados.'\n    },\n    submitted: {\n      en: 'Form submitted successfully',\n      pt: 'Formulário submetido com sucesso'\n    },\n    loading: {\n      en: 'Form is being processed, please wait',\n      pt: 'Formulário está sendo processado, aguarde'\n    }\n  },\n  palop: {\n    cardFocused: {\n      en: 'PALOP heritage card focused. Explore Portuguese-speaking nations culture.',\n      pt: 'Cartão de herança PALOP focado. Explore a cultura das nações lusófonas.'\n    },\n    ctaAvailable: {\n      en: 'Call to action buttons available. Press Tab to navigate.',\n      pt: 'Botões de chamada para ação disponíveis. Prima Tab para navegar.'\n    }\n  }\n} as const"],"names":["ARIA_MESSAGES","useAriaAnnouncements","language","useLanguage","liveRegionRef","useRef","timeoutRef","useEffect","current","liveRegion","document","createElement","id","setAttribute","className","style","cssText","body","appendChild","clearTimeout","announce","message","options","priority","delay","bilingual","getAttribute","messageText","pt","en","setTimeout","textContent","announcePolite","announceAssertive","clear","widget","opened","closed","minimized","maximized","lusobot","messageSent","messageReceived","appDownloadBar","shown","dismissed","downloadStarted","culturalEvents","eventFocused","eventSelected","favoriteAdded","favoriteRemoved","reminderSet","navigation","menuOpened","menuClosed","pageChanged","forms","validationError","submitted","loading","palop","cardFocused","ctaAvailable"],"mappings":"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"}