{"version":3,"sources":["/workspaces/LusoTown/web-app/src/components/SavedItemsButton.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { motion } from \"framer-motion\";\nimport Link from \"next/link\";\nimport { HeartIcon } from \"@heroicons/react/24/outline\";\nimport { HeartIcon as HeartSolidIcon } from \"@heroicons/react/24/solid\";\nimport { useCart } from \"@/context/CartContext\";\nimport { useLanguage } from \"@/context/LanguageContext\";\nimport { isAuthenticated, useAuthState as onAuthStateChange } from \"@/lib/auth\";\nimport { useAuthPopup } from \"@/components/AuthPopupProvider\";\n\ninterface SavedItemsButtonProps {\n  showCount?: boolean;\n  iconOnly?: boolean;\n  size?: \"small\" | \"medium\" | \"large\";\n  className?: string;\n}\n\nexport default function SavedItemsButton({\n  showCount = true,\n  iconOnly = true,\n  size = \"medium\",\n  className = \"\",\n}: SavedItemsButtonProps) {\n  const { savedCount } = useCart();\n  const { t, language } = useLanguage();\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const { showPopup } = useAuthPopup();\n\n  const isPortuguese = language === \"pt\";\n\n  useEffect(() => {\n    setIsLoggedIn(isAuthenticated());\n  }, []);\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChange((user) => {\n      setIsLoggedIn(!!user);\n    });\n    return unsubscribe;\n  }, []);\n\n  const handleFavoritesClick = (e: React.MouseEvent) => {\n    if (!isLoggedIn) {\n      e.preventDefault();\n      showPopup(\"view-details\", {\n        type: \"view-details\",\n        redirectPath: \"/saved\",\n      });\n    }\n  };\n\n  const getSizeClasses = () => {\n    switch (size) {\n      case \"small\":\n        return \"p-2\";\n      case \"large\":\n        return \"p-3\";\n      default:\n        return \"p-3\";\n    }\n  };\n\n  const getIconSize = () => {\n    switch (size) {\n      case \"small\":\n        return \"w-4 h-4\";\n      case \"large\":\n        return \"w-7 h-7\";\n      default:\n        return \"w-5 h-5 sm:w-6 sm:h-6\";\n    }\n  };\n\n  return (\n    <Link\n      href={isLoggedIn ? \"/saved\" : \"#\"}\n      onClick={handleFavoritesClick}\n      className={`relative text-gray-600 hover:text-primary-500 transition-colors group ${getSizeClasses()} ${className} min-h-[44px] min-w-[44px] flex items-center justify-center`}\n      title={\n        isLoggedIn\n          ? t(\"favorites.view-all\")\n          : isPortuguese\n          ? \"Clique para se registar\"\n          : \"Click to sign up\"\n      }\n    >\n      <motion.div\n        whileHover={{ scale: 1.05 }}\n        whileTap={{ scale: 0.95 }}\n        className=\"relative\"\n      >\n        {savedCount > 0 ? (\n          <HeartSolidIcon className={`${getIconSize()} text-action-500`} />\n        ) : (\n          <HeartIcon className={getIconSize()} />\n        )}\n\n        {/* Count Badge */}\n        {showCount && savedCount > 0 && (\n          <motion.div\n            initial={{ scale: 0 }}\n            animate={{ scale: 1 }}\n            className=\"absolute -top-1 -right-1 bg-action-500 text-white text-xs rounded-full min-w-[18px] h-[18px] flex items-center justify-center font-bold\"\n          >\n            {savedCount > 99 ? \"99+\" : savedCount}\n          </motion.div>\n        )}\n\n        {/* Tooltip */}\n        <div className=\"absolute top-full mt-2 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white text-xs px-3 py-2 rounded shadow-lg whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50\">\n          {isLoggedIn\n            ? savedCount > 0\n              ? `${savedCount} saved ${savedCount === 1 ? \"item\" : \"items\"}`\n              : t(\"favorites.view-all\")\n            : isPortuguese\n            ? \"Clique para se registar\"\n            : \"Click to sign up\"}\n          <div className=\"absolute -top-1 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-gray-900 rotate-45\"></div>\n        </div>\n      </motion.div>\n\n      {/* Label for non-icon-only mode */}\n      {!iconOnly && (\n        <span className=\"ml-2 font-medium text-sm\">{t(\"favorites.title\")}</span>\n      )}\n    </Link>\n  );\n}\n"],"names":["SavedItemsButton","showCount","iconOnly","size","className","savedCount","useCart","t","language","useLanguage","isLoggedIn","setIsLoggedIn","useState","showPopup","useAuthPopup","isPortuguese","useEffect","isAuthenticated","unsubscribe","onAuthStateChange","user","handleFavoritesClick","e","preventDefault","type","redirectPath","getSizeClasses","getIconSize","Link","href","onClick","title","motion","div","whileHover","scale","whileTap","HeartSolidIcon","HeartIcon","initial","animate","span"],"mappings":"AAAA;;;;;+BAmBA;;;eAAwBA;;;;uBAjBY;8BACb;6DACN;yBACS;uBACkB;6BACpB;iCACI;sBACuC;mCACtC;;;;;;AASd,SAASA,iBAAiB,EACvCC,YAAY,IAAI,EAChBC,WAAW,IAAI,EACfC,OAAO,QAAQ,EACfC,YAAY,EAAE,EACQ;IACtB,MAAM,EAAEC,UAAU,EAAE,GAAGC,IAAAA,oBAAO;IAC9B,MAAM,EAAEC,CAAC,EAAEC,QAAQ,EAAE,GAAGC,IAAAA,4BAAW;IACnC,MAAM,CAACC,YAAYC,cAAc,GAAGC,IAAAA,eAAQ,EAAC;IAC7C,MAAM,EAAEC,SAAS,EAAE,GAAGC,IAAAA,+BAAY;IAElC,MAAMC,eAAeP,aAAa;IAElCQ,IAAAA,gBAAS,EAAC;QACRL,cAAcM,IAAAA,qBAAe;IAC/B,GAAG,EAAE;IAELD,IAAAA,gBAAS,EAAC;QACR,MAAME,cAAcC,IAAAA,kBAAiB,EAAC,CAACC;YACrCT,cAAc,CAAC,CAACS;QAClB;QACA,OAAOF;IACT,GAAG,EAAE;IAEL,MAAMG,uBAAuB,CAACC;QAC5B,IAAI,CAACZ,YAAY;YACfY,EAAEC,cAAc;YAChBV,UAAU,gBAAgB;gBACxBW,MAAM;gBACNC,cAAc;YAChB;QACF;IACF;IAEA,MAAMC,iBAAiB;QACrB,OAAQvB;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF;IAEA,MAAMwB,cAAc;QAClB,OAAQxB;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF;IAEA,qBACE,sBAACyB,aAAI;QACHC,MAAMnB,aAAa,WAAW;QAC9BoB,SAAST;QACTjB,WAAW,CAAC,sEAAsE,EAAEsB,iBAAiB,CAAC,EAAEtB,UAAU,2DAA2D,CAAC;QAC9K2B,OACErB,aACIH,EAAE,wBACFQ,eACA,4BACA;;0BAGN,sBAACiB,oBAAM,CAACC,GAAG;gBACTC,YAAY;oBAAEC,OAAO;gBAAK;gBAC1BC,UAAU;oBAAED,OAAO;gBAAK;gBACxB/B,WAAU;;oBAETC,aAAa,kBACZ,qBAACgC,gBAAc;wBAACjC,WAAW,CAAC,EAAEuB,cAAc,gBAAgB,CAAC;uCAE7D,qBAACW,kBAAS;wBAAClC,WAAWuB;;oBAIvB1B,aAAaI,aAAa,mBACzB,qBAAC2B,oBAAM,CAACC,GAAG;wBACTM,SAAS;4BAAEJ,OAAO;wBAAE;wBACpBK,SAAS;4BAAEL,OAAO;wBAAE;wBACpB/B,WAAU;kCAETC,aAAa,KAAK,QAAQA;;kCAK/B,sBAAC4B;wBAAI7B,WAAU;;4BACZM,aACGL,aAAa,IACX,CAAC,EAAEA,WAAW,OAAO,EAAEA,eAAe,IAAI,SAAS,QAAQ,CAAC,GAC5DE,EAAE,wBACJQ,eACA,4BACA;0CACJ,qBAACkB;gCAAI7B,WAAU;;;;;;YAKlB,CAACF,0BACA,qBAACuC;gBAAKrC,WAAU;0BAA4BG,EAAE;;;;AAItD"}