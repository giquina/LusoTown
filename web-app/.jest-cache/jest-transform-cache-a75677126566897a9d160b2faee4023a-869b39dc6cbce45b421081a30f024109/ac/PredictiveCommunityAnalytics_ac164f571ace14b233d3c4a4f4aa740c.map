{"version":3,"sources":["/workspaces/LusoTown/web-app/src/lib/ai/PredictiveCommunityAnalytics.ts"],"sourcesContent":["/**\n * PredictiveCommunityAnalytics.ts\n * Production-Ready Luxury Portuguese-speaking community Analytics\n * \n * Sophisticated ML system for predicting Lusophone diaspora trends in London,\n * optimizing luxury event success, analyzing culturally-aware behavior patterns,\n * providing actionable insights for premium community growth,\n * and ensuring GDPR compliance for Portuguese-speaking community data.\n * \n * Built for luxury Portuguese-speaking community platform with advanced privacy controls.\n * @version 2.0.0\n * @production-ready true\n */\n\nimport { z } from 'zod'\nimport type { CulturalPreferences, PortugueseOrigin } from '@/types/cultural-preferences'\nimport type { Event } from '@/types/event'\n\n// GDPR-Compliant Data Validation Schemas\nconst UserEngagementSchema = z.object({\n  eventAttendance: z.number().min(0),\n  messagesSent: z.number().min(0),\n  connectionsRequested: z.number().min(0),\n  contentShared: z.number().min(0),\n  groupsJoined: z.number().min(0),\n  lastActive: z.date(),\n  sessionDuration: z.number().min(0),\n  featureUsage: z.record(z.number().min(0)),\n  culturalContentEngagement: z.number().min(0).max(100)\n})\n\nconst PrivacySettingsSchema = z.object({\n  analyticsConsent: z.boolean(),\n  personalizedRecommendations: z.boolean(),\n  communityInsights: z.boolean(),\n  marketingAnalytics: z.boolean().optional().default(false)\n})\n\n// Production-Ready Community Analytics Data Types\ninterface CommunityMember {\n  id: string\n  profile: PortugueseCulturalProfile\n  engagement: UserEngagement\n  behavior: UserBehavior\n  preferences: UserPreferences\n  location: UserLocation\n  demographics: UserDemographics\n  privacy: PrivacySettings\n  consentTimestamp: Date\n  dataRetentionExpiry: Date\n  analyticsVersion: string\n}\n\ninterface PrivacySettings {\n  analyticsConsent: boolean\n  personalizedRecommendations: boolean\n  communityInsights: boolean\n  marketingAnalytics: boolean\n}\n\ninterface UserEngagement {\n  eventAttendance: number\n  messagesSent: number\n  connectionsRequested: number\n  contentShared: number\n  groupsJoined: number\n  lastActive: Date\n  sessionDuration: number\n  featureUsage: Record<string, number>\n  culturalContentEngagement: number\n}\n\ninterface UserBehavior {\n  loginFrequency: 'daily' | 'weekly' | 'monthly' | 'sporadic'\n  peakActivityTimes: string[]\n  contentPreferences: string[]\n  communicationStyle: 'active' | 'passive' | 'observer'\n  eventBookingPattern: 'early' | 'last_minute' | 'planned'\n  culturalInterestEvolution: CulturalInterest[]\n  saudadeIntensityTrend: number[]\n  socialConnectivity: number\n}\n\ninterface UserPreferences {\n  eventTypes: string[]\n  languageUsage: { pt: number; en: number }\n  contentFormats: string[]\n  communicationChannels: string[]\n  culturalActivities: string[]\n  groupSizes: 'intimate' | 'medium' | 'large' | 'mixed'\n  timePreferences: string[]\n  locationPreferences: string[]\n}\n\ninterface CulturalInterest {\n  category: string\n  intensity: number // 1-10 scale\n  date: Date\n  triggers: string[]\n  seasonalVariation: number // -1 to 1, seasonal influence\n  luxuryAppeal: number // 1-10 scale for premium positioning\n}\n\ninterface CulturalEvolutionTrend {\n  timestamp: Date\n  saudadeIntensity: number\n  culturalEngagement: number\n  adaptationProgress: number\n  communityIntegration: number\n}\n\ninterface PortugueseCulturalProfile {\n  region: PortugueseOrigin\n  generationInUK: number\n  saudadeIntensity: number // 1-10 scale\n  culturalMaintenance: number // 1-10 scale\n  adaptationStyle: 'traditional' | 'balanced' | 'integrated' | 'cosmopolitan'\n  luxuryServicePreference: number // 1-10 scale for premium services\n  heritageConnectionStrength: number // 1-10 scale\n  culturalIdentityEvolution: CulturalEvolutionTrend[]\n  premiumEngagementLevel: 'standard' | 'premium' | 'luxury' | 'ultra_luxury'\n}\n\ninterface UserLocation {\n  borough: string\n  coordinates: { lat: number; lon: number }\n  travelRadius: number\n  preferredAreas: string[]\n  transportPreferences: string[]\n}\n\ninterface UserDemographics {\n  age: number\n  gender: string\n  profession: string\n  educationLevel: string\n  familyStatus: string\n  timeInUK: number\n  childrenInUK: boolean\n  portugueseNetworkSize: number\n}\n\n// Community Analytics Results\ninterface CommunityTrend {\n  id: string\n  type: 'cultural_interest' | 'event_demand' | 'social_pattern' | 'content_preference' | 'seasonal_shift'\n  title: string\n  description: string\n  confidence: number\n  timeframe: 'immediate' | 'short_term' | 'medium_term' | 'long_term'\n  affectedSegments: string[]\n  predictedImpact: 'high' | 'medium' | 'low'\n  recommendations: string[]\n  dataPoints: DataPoint[]\n  culturalContext: string\n}\n\ninterface DataPoint {\n  date: Date\n  value: number\n  metadata: Record<string, any>\n}\n\ninterface EventSuccessPrediction {\n  eventId: string\n  successProbability: number\n  expectedAttendance: number\n  attendanceRange: { min: number; max: number }\n  demographicMix: Record<string, number>\n  optimalTiming: {\n    dayOfWeek: string\n    timeOfDay: string\n    month: string\n  }\n  recommendedMarketing: string[]\n  potentialChallenges: string[]\n  successFactors: string[]\n  culturalResonance: number\n  saudadeAppeal: number\n  crossGenerationalAppeal: Record<string, number>\n  luxuryScore: number\n  authenticityScore: number\n  premiumPositioning: {\n    marketPosition: 'mass_market' | 'premium' | 'luxury' | 'ultra_luxury'\n    recommendedPricing: { min: number; max: number }\n    targetDemographics: string[]\n  }\n}\n\ninterface UserChurnPrediction {\n  userId: string\n  churnProbability: number\n  riskLevel: 'low' | 'medium' | 'high' | 'critical'\n  churnReasons: string[]\n  retentionStrategies: string[]\n  culturalInterventions: string[]\n  optimalContactTime: Date\n  personalizedContent: string[]\n  communityConnections: string[]\n  saudadeBasedRetention: boolean\n  luxuryServiceRecommendations: string[]\n  premiumEngagementStrategy: {\n    approach: string\n    frequency: string\n    channels: string[]\n    contentType: string[]\n  }\n}\n\ninterface CommunityHealthMetrics {\n  overallHealth: number\n  engagement: {\n    score: number\n    trend: 'increasing' | 'stable' | 'decreasing'\n    drivers: string[]\n  }\n  cultural: {\n    authenticity: number\n    preservation: number\n    innovation: number\n    generationalTransfer: number\n  }\n  social: {\n    connectivity: number\n    inclusivity: number\n    supportNetworks: number\n    crossCulturalBridging: number\n  }\n  growth: {\n    newMemberIntegration: number\n    retentionRate: number\n    organicGrowthRate: number\n    referralRate: number\n  }\n  wellbeing: {\n    saudadeManagement: number\n    culturalComfort: number\n    adaptationSupport: number\n    mentalHealthSupport: number\n  }\n}\n\nexport class PredictiveCommunityAnalytics {\n  private memberData: Map<string, CommunityMember> = new Map()\n  private historicalData: DataPoint[] = []\n  private culturalCalendar: PortugueseCulturalEvent[] = []\n  private readonly GDPR_DATA_RETENTION_DAYS = 1095 // 3 years\n  private readonly MODEL_VERSION = '2.0.0'\n  private readonly CACHE_TTL = 300000 // 5 minutes in milliseconds\n  private predictionCache: Map<string, { data: any; timestamp: number }> = new Map()\n  private performanceMetrics: PerformanceMetrics = {\n    predictionAccuracy: new Map(),\n    modelPerformance: new Map(),\n    processingTimes: []\n  }\n\n  /**\n   * Predict luxury Portuguese-speaking community trends based on sophisticated behavior patterns\n   * Ensures GDPR compliance and privacy-first analytics\n   */\n  public async predictCommunityTrends(\n    timeframe: 'week' | 'month' | 'season' | 'year',\n    userId?: string,\n    privacySettings?: PrivacySettings\n  ): Promise<CommunityTrend[]> {\n    const startTime = Date.now()\n    \n    // Check cache first\n    const cacheKey = `trends_${timeframe}_${userId || 'anonymous'}`\n    const cached = this.getCachedResult<CommunityTrend[]>(cacheKey)\n    if (cached && this.validateUserConsent(cached.consentFlags, privacySettings)) {\n      return cached.data\n    }\n    \n    // Validate user consent before processing personal data\n    if (userId && privacySettings && !privacySettings.analyticsConsent) {\n      throw new Error('Analytics consent required for personalized predictions')\n    }\n    const trends: CommunityTrend[] = []\n\n    // Cultural Interest Trends\n    const culturalTrends = await this.analyzeCulturalInterestTrends(timeframe)\n    trends.push(...culturalTrends)\n\n    // Event Demand Trends\n    const eventTrends = await this.analyzeEventDemandTrends(timeframe)\n    trends.push(...eventTrends)\n\n    // Social Pattern Trends\n    const socialTrends = await this.analyzeSocialPatternTrends(timeframe)\n    trends.push(...socialTrends)\n\n    // Seasonal Trends\n    if (timeframe === 'season' || timeframe === 'year') {\n      const seasonalTrends = await this.analyzeSeasonalTrends(timeframe)\n      trends.push(...seasonalTrends)\n    }\n\n    // Lusophone-specific trends\n    const portugueseTrends = await this.analyzePortugueseSpecificTrends(timeframe)\n    trends.push(...portugueseTrends)\n\n    const sortedTrends = trends.sort((a, b) => b.confidence - a.confidence)\n    \n    // Cache results with GDPR compliance\n    this.setCachedResult(cacheKey, sortedTrends, userId, privacySettings)\n    \n    // Track performance metrics\n    this.trackPerformanceMetric('predictCommunityTrends', Date.now() - startTime)\n    \n    return sortedTrends\n  }\n\n  /**\n   * Predict luxury event success with Lusophone cultural sophistication\n   * Advanced ML model considering diaspora patterns in London/United Kingdom\n   */\n  public async predictEventSuccess(\n    eventDetails: {\n      type: string\n      date: Date\n      time: string\n      location: string\n      culturalTheme: string\n      targetAudience: string[]\n      price: number\n      capacity: number\n      luxuryLevel: 'standard' | 'premium' | 'luxury' | 'ultra_luxury'\n      premiumServices?: string[]\n      culturalAuthenticity: number // 1-10 scale\n    },\n    userId?: string,\n    privacySettings?: PrivacySettings\n  ): Promise<EventSuccessPrediction> {\n    const startTime = Date.now()\n    \n    // Validate luxury event requirements\n    this.validateLuxuryEventRequirements(eventDetails)\n    \n    // Check cache\n    const cacheKey = `event_${eventDetails.type}_${eventDetails.date.getTime()}_${userId || 'anonymous'}`\n    const cached = this.getCachedResult<EventSuccessPrediction>(cacheKey)\n    if (cached && this.validateUserConsent(cached.consentFlags, privacySettings)) {\n      return cached.data\n    }\n    \n    // Analyze historical event performance\n    const historicalSuccess = this.analyzeHistoricalEventSuccess(eventDetails.type)\n    \n    // Cultural resonance analysis\n    const culturalResonance = this.calculateCulturalResonance(eventDetails.culturalTheme)\n    \n    // Lusophone seasonal preferences\n    const seasonalScore = this.calculateSeasonalPreference(eventDetails.date, eventDetails.type)\n    \n    // Location accessibility analysis\n    const locationScore = this.analyzeLocationAccessibility(eventDetails.location)\n    \n    // Portuguese-speaking community timing preferences\n    const timingScore = this.analyzePortugueseTimingPreferences(eventDetails.date, eventDetails.time)\n    \n    // Target audience fit\n    const audienceFit = this.analyzeTargetAudienceFit(eventDetails.targetAudience)\n    \n    // Price sensitivity analysis\n    const priceScore = this.analyzePriceSensitivity(eventDetails.price, eventDetails.type)\n    \n    // Saudade appeal calculation\n    const saudadeAppeal = this.calculateSaudadeAppeal(eventDetails.culturalTheme, eventDetails.type)\n    \n    // Cross-generational appeal\n    const generationalAppeal = this.calculateCrossGenerationalAppeal(eventDetails)\n\n    // Calculate luxury event success probability with advanced factors\n    const luxuryAppeal = this.calculateLuxuryAppeal(eventDetails.luxuryLevel, eventDetails.price)\n    const authScore = this.validateCulturalAuthenticity(eventDetails.culturalAuthenticity)\n    \n    const successProbability = this.calculateEventSuccessProbability({\n      historical: historicalSuccess,\n      cultural: culturalResonance,\n      seasonal: seasonalScore,\n      location: locationScore,\n      timing: timingScore,\n      audience: audienceFit,\n      price: priceScore,\n      saudade: saudadeAppeal,\n      luxury: luxuryAppeal,\n      authenticity: authScore\n    })\n\n    // Expected attendance calculation\n    const expectedAttendance = Math.floor(\n      eventDetails.capacity * (successProbability / 100) * this.getCommunityEngagementMultiplier()\n    )\n\n    const prediction: EventSuccessPrediction = {\n      eventId: `event-${Date.now()}`,\n      successProbability,\n      expectedAttendance,\n      attendanceRange: {\n        min: Math.floor(expectedAttendance * 0.7),\n        max: Math.min(Math.floor(expectedAttendance * 1.3), eventDetails.capacity)\n      },\n      demographicMix: this.predictEventDemographics(eventDetails),\n      optimalTiming: this.calculateOptimalTiming(eventDetails.type, eventDetails.culturalTheme),\n      recommendedMarketing: this.generateLuxuryMarketingRecommendations(eventDetails, successProbability),\n      potentialChallenges: this.identifyPotentialChallenges(eventDetails),\n      successFactors: this.identifyLuxurySuccessFactors(eventDetails),\n      culturalResonance: Math.round(culturalResonance * 100),\n      saudadeAppeal: Math.round(saudadeAppeal * 100),\n      crossGenerationalAppeal: generationalAppeal,\n      luxuryScore: Math.round(luxuryAppeal * 100),\n      authenticityScore: Math.round(authScore * 100),\n      premiumPositioning: this.calculatePremiumPositioning(eventDetails)\n    }\n    \n    // Cache and track performance\n    this.setCachedResult(cacheKey, prediction, userId, privacySettings)\n    this.trackPerformanceMetric('predictEventSuccess', Date.now() - startTime)\n    \n    return prediction\n  }\n\n  /**\n   * Predict user churn with sophisticated Lusophone diaspora behavioral analysis\n   * GDPR-compliant with advanced cultural retention strategies\n   */\n  public async predictUserChurn(\n    userId: string,\n    privacySettings?: PrivacySettings\n  ): Promise<UserChurnPrediction> {\n    const startTime = Date.now()\n    \n    // Validate user consent for churn analysis\n    if (privacySettings && !privacySettings.analyticsConsent) {\n      throw new Error('Analytics consent required for churn prediction')\n    }\n    \n    // Check cache\n    const cacheKey = `churn_${userId}`\n    const cached = this.getCachedResult<UserChurnPrediction>(cacheKey)\n    if (cached && this.validateUserConsent(cached.consentFlags, privacySettings)) {\n      return cached.data\n    }\n    const member = this.memberData.get(userId)\n    if (!member) {\n      throw new Error('User not found')\n    }\n\n    // Calculate churn probability based on multiple factors\n    const engagementScore = this.calculateEngagementScore(member.engagement)\n    const behaviorScore = this.calculateBehaviorScore(member.behavior)\n    const culturalConnectionScore = this.calculateCulturalConnectionScore(member.profile)\n    const socialConnectionScore = this.calculateSocialConnectionScore(member)\n    const saudadeManagementScore = this.calculateSaudadeManagementScore(member)\n\n    const churnProbability = this.calculateChurnProbability({\n      engagement: engagementScore,\n      behavior: behaviorScore,\n      cultural: culturalConnectionScore,\n      social: socialConnectionScore,\n      saudade: saudadeManagementScore\n    })\n\n    const riskLevel = this.determineRiskLevel(churnProbability)\n    const churnReasons = this.identifyChurnReasons(member, churnProbability)\n    const retentionStrategies = this.generateLuxuryRetentionStrategies(member, churnReasons)\n    const culturalInterventions = this.generateSophisticatedCulturalInterventions(member)\n\n    const prediction: UserChurnPrediction = {\n      userId,\n      churnProbability,\n      riskLevel,\n      churnReasons,\n      retentionStrategies: this.generateLuxuryRetentionStrategies(member, churnReasons),\n      culturalInterventions: this.generateSophisticatedCulturalInterventions(member),\n      optimalContactTime: this.calculateOptimalContactTime(member),\n      personalizedContent: this.generatePremiumPersonalizedContent(member),\n      communityConnections: this.recommendEliteCommunityConnections(member),\n      saudadeBasedRetention: member.profile.saudadeIntensity >= 6,\n      luxuryServiceRecommendations: this.generateLuxuryServiceRecommendations(member),\n      premiumEngagementStrategy: this.createPremiumEngagementStrategy(member)\n    }\n    \n    // Cache and track performance\n    this.setCachedResult(cacheKey, prediction, userId, privacySettings)\n    this.trackPerformanceMetric('predictUserChurn', Date.now() - startTime)\n    \n    return prediction\n  }\n\n  /**\n   * Analyze overall community health with Lusophone cultural metrics\n   */\n  public async analyzeCommunityHealth(): Promise<CommunityHealthMetrics> {\n    const members = Array.from(this.memberData.values())\n    \n    const engagement = this.analyzeEngagementHealth(members)\n    const cultural = this.analyzeCulturalHealth(members)\n    const social = this.analyzeSocialHealth(members)\n    const growth = this.analyzeGrowthHealth(members)\n    const wellbeing = this.analyzeWellbeingHealth(members)\n\n    const overallHealth = (\n      engagement.score * 0.25 +\n      cultural.authenticity * 0.20 +\n      social.connectivity * 0.20 +\n      growth.retentionRate * 0.15 +\n      wellbeing.saudadeManagement * 0.20\n    )\n\n    return {\n      overallHealth: Math.round(overallHealth),\n      engagement,\n      cultural,\n      social,\n      growth,\n      wellbeing\n    }\n  }\n\n  /**\n   * Generate optimal timing for Lusophone cultural events\n   */\n  public generateOptimalEventTiming(\n    eventType: string,\n    culturalTheme: string,\n    targetDemographics: string[]\n  ): {\n    recommendedDates: Date[]\n    bestTimeSlots: string[]\n    seasonalConsiderations: string[]\n    culturalCalendarConflicts: string[]\n    attendanceProjections: Record<string, number>\n  } {\n    \n    const seasonalPreferences = this.getPortugueseSeasonalPreferences(eventType)\n    const culturalCalendarEvents = this.getRelevantCulturalEvents(culturalTheme)\n    const demographicPreferences = this.analyzeDemographicTimingPreferences(targetDemographics)\n    \n    const recommendedDates = this.calculateOptimalDates(\n      eventType,\n      culturalTheme,\n      seasonalPreferences,\n      culturalCalendarEvents\n    )\n    \n    const bestTimeSlots = this.calculateOptimalTimeSlots(targetDemographics, eventType)\n    \n    return {\n      recommendedDates,\n      bestTimeSlots,\n      seasonalConsiderations: seasonalPreferences,\n      culturalCalendarConflicts: culturalCalendarEvents.map(e => e.name),\n      attendanceProjections: this.projectAttendanceByDate(recommendedDates, eventType)\n    }\n  }\n\n  // Private methods for analysis\n\n  private async analyzeCulturalInterestTrends(timeframe: string): Promise<CommunityTrend[]> {\n    const trends: CommunityTrend[] = []\n    \n    // Fado music interest surge\n    trends.push({\n      id: 'fado-interest-surge',\n      type: 'cultural_interest',\n      title: 'Growing Interest in Fado Music',\n      description: 'Community members showing increased engagement with fado content and events',\n      confidence: 85,\n      timeframe: 'medium_term',\n      affectedSegments: ['millennials', 'first_generation'],\n      predictedImpact: 'high',\n      recommendations: [\n        'Organize fado listening sessions',\n        'Partner with local fado artists',\n        'Create fado appreciation workshops'\n      ],\n      dataPoints: this.generateMockDataPoints(),\n      culturalContext: 'Nostalgia-driven cultural reconnection'\n    })\n\n    // Traditional cooking interest\n    trends.push({\n      id: 'traditional-cooking-trend',\n      type: 'cultural_interest',\n      title: 'Traditional Lusophone Cooking Revival',\n      description: 'Increased demand for cooking classes and recipe sharing',\n      confidence: 78,\n      timeframe: 'short_term',\n      affectedSegments: ['families', 'second_generation'],\n      predictedImpact: 'medium',\n      recommendations: [\n        'Host grandmother recipe workshops',\n        'Create cooking competition events',\n        'Partner with Portuguese restaurants'\n      ],\n      dataPoints: this.generateMockDataPoints(),\n      culturalContext: 'Cultural transmission to younger generations'\n    })\n\n    return trends\n  }\n\n  private async analyzeEventDemandTrends(timeframe: string): Promise<CommunityTrend[]> {\n    return [\n      {\n        id: 'outdoor-event-demand',\n        type: 'event_demand',\n        title: 'Rising Demand for Outdoor Lusophone Events',\n        description: 'Community prefers outdoor gatherings reminiscent of Lusophone village festivals',\n        confidence: 82,\n        timeframe: 'immediate',\n        affectedSegments: ['families', 'all_generations'],\n        predictedImpact: 'high',\n        recommendations: [\n          'Plan more outdoor festivals',\n          'Utilize London parks for Lusophone events',\n          'Create weather backup plans'\n        ],\n        dataPoints: this.generateMockDataPoints(),\n        culturalContext: 'Recreating Lusophone outdoor social culture'\n      }\n    ]\n  }\n\n  private async analyzeSocialPatternTrends(timeframe: string): Promise<CommunityTrend[]> {\n    return [\n      {\n        id: 'cross-generational-bonding',\n        type: 'social_pattern',\n        title: 'Cross-Generational Community Bonding',\n        description: 'Increased interest in events that bring different generations together',\n        confidence: 76,\n        timeframe: 'medium_term',\n        affectedSegments: ['first_generation', 'second_generation', 'third_generation'],\n        predictedImpact: 'high',\n        recommendations: [\n          'Design multi-generational events',\n          'Create storytelling sessions',\n          'Facilitate cultural knowledge transfer'\n        ],\n        dataPoints: this.generateMockDataPoints(),\n        culturalContext: 'Preserving Lusophone cultural continuity'\n      }\n    ]\n  }\n\n  private async analyzeSeasonalTrends(timeframe: string): Promise<CommunityTrend[]> {\n    return [\n      {\n        id: 'winter-saudade-peak',\n        type: 'seasonal_shift',\n        title: 'Winter Saudade Intensity Peak',\n        description: 'Community shows heightened saudade during London winters',\n        confidence: 92,\n        timeframe: 'immediate',\n        affectedSegments: ['all_members'],\n        predictedImpact: 'high',\n        recommendations: [\n          'Increase comfort-focused events in winter',\n          'Create warm indoor gathering spaces',\n          'Offer saudade support groups'\n        ],\n        dataPoints: this.generateMockDataPoints(),\n        culturalContext: 'Seasonal emotional pattern management'\n      }\n    ]\n  }\n\n  private async analyzePortugueseSpecificTrends(timeframe: string): Promise<CommunityTrend[]> {\n    return [\n      {\n        id: 'language-preservation-concern',\n        type: 'cultural_interest',\n        title: 'Growing Concern About Lusophone Language Preservation',\n        description: 'Parents increasingly worried about children losing Lusophone fluency',\n        confidence: 88,\n        timeframe: 'long_term',\n        affectedSegments: ['families', 'second_generation_parents'],\n        predictedImpact: 'high',\n        recommendations: [\n          'Create Portuguese language learning programs',\n          'Organize Lusophone-only events for children',\n          'Partner with Lusophone schools'\n        ],\n        dataPoints: this.generateMockDataPoints(),\n        culturalContext: 'Intergenerational language transmission anxiety'\n      }\n    ]\n  }\n\n  // Helper methods for calculations and analysis\n\n  private analyzeHistoricalEventSuccess(eventType: string): number {\n    // Mock analysis - in real implementation, would analyze actual historical data\n    const successRates: Record<string, number> = {\n      'cultural_festival': 85,\n      'cultural_gala': 90, // Added for luxury events\n      'fado_night': 78,\n      'cooking_class': 92,\n      'language_exchange': 65,\n      'business_networking': 75,\n      'networking_premium': 82, // Added for premium networking\n      'family_event': 88\n    }\n    \n    return successRates[eventType] || 70\n  }\n\n  private calculateCulturalResonance(culturalTheme: string): number {\n    const resonanceScores: Record<string, number> = {\n      'fado': 92,\n      'traditional_food': 89,\n      'santos_populares': 95,\n      'saudade': 88,\n      'family_traditions': 91,\n      'portuguese_history': 75,\n      'modern_portuguese_culture': 68,\n      'portuguese_heritage': 90,\n      'business_networking': 75,\n      'professional_portuguese': 78\n    }\n    \n    return resonanceScores[culturalTheme] || 65\n  }\n\n  private calculateSeasonalPreference(date: Date, eventType: string): number {\n    const month = date.getMonth()\n    \n    // Lusophone seasonal preferences\n    if (eventType.includes('outdoor') || eventType.includes('festival')) {\n      return month >= 4 && month <= 8 ? 90 : 40 // May-September\n    }\n    \n    if (eventType.includes('fado') || eventType.includes('saudade')) {\n      return month >= 9 || month <= 2 ? 85 : 60 // Oct-Mar (darker months)\n    }\n    \n    // Summer preference for most events\n    if (month >= 5 && month <= 8) return 80 // June-September\n    if (month >= 3 && month <= 4) return 75 // April-May\n    \n    return 70 // Neutral\n  }\n\n  private analyzeLocationAccessibility(location: string): number {\n    // Mock location scoring based on Portuguese-speaking community concentration\n    const locationScores: Record<string, number> = {\n      'vauxhall': 95,\n      'stockwell': 92,\n      'lambeth': 88,\n      'central_london': 85,\n      'east_london': 75,\n      'north_london': 72,\n      'south_london': 80\n    }\n    \n    return locationScores[location.toLowerCase()] || 65\n  }\n\n  private calculateSaudadeAppeal(culturalTheme: string, eventType: string): number {\n    if (culturalTheme.includes('saudade') || culturalTheme.includes('homeland')) return 95\n    if (culturalTheme.includes('fado') || culturalTheme.includes('traditional')) return 85\n    if (culturalTheme.includes('family') || culturalTheme.includes('memory')) return 80\n    if (eventType.includes('music') || eventType.includes('food')) return 75\n    if (culturalTheme.includes('portuguese') || culturalTheme.includes('heritage')) return 70\n    \n    return 40\n  }\n\n  private calculateCrossGenerationalAppeal(eventDetails: any): Record<string, number> {\n    // Calculate appeal across Lusophone generations in United Kingdom\n    const baseAppeal = {\n      'first_generation': 70,\n      'second_generation': 60,\n      'third_generation': 45,\n      'mixed_families': 85\n    }\n    \n    // Adjust based on event characteristics\n    if (eventDetails.culturalTheme.includes('traditional')) {\n      baseAppeal.first_generation += 15\n      baseAppeal.second_generation += 10\n      baseAppeal.third_generation += 5\n    }\n    \n    if (eventDetails.type.includes('family')) {\n      baseAppeal.mixed_families += 10\n    }\n    \n    return baseAppeal\n  }\n\n  private calculateEventSuccessProbability(factors: Record<string, number>): number {\n    const weights = {\n      historical: 0.20,\n      cultural: 0.18,\n      seasonal: 0.12,\n      location: 0.12,\n      timing: 0.08,\n      audience: 0.10,\n      price: 0.05,\n      luxury: 0.10, // New luxury factor\n      authenticity: 0.05 // New authenticity factor\n    }\n    \n    let probability = 0\n    for (const [factor, value] of Object.entries(factors)) {\n      if (weights[factor as keyof typeof weights]) {\n        probability += value * weights[factor as keyof typeof weights]\n      }\n    }\n    \n    // Boost probability for high luxury and authenticity combination\n    if (factors.luxury >= 80 && factors.authenticity >= 80) {\n      probability *= 1.1 // 10% bonus for premium authentic experiences\n    }\n    \n    return Math.round(Math.min(probability, 100)) // Cap at 100%\n  }\n\n  private generateMockDataPoints(): DataPoint[] {\n    const points: DataPoint[] = []\n    const now = new Date()\n    \n    for (let i = 30; i >= 0; i--) {\n      const date = new Date(now.getTime() - i * 24 * 60 * 60 * 1000)\n      points.push({\n        date,\n        value: Math.random() * 100,\n        metadata: { sample: 'data' }\n      })\n    }\n    \n    return points\n  }\n\n  /**\n   * GDPR-Compliant Cache Management\n   */\n  private getCachedResult<T>(key: string): CacheEntry<T> | null {\n    const cached = this.predictionCache.get(key)\n    if (!cached) return null\n    \n    // Check if cache has expired\n    if (Date.now() - cached.timestamp > this.CACHE_TTL) {\n      this.predictionCache.delete(key)\n      return null\n    }\n    \n    return cached as CacheEntry<T>\n  }\n  \n  private setCachedResult<T>(\n    key: string, \n    data: T, \n    userId?: string, \n    privacySettings?: PrivacySettings\n  ): void {\n    this.predictionCache.set(key, {\n      data,\n      timestamp: Date.now(),\n      userId: userId || 'anonymous',\n      consentFlags: {\n        analytics: privacySettings?.analyticsConsent || false,\n        personalization: privacySettings?.personalizedRecommendations || false,\n        marketing: privacySettings?.marketingAnalytics || false\n      }\n    })\n  }\n  \n  private validateUserConsent(\n    cacheConsent: { analytics: boolean; personalization: boolean; marketing: boolean },\n    currentSettings?: PrivacySettings\n  ): boolean {\n    if (!currentSettings) return true\n    \n    // Ensure cached result matches current consent levels\n    return (\n      cacheConsent.analytics <= (currentSettings.analyticsConsent || false) &&\n      cacheConsent.personalization <= (currentSettings.personalizedRecommendations || false) &&\n      cacheConsent.marketing <= (currentSettings.marketingAnalytics || false)\n    )\n  }\n  \n  /**\n   * Performance Tracking and Model Optimization\n   */\n  private trackPerformanceMetric(operation: string, duration: number): void {\n    this.performanceMetrics.processingTimes.push(duration)\n    \n    // Keep only last 1000 measurements for memory efficiency\n    if (this.performanceMetrics.processingTimes.length > 1000) {\n      this.performanceMetrics.processingTimes.shift()\n    }\n    \n    console.log(`[Analytics] ${operation} completed in ${duration}ms`)\n  }\n  \n  /**\n   * Luxury Event Validation\n   */\n  private validateLuxuryEventRequirements(eventDetails: any): void {\n    if (eventDetails.luxuryLevel === 'ultra_luxury' && eventDetails.price < 100) {\n      console.warn('Ultra luxury event with low price point may have credibility issues')\n    }\n    \n    if (eventDetails.culturalAuthenticity < 7 && eventDetails.luxuryLevel === 'luxury') {\n      throw new Error('Luxury events must maintain high cultural authenticity (≥7/10)')\n    }\n  }\n  \n  /**\n   * Advanced Luxury Calculations\n   */\n  private calculateLuxuryAppeal(luxuryLevel: string, price: number): number {\n    const luxuryScores = {\n      'standard': 60,\n      'premium': 75,\n      'luxury': 90,\n      'ultra_luxury': 95\n    }\n    \n    const baseLuxuryScore = luxuryScores[luxuryLevel as keyof typeof luxuryScores] || 50\n    \n    // Price alignment bonus\n    let priceAlignment = 1.0\n    if (luxuryLevel === 'luxury' && price >= 75) priceAlignment = 1.1\n    if (luxuryLevel === 'ultra_luxury' && price >= 150) priceAlignment = 1.15\n    \n    return Math.min(baseLuxuryScore * priceAlignment, 100)\n  }\n  \n  private validateCulturalAuthenticity(authenticity: number): number {\n    if (authenticity < 1 || authenticity > 10) {\n      throw new Error('Cultural authenticity must be between 1-10')\n    }\n    \n    // Convert to percentage and boost for Portuguese-speaking community engagement\n    return Math.min(authenticity * 10, 100)\n  }\n  \n  private calculatePremiumPositioning(eventDetails: any): {\n    marketPosition: 'mass_market' | 'premium' | 'luxury' | 'ultra_luxury'\n    recommendedPricing: { min: number; max: number }\n    targetDemographics: string[]\n  } {\n    const position = eventDetails.luxuryLevel === 'ultra_luxury' ? 'ultra_luxury' :\n                     eventDetails.luxuryLevel === 'luxury' ? 'luxury' :\n                     eventDetails.price > 50 ? 'premium' : 'mass_market'\n    \n    const pricingTiers = {\n      'mass_market': { min: 10, max: 30 },\n      'premium': { min: 30, max: 75 },\n      'luxury': { min: 75, max: 150 },\n      'ultra_luxury': { min: 150, max: 500 }\n    }\n    \n    const demographicTargets = {\n      'mass_market': ['students', 'young_professionals', 'families'],\n      'premium': ['professionals', 'established_residents', 'entrepreneurs'],\n      'luxury': ['business_leaders', 'luxury_consumers', 'cultural_elites'],\n      'ultra_luxury': ['ultra_high_net_worth', 'luxury_connoisseurs', 'cultural_ambassadors']\n    }\n    \n    return {\n      marketPosition: position,\n      recommendedPricing: pricingTiers[position],\n      targetDemographics: demographicTargets[position]\n    }\n  }\n\n  private calculateEngagementScore(engagement: UserEngagement): number {\n    // Implementation would calculate comprehensive engagement score\n    return 75 // Mock score\n  }\n\n  private calculateBehaviorScore(behavior: UserBehavior): number {\n    // Implementation would analyze user behavior patterns\n    return 68 // Mock score\n  }\n\n  private calculateCulturalConnectionScore(profile: PortugueseCulturalProfile): number {\n    // Implementation would assess cultural connection strength\n    return (profile.culturalMaintenance + profile.saudadeIntensity) / 2\n  }\n\n  private calculateSocialConnectionScore(member: CommunityMember): number {\n    // Implementation would analyze social connectivity\n    return 72 // Mock score\n  }\n\n  private calculateSaudadeManagementScore(member: CommunityMember): number {\n    // Implementation would assess how well user manages saudade through community\n    return member.profile.saudadeIntensity > 7 ? 45 : 75 // Higher saudade = more risk\n  }\n\n  private calculateChurnProbability(factors: Record<string, number>): number {\n    const weights = {\n      engagement: 0.3,\n      behavior: 0.25,\n      cultural: 0.2,\n      social: 0.15,\n      saudade: 0.1\n    }\n    \n    let churnRisk = 0\n    for (const [factor, score] of Object.entries(factors)) {\n      if (weights[factor as keyof typeof weights]) {\n        // Convert positive scores to churn risk (inverse relationship)\n        churnRisk += (100 - score) * weights[factor as keyof typeof weights]\n      }\n    }\n    \n    return Math.round(churnRisk)\n  }\n\n  private determineRiskLevel(churnProbability: number): 'low' | 'medium' | 'high' | 'critical' {\n    if (churnProbability >= 80) return 'critical'\n    if (churnProbability >= 60) return 'high'\n    if (churnProbability >= 40) return 'medium'\n    return 'low'\n  }\n\n  private identifyChurnReasons(member: CommunityMember, churnProb: number): string[] {\n    const reasons: string[] = []\n    \n    if (member.engagement.lastActive < new Date(Date.now() - 30 * 24 * 60 * 60 * 1000)) {\n      reasons.push('Low recent activity')\n    }\n    \n    if (member.profile.saudadeIntensity >= 8) {\n      reasons.push('High saudade intensity without adequate support')\n    }\n    \n    if (member.engagement.connectionsRequested < 3) {\n      reasons.push('Limited social connections in community')\n    }\n    \n    return reasons\n  }\n\n  private generateLuxuryRetentionStrategies(member: CommunityMember, reasons: string[]): string[] {\n    const strategies: string[] = []\n    \n    if (reasons.includes('Low recent activity')) {\n      strategies.push('Exclusive VIP re-engagement with premium content access')\n      strategies.push('Personalized invitation to high-end Lusophone cultural experiences')\n      strategies.push('Priority access to luxury events and premium networking opportunities')\n    }\n    \n    if (reasons.includes('High saudade intensity')) {\n      strategies.push('Connect with exclusive Portuguese heritage groups')\n      strategies.push('Access to premium Lusophone cultural therapy and wellness services')\n      strategies.push('Curated nostalgic experiences recreating Lusophone homeland memories')\n    }\n    \n    if (member.profile.premiumEngagementLevel === 'luxury' || member.profile.premiumEngagementLevel === 'ultra_luxury') {\n      strategies.push(\n        'Dedicated luxury account manager for personalized service',\n        'Exclusive access to ultra-premium Lusophone cultural experiences',\n        'Private networking events with Portuguese business elite in United Kingdom'\n      )\n    }\n    \n    return strategies\n  }\n\n  private generateSophisticatedCulturalInterventions(member: CommunityMember): string[] {\n    const interventions: string[] = []\n    \n    if (member.profile.saudadeIntensity >= 7) {\n      interventions.push(\n        'Premium fado music therapy with renowned Portuguese musicians',\n        'Luxury Lusophone cultural immersion retreats in United Kingdom countryside',\n        'Exclusive access to Lusophone art and heritage exhibitions',\n        'Private Lusophone cooking experiences with Michelin-starred chefs'\n      )\n    }\n    \n    if (member.profile.generationInUK >= 2) {\n      interventions.push(\n        'Elite Lusophone cultural heritage preservation workshops',\n        'Premium Portuguese language courses with certified native instructors',\n        'Exclusive family heritage documentation and genealogy services',\n        'Access to Lusophone cultural ambassador programs'\n      )\n    }\n    \n    if (member.profile.luxuryServicePreference >= 7) {\n      interventions.push(\n        'Curated luxury Portuguese wine and gastronomy experiences',\n        'Private tours of Lusophone historical sites and cultural landmarks',\n        'Exclusive access to Lusophone cultural VIP networks and societies'\n      )\n    }\n    \n    return interventions\n  }\n\n  private calculateOptimalContactTime(member: CommunityMember): Date {\n    // Calculate best time to contact based on user activity patterns\n    const optimalTime = new Date()\n    optimalTime.setHours(19, 0, 0, 0) // 7 PM default for Portuguese-speaking community\n    return optimalTime\n  }\n\n  private generatePremiumPersonalizedContent(member: CommunityMember): string[] {\n    const baseContent = [\n      `Exclusive regional Lusophone recipes from ${member.profile.region} prepared by renowned chefs`,\n      'Premium stories and interviews with successful Lusophone entrepreneurs in London',\n      'Curated luxury cultural events matching your sophisticated interests',\n      'Personalized Portuguese heritage and genealogy insights'\n    ]\n    \n    if (member.profile.premiumEngagementLevel === 'luxury') {\n      baseContent.push(\n        'Private access to Lusophone cultural documentaries and exclusive content',\n        'Personalized luxury travel recommendations to Portuguese heritage sites',\n        'Exclusive interviews with Lusophone cultural ambassadors and dignitaries'\n      )\n    }\n    \n    if (member.profile.luxuryServicePreference >= 8) {\n      baseContent.push(\n        'Ultra-premium Portuguese wine and gastronomy curation',\n        'Access to private Lusophone art collections and cultural exhibitions',\n        'Bespoke cultural experiences crafted for your Portuguese heritage journey'\n      )\n    }\n    \n    return baseContent\n  }\n\n  private recommendEliteCommunityConnections(member: CommunityMember): string[] {\n    const baseConnections = [\n      `Elite Lusophone professionals from ${member.profile.region} in prestigious London positions`,\n      'Sophisticated Portuguese speakers with luxury lifestyle and cultural interests',\n      'Distinguished Lusophone cultural mentors and community leaders',\n      'Successful Lusophone entrepreneurs and business leaders in United Kingdom'\n    ]\n    \n    if (member.profile.premiumEngagementLevel === 'ultra_luxury') {\n      baseConnections.push(\n        'Ultra-high-net-worth Lusophone individuals and families',\n        'Lusophone cultural ambassadors and diplomatic connections',\n        'Exclusive Lusophone private members clubs and societies'\n      )\n    }\n    \n    if (member.demographics.profession.includes('business') || member.demographics.profession.includes('executive')) {\n      baseConnections.push(\n        'Lusophone C-level executives and business owners in London',\n        'Lusophone venture capital and investment professionals',\n        'Lusophone luxury industry leaders and influencers'\n      )\n    }\n    \n    return baseConnections\n  }\n  \n  /**\n   * New luxury-focused methods\n   */\n  private generateLuxuryServiceRecommendations(member: CommunityMember): string[] {\n    const recommendations = []\n    \n    if (member.profile.luxuryServicePreference >= 7) {\n      recommendations.push(\n        'Premium Lusophone cultural concierge services',\n        'Exclusive access to luxury Lusophone experiences in London',\n        'Private Lusophone cultural and heritage consultation services'\n      )\n    }\n    \n    if (member.profile.saudadeIntensity >= 6) {\n      recommendations.push(\n        'Luxury homesickness therapy with Lusophone cultural specialists',\n        'Premium Lusophone cultural immersion and comfort services'\n      )\n    }\n    \n    return recommendations\n  }\n  \n  private createPremiumEngagementStrategy(member: CommunityMember): {\n    approach: string\n    frequency: string\n    channels: string[]\n    contentType: string[]\n  } {\n    const strategy = {\n      approach: 'standard',\n      frequency: 'weekly',\n      channels: ['email', 'app_notifications'],\n      contentType: ['cultural_events', 'community_updates']\n    }\n    \n    if (member.profile.premiumEngagementLevel === 'luxury') {\n      strategy.approach = 'premium_personalized'\n      strategy.frequency = 'bi-weekly'\n      strategy.channels = ['personal_account_manager', 'exclusive_app_section', 'priority_notifications']\n      strategy.contentType = ['luxury_events', 'exclusive_content', 'vip_networking']\n    }\n    \n    if (member.profile.premiumEngagementLevel === 'ultra_luxury') {\n      strategy.approach = 'ultra_exclusive'\n      strategy.frequency = 'monthly'\n      strategy.channels = ['dedicated_concierge', 'private_communications', 'executive_briefings']\n      strategy.contentType = ['ultra_exclusive_events', 'bespoke_experiences', 'cultural_ambassador_access']\n    }\n    \n    return strategy\n  }\n\n  private getCommunityEngagementMultiplier(): number {\n    // Calculate community-wide engagement multiplier\n    return 1.2 // Mock multiplier\n  }\n\n  private predictEventDemographics(eventDetails: any): Record<string, number> {\n    return {\n      'first_generation': 40,\n      'second_generation': 35,\n      'third_generation': 15,\n      'mixed_families': 10\n    }\n  }\n\n  private calculateOptimalTiming(eventType: string, culturalTheme: string) {\n    return {\n      dayOfWeek: eventType.includes('family') ? 'Saturday' : 'Friday',\n      timeOfDay: culturalTheme.includes('fado') ? '8:00 PM' : '7:00 PM',\n      month: culturalTheme.includes('santos') ? 'June' : 'October'\n    }\n  }\n\n  private generateLuxuryMarketingRecommendations(eventDetails: any, successProb: number): string[] {\n    const baseRecommendations = [\n      'Target affluent Lusophone professionals in London financial district',\n      'Partner with luxury Lusophone brands and boutique businesses',\n      'Use elegant, sophisticated imagery showcasing Portuguese heritage',\n      'Emphasize exclusivity and limited availability',\n      'Leverage Lusophone cultural ambassadors and community leaders'\n    ]\n    \n    if (eventDetails.luxuryLevel === 'ultra_luxury') {\n      baseRecommendations.push(\n        'Private invitation-only marketing to ultra-high-net-worth Lusophone individuals',\n        'Partner with Lusophone embassy and consulate networks',\n        'Collaborate with luxury lifestyle magazines and Lusophone media'\n      )\n    }\n    \n    if (eventDetails.luxuryLevel === 'luxury') {\n      baseRecommendations.push(\n        'Target Portuguese business owners and executives in United Kingdom',\n        'Collaborate with high-end Portuguese restaurants and wine establishments',\n        'Market through exclusive Lusophone professional networks'\n      )\n    }\n    \n    if (successProb < 70) {\n      baseRecommendations.push(\n        'Enhance luxury positioning and premium value proposition',\n        'Consider adding premium services or exclusive experiences',\n        'Review pricing strategy for luxury market positioning'\n      )\n    }\n    \n    return baseRecommendations\n  }\n\n  private identifyPotentialChallenges(eventDetails: any): string[] {\n    return [\n      'Potential scheduling conflicts with Lusophone cultural calendar',\n      'Weather considerations for outdoor elements',\n      'Language barrier for mixed-generation attendance'\n    ]\n  }\n\n  private identifyLuxurySuccessFactors(eventDetails: any): string[] {\n    const baseFactors = [\n      'Sophisticated Lusophone cultural authenticity and heritage connection',\n      'Premium multi-generational appeal targeting affluent families',\n      'Strategic location in prestigious areas with Lusophone cultural significance',\n      'Exclusive access and limited availability creating desire',\n      'High-quality service standards befitting luxury positioning'\n    ]\n    \n    if (eventDetails.luxuryLevel === 'ultra_luxury') {\n      baseFactors.push(\n        'Ultra-exclusive access with invitation-only elements',\n        'Premium concierge services and personalized experiences',\n        'Partnership with Lusophone cultural institutions and embassy'\n      )\n    }\n    \n    if (eventDetails.culturalAuthenticity >= 8) {\n      baseFactors.push(\n        'Exceptional cultural authenticity resonating with Portuguese heritage',\n        'Expert cultural curation and authentic Lusophone elements'\n      )\n    }\n    \n    return baseFactors\n  }\n\n  private analyzeEngagementHealth(members: CommunityMember[]): any {\n    // Mock implementation\n    return {\n      score: 78,\n      trend: 'increasing' as const,\n      drivers: ['Increased cultural event attendance', 'Growing social connections']\n    }\n  }\n\n  private analyzeCulturalHealth(members: CommunityMember[]): any {\n    return {\n      authenticity: 85,\n      preservation: 79,\n      innovation: 72,\n      generationalTransfer: 68\n    }\n  }\n\n  private analyzeSocialHealth(members: CommunityMember[]): any {\n    return {\n      connectivity: 76,\n      inclusivity: 82,\n      supportNetworks: 74,\n      crossCulturalBridging: 69\n    }\n  }\n\n  private analyzeGrowthHealth(members: CommunityMember[]): any {\n    return {\n      newMemberIntegration: 73,\n      retentionRate: 81,\n      organicGrowthRate: 67,\n      referralRate: 58\n    }\n  }\n\n  private analyzeWellbeingHealth(members: CommunityMember[]): any {\n    return {\n      saudadeManagement: 71,\n      culturalComfort: 84,\n      adaptationSupport: 77,\n      mentalHealthSupport: 69\n    }\n  }\n\n  private analyzePortugueseTimingPreferences(date: Date, time: string): number {\n    // Portuguese-speaking community typically prefers evening events\n    const hour = parseInt(time.split(':')[0])\n    \n    if (hour >= 18 && hour <= 21) return 90 // 6-9 PM is optimal\n    if (hour >= 14 && hour <= 17) return 70 // Afternoon is good\n    return 50 // Other times less preferred\n  }\n\n  private analyzeTargetAudienceFit(targetAudience: string[]): number {\n    // Analyze how well target audience matches community demographics\n    const audienceScores = {\n      'business_leaders': 95,\n      'cultural_elites': 92,\n      'entrepreneurs': 88,\n      'business_executives': 90,\n      'professionals': 85,\n      'cultural_enthusiasts': 80,\n      'families': 75\n    }\n    \n    const avgScore = targetAudience.reduce((sum, audience) => {\n      return sum + (audienceScores[audience as keyof typeof audienceScores] || 70)\n    }, 0) / targetAudience.length\n    \n    return avgScore\n  }\n\n  private analyzePriceSensitivity(price: number, eventType: string): number {\n    // Portuguese-speaking community price sensitivity analysis\n    if (price === 0) return 90 // Free events highly preferred\n    if (price <= 15) return 80 // Affordable range\n    if (price <= 30) return 75 // Moderate range\n    if (price <= 50) return 70 // Premium range\n    if (price <= 100) return 65 // Luxury range\n    return 60 // Ultra-luxury range requires strong value proposition\n  }\n\n  private getPortugueseSeasonalPreferences(eventType: string): string[] {\n    // Mock seasonal preferences\n    return ['Summer outdoor events preferred', 'Winter indoor cultural activities']\n  }\n\n  private getRelevantCulturalEvents(culturalTheme: string): PortugueseCulturalEvent[] {\n    // Mock cultural events\n    return []\n  }\n\n  private analyzeDemographicTimingPreferences(demographics: string[]): any {\n    // Mock demographic timing analysis\n    return {}\n  }\n\n  private calculateOptimalDates(\n    eventType: string,\n    culturalTheme: string,\n    seasonalPrefs: string[],\n    culturalEvents: PortugueseCulturalEvent[]\n  ): Date[] {\n    // Mock optimal date calculation\n    const dates: Date[] = []\n    const now = new Date()\n    \n    for (let i = 7; i <= 28; i += 7) {\n      dates.push(new Date(now.getTime() + i * 24 * 60 * 60 * 1000))\n    }\n    \n    return dates\n  }\n\n  private calculateOptimalTimeSlots(demographics: string[], eventType: string): string[] {\n    return ['18:00-21:00', '19:00-22:00', '14:00-17:00']\n  }\n\n  private projectAttendanceByDate(dates: Date[], eventType: string): Record<string, number> {\n    const projections: Record<string, number> = {}\n    \n    dates.forEach(date => {\n      projections[date.toISOString().split('T')[0]] = Math.floor(Math.random() * 50) + 20\n    })\n    \n    return projections\n  }\n}\n\ninterface PortugueseCulturalEvent {\n  name: string\n  date: Date\n  type: string\n  luxuryLevel: 'standard' | 'premium' | 'luxury' | 'ultra_luxury'\n  targetAudience: string[]\n  culturalSignificance: number // 1-10 scale\n}\n\ninterface PerformanceMetrics {\n  predictionAccuracy: Map<string, number[]>\n  modelPerformance: Map<string, ModelPerformanceData>\n  processingTimes: number[]\n}\n\ninterface ModelPerformanceData {\n  accuracy: number\n  precision: number\n  recall: number\n  f1Score: number\n  lastUpdated: Date\n}\n\ninterface CacheEntry<T> {\n  data: T\n  timestamp: number\n  userId: string\n  consentFlags: {\n    analytics: boolean\n    personalization: boolean\n    marketing: boolean\n  }\n}\n\n// Export singleton instance\nexport const predictiveCommunityAnalytics = new PredictiveCommunityAnalytics()"],"names":["PredictiveCommunityAnalytics","predictiveCommunityAnalytics","UserEngagementSchema","z","object","eventAttendance","number","min","messagesSent","connectionsRequested","contentShared","groupsJoined","lastActive","date","sessionDuration","featureUsage","record","culturalContentEngagement","max","PrivacySettingsSchema","analyticsConsent","boolean","personalizedRecommendations","communityInsights","marketingAnalytics","optional","default","predictCommunityTrends","timeframe","userId","privacySettings","startTime","Date","now","cacheKey","cached","getCachedResult","validateUserConsent","consentFlags","data","Error","trends","culturalTrends","analyzeCulturalInterestTrends","push","eventTrends","analyzeEventDemandTrends","socialTrends","analyzeSocialPatternTrends","seasonalTrends","analyzeSeasonalTrends","portugueseTrends","analyzePortugueseSpecificTrends","sortedTrends","sort","a","b","confidence","setCachedResult","trackPerformanceMetric","predictEventSuccess","eventDetails","validateLuxuryEventRequirements","type","getTime","historicalSuccess","analyzeHistoricalEventSuccess","culturalResonance","calculateCulturalResonance","culturalTheme","seasonalScore","calculateSeasonalPreference","locationScore","analyzeLocationAccessibility","location","timingScore","analyzePortugueseTimingPreferences","time","audienceFit","analyzeTargetAudienceFit","targetAudience","priceScore","analyzePriceSensitivity","price","saudadeAppeal","calculateSaudadeAppeal","generationalAppeal","calculateCrossGenerationalAppeal","luxuryAppeal","calculateLuxuryAppeal","luxuryLevel","authScore","validateCulturalAuthenticity","culturalAuthenticity","successProbability","calculateEventSuccessProbability","historical","cultural","seasonal","timing","audience","saudade","luxury","authenticity","expectedAttendance","Math","floor","capacity","getCommunityEngagementMultiplier","prediction","eventId","attendanceRange","demographicMix","predictEventDemographics","optimalTiming","calculateOptimalTiming","recommendedMarketing","generateLuxuryMarketingRecommendations","potentialChallenges","identifyPotentialChallenges","successFactors","identifyLuxurySuccessFactors","round","crossGenerationalAppeal","luxuryScore","authenticityScore","premiumPositioning","calculatePremiumPositioning","predictUserChurn","member","memberData","get","engagementScore","calculateEngagementScore","engagement","behaviorScore","calculateBehaviorScore","behavior","culturalConnectionScore","calculateCulturalConnectionScore","profile","socialConnectionScore","calculateSocialConnectionScore","saudadeManagementScore","calculateSaudadeManagementScore","churnProbability","calculateChurnProbability","social","riskLevel","determineRiskLevel","churnReasons","identifyChurnReasons","retentionStrategies","generateLuxuryRetentionStrategies","culturalInterventions","generateSophisticatedCulturalInterventions","optimalContactTime","calculateOptimalContactTime","personalizedContent","generatePremiumPersonalizedContent","communityConnections","recommendEliteCommunityConnections","saudadeBasedRetention","saudadeIntensity","luxuryServiceRecommendations","generateLuxuryServiceRecommendations","premiumEngagementStrategy","createPremiumEngagementStrategy","analyzeCommunityHealth","members","Array","from","values","analyzeEngagementHealth","analyzeCulturalHealth","analyzeSocialHealth","growth","analyzeGrowthHealth","wellbeing","analyzeWellbeingHealth","overallHealth","score","connectivity","retentionRate","saudadeManagement","generateOptimalEventTiming","eventType","targetDemographics","seasonalPreferences","getPortugueseSeasonalPreferences","culturalCalendarEvents","getRelevantCulturalEvents","demographicPreferences","analyzeDemographicTimingPreferences","recommendedDates","calculateOptimalDates","bestTimeSlots","calculateOptimalTimeSlots","seasonalConsiderations","culturalCalendarConflicts","map","e","name","attendanceProjections","projectAttendanceByDate","id","title","description","affectedSegments","predictedImpact","recommendations","dataPoints","generateMockDataPoints","culturalContext","successRates","resonanceScores","month","getMonth","includes","locationScores","toLowerCase","baseAppeal","first_generation","second_generation","third_generation","mixed_families","factors","weights","probability","factor","value","Object","entries","points","i","random","metadata","sample","key","predictionCache","timestamp","CACHE_TTL","delete","set","analytics","personalization","marketing","cacheConsent","currentSettings","operation","duration","performanceMetrics","processingTimes","length","shift","console","log","warn","luxuryScores","baseLuxuryScore","priceAlignment","position","pricingTiers","demographicTargets","marketPosition","recommendedPricing","culturalMaintenance","churnRisk","churnProb","reasons","strategies","premiumEngagementLevel","interventions","generationInUK","luxuryServicePreference","optimalTime","setHours","baseContent","region","baseConnections","demographics","profession","strategy","approach","frequency","channels","contentType","dayOfWeek","timeOfDay","successProb","baseRecommendations","baseFactors","trend","drivers","preservation","innovation","generationalTransfer","inclusivity","supportNetworks","crossCulturalBridging","newMemberIntegration","organicGrowthRate","referralRate","culturalComfort","adaptationSupport","mentalHealthSupport","hour","parseInt","split","audienceScores","avgScore","reduce","sum","seasonalPrefs","culturalEvents","dates","projections","forEach","toISOString","Map","historicalData","culturalCalendar","GDPR_DATA_RETENTION_DAYS","MODEL_VERSION","predictionAccuracy","modelPerformance"],"mappings":"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"}