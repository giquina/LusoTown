{"version":3,"sources":["/workspaces/LusoTown/web-app/src/utils/portuguese-bundle-optimizer.ts"],"sourcesContent":["// Portuguese-speaking community bundle optimization utilities\nimport logger from \"@/utils/logger\";\n\ninterface BundleOptimizationConfig {\n  enableCriticalResourcePreload: boolean;\n  enablePortugueseContentGrouping: boolean;\n  enableMobilePrioritization: boolean;\n  enableCulturalContentSplitting: boolean;\n  enableLazyLoadingThresholds: boolean;\n}\n\ninterface PortugueseContentPriority {\n  critical: string[];\n  high: string[];\n  medium: string[];\n  low: string[];\n  defer: string[];\n}\n\ninterface DeviceOptimizationContext {\n  isMobile: boolean;\n  connectionType: \"slow-2g\" | \"2g\" | \"3g\" | \"4g\" | \"5g\" | \"unknown\";\n  deviceMemory: number;\n  isDataSaverMode: boolean;\n  viewportWidth: number;\n  prefersReducedMotion: boolean;\n}\n\n// Portuguese-speaking community content prioritization\nconst PORTUGUESE_CONTENT_PRIORITIES: PortugueseContentPriority = {\n  critical: [\n    \"portuguese-navigation\",\n    \"community-authentication\",\n    \"language-switcher\",\n    \"cultural-branding\",\n    \"mobile-header\",\n  ],\n  high: [\n    \"event-listings\",\n    \"community-matches\",\n    \"business-directory\",\n    \"cultural-calendar\",\n    \"portuguese-feed\",\n  ],\n  medium: [\n    \"community-stories\",\n    \"cultural-articles\",\n    \"business-profiles\",\n    \"event-details\",\n    \"user-profiles\",\n  ],\n  low: [\n    \"historical-content\",\n    \"cultural-galleries\",\n    \"community-photos\",\n    \"testimonials\",\n    \"about-sections\",\n  ],\n  defer: [\n    \"cultural-videos\",\n    \"large-galleries\",\n    \"community-archives\",\n    \"advanced-features\",\n    \"admin-panels\",\n  ],\n};\n\n// Mobile-first optimization thresholds\nconst MOBILE_OPTIMIZATION_THRESHOLDS = {\n  criticalBundleSize: 170 * 1024, // 170KB for critical path\n  highPriorityBundleSize: 250 * 1024, // 250KB for high priority\n  lazyLoadThreshold: 50, // 50px from viewport\n  slowConnectionThreshold: \"3g\",\n  lowMemoryThreshold: 2, // GB\n  batteryLowThreshold: 0.2, // 20%\n};\n\nexport class PortugueseBundleOptimizer {\n  private config: BundleOptimizationConfig;\n  private deviceContext: DeviceOptimizationContext | null = null;\n  private loadedBundles: Set<string> = new Set();\n  private preloadedResources: Set<string> = new Set();\n\n  constructor(config: Partial<BundleOptimizationConfig> = {}) {\n    this.config = {\n      enableCriticalResourcePreload: true,\n      enablePortugueseContentGrouping: true,\n      enableMobilePrioritization: true,\n      enableCulturalContentSplitting: true,\n      enableLazyLoadingThresholds: true,\n      ...config,\n    };\n\n    this.initializeDeviceContext();\n  }\n\n  private initializeDeviceContext(): void {\n    if (typeof window === \"undefined\") return;\n\n    const connection = (navigator as any).connection;\n\n    this.deviceContext = {\n      isMobile: window.innerWidth <= 768,\n      connectionType: connection?.effectiveType || \"unknown\",\n      deviceMemory: (navigator as any).deviceMemory || 4,\n      isDataSaverMode: connection?.saveData || false,\n      viewportWidth: window.innerWidth,\n      prefersReducedMotion: window.matchMedia(\n        \"(prefers-reduced-motion: reduce)\"\n      ).matches,\n    };\n  }\n\n  // Preload critical Portuguese-speaking community resources\n  public async preloadCriticalResources(): Promise<void> {\n    if (!this.config.enableCriticalResourcePreload || !this.deviceContext)\n      return;\n\n    const criticalResources = [\n      \"/api/auth/session\",\n      \"/api/user/preferences\",\n      \"/api/events/featured?limit=5\",\n      \"/api/community/stats\",\n    ];\n\n    // Adjust for device capabilities\n    if (\n      this.deviceContext.isDataSaverMode ||\n      this.deviceContext.connectionType === \"slow-2g\"\n    ) {\n      // Skip non-essential preloading on slow connections\n      criticalResources.splice(2); // Keep only auth and preferences\n    }\n\n    const preloadPromises = criticalResources.map(async (resource) => {\n      if (this.preloadedResources.has(resource)) return;\n\n      try {\n        const response = await fetch(resource, {\n          method: \"GET\",\n          headers: {\n            \"X-Preload\": \"true\",\n          },\n        });\n\n        if (response.ok) {\n          this.preloadedResources.add(resource);\n        }\n      } catch (error) {\n        logger.info(`[Bundle Optimizer] Failed to preload ${resource}:`, error);\n      }\n    });\n\n    await Promise.allSettled(preloadPromises);\n  }\n\n  // Load Lusophone content bundles based on priority\n  public async loadPortugueseContentBundle(\n    priority: keyof PortugueseContentPriority\n  ): Promise<void> {\n    if (!this.config.enablePortugueseContentGrouping) return;\n\n    const bundleKey = `portuguese-${priority}`;\n    if (this.loadedBundles.has(bundleKey)) return;\n\n    const contentTypes = PORTUGUESE_CONTENT_PRIORITIES[priority];\n\n    // Skip or defer loading based on device constraints\n    if (this.shouldDeferLoading(priority)) {\n      setTimeout(() => this.loadPortugueseContentBundle(priority), 2000);\n      return;\n    }\n\n    try {\n      const loadPromises = contentTypes.map(async (contentType) => {\n        return this.loadContentTypeBundle(contentType);\n      });\n\n      await Promise.allSettled(loadPromises);\n      this.loadedBundles.add(bundleKey);\n      logger.info(\n        `[Bundle Optimizer] Loaded ${priority} priority Lusophone content`\n      );\n    } catch (error) {\n      logger.error(\n        `[Bundle Optimizer] Failed to load ${priority} bundle:`,\n        error\n      );\n    }\n  }\n\n  private async loadContentTypeBundle(contentType: string): Promise<void> {\n    const bundleMap: { [key: string]: () => Promise<any> } = {\n      \"portuguese-navigation\": () =>\n        import(\"@/components/PortugueseNavigation\"),\n      \"community-authentication\": () => import(\"@/components/AuthSystem\"),\n      \"event-listings\": () => import(\"@/components/EventsShowcase\"),\n      \"community-matches\": () => import(\"@/components/MatchesSystem\"),\n      \"business-directory\": () => import(\"@/components/BusinessDirectory\"),\n      \"cultural-calendar\": () => import(\"@/components/CulturalCalendar\"),\n      \"portuguese-feed\": () => import(\"@/components/CommunityFeedSection\"),\n      \"community-stories\": () => import(\"@/components/SuccessStories\"),\n      \"cultural-articles\": () => import(\"@/components/CulturalArticles\"),\n      \"business-profiles\": () => import(\"@/components/BusinessProfiles\"),\n      \"cultural-galleries\": () => import(\"@/components/CulturalGallery\"),\n      \"community-photos\": () => import(\"@/components/CommunityPhotos\"),\n      \"cultural-videos\": () => import(\"@/components/CulturalVideos\"),\n    };\n\n    if (bundleMap[contentType]) {\n      await bundleMap[contentType]();\n    }\n  }\n\n  private shouldDeferLoading(\n    priority: keyof PortugueseContentPriority\n  ): boolean {\n    if (!this.deviceContext) return false;\n\n    // Defer low priority content on constrained devices\n    if (priority === \"low\" || priority === \"defer\") {\n      if (this.deviceContext.isDataSaverMode) return true;\n      if (\n        this.deviceContext.connectionType === \"slow-2g\" ||\n        this.deviceContext.connectionType === \"2g\"\n      )\n        return true;\n      if (\n        this.deviceContext.deviceMemory <=\n        MOBILE_OPTIMIZATION_THRESHOLDS.lowMemoryThreshold\n      )\n        return true;\n    }\n\n    // Defer medium priority on very constrained devices\n    if (priority === \"medium\") {\n      if (\n        this.deviceContext.isDataSaverMode &&\n        this.deviceContext.connectionType === \"slow-2g\"\n      )\n        return true;\n      if (this.deviceContext.deviceMemory <= 1) return true;\n    }\n\n    return false;\n  }\n\n  // Optimize bundle loading for mobile Lusophone users\n  public optimizeForMobile(): void {\n    if (\n      !this.config.enableMobilePrioritization ||\n      !this.deviceContext?.isMobile\n    )\n      return;\n\n    // Implement mobile-specific optimizations\n    this.implementMobileOptimizations();\n\n    // Set up intersection observer for lazy loading\n    if (this.config.enableLazyLoadingThresholds) {\n      this.setupIntersectionObserver();\n    }\n\n    // Optimize for Lusophone mobile usage patterns\n    this.optimizePortugueseMobilePatterns();\n  }\n\n  private implementMobileOptimizations(): void {\n    if (!this.deviceContext) return;\n\n    // Reduce animation complexity on mobile\n    if (\n      this.deviceContext.prefersReducedMotion ||\n      this.deviceContext.deviceMemory <= 2\n    ) {\n      document.documentElement.classList.add(\"reduced-animations\");\n    }\n\n    // Apply data saver optimizations\n    if (this.deviceContext.isDataSaverMode) {\n      document.documentElement.classList.add(\"data-saver-mode\");\n      this.enableDataSaverMode();\n    }\n\n    // Optimize for slow connections\n    if ([\"slow-2g\", \"2g\", \"3g\"].includes(this.deviceContext.connectionType)) {\n      document.documentElement.classList.add(\"slow-connection\");\n      this.enableSlowConnectionOptimizations();\n    }\n  }\n\n  private enableDataSaverMode(): void {\n    // Disable autoplay videos\n    const videos = document.querySelectorAll(\"video[autoplay]\");\n    videos.forEach((video) => video.removeAttribute(\"autoplay\"));\n\n    // Reduce image quality\n    const images = document.querySelectorAll('img[src*=\"cloudinary\"]');\n    images.forEach((img) => {\n      const imgElement = img as HTMLImageElement;\n      imgElement.src = imgElement.src.replace(/q_\\d+/, \"q_30\");\n    });\n\n    // Defer non-critical Lusophone cultural content\n    this.deferNonCriticalContent();\n  }\n\n  private enableSlowConnectionOptimizations(): void {\n    // Preload only critical resources\n    const criticalLinks = document.querySelectorAll('link[rel=\"preload\"]');\n    criticalLinks.forEach((link) => {\n      if (!link.getAttribute(\"href\")?.includes(\"critical\")) {\n        link.remove();\n      }\n    });\n\n    // Increase intersection observer thresholds\n    this.lazyLoadThreshold = 20; // Closer to viewport\n  }\n\n  private lazyLoadThreshold = MOBILE_OPTIMIZATION_THRESHOLDS.lazyLoadThreshold;\n\n  private setupIntersectionObserver(): void {\n    if (typeof window === \"undefined\" || !(\"IntersectionObserver\" in window))\n      return;\n\n    const observer = new IntersectionObserver(\n      (entries) => {\n        entries.forEach((entry) => {\n          if (entry.isIntersecting) {\n            const element = entry.target as HTMLElement;\n            this.loadElementContent(element);\n            observer.unobserve(element);\n          }\n        });\n      },\n      {\n        rootMargin: `${this.lazyLoadThreshold}px 0px`,\n        threshold: 0.1,\n      }\n    );\n\n    // Observe lazy-loadable Lusophone content\n    const lazyElements = document.querySelectorAll(\"[data-portuguese-lazy]\");\n    lazyElements.forEach((element) => observer.observe(element));\n  }\n\n  private loadElementContent(element: HTMLElement): void {\n    const contentType = element.dataset.portugueseLazy;\n    if (!contentType) return;\n\n    // Load specific Lusophone content based on type\n    switch (contentType) {\n      case \"cultural-gallery\":\n        this.loadCulturalGallery(element);\n        break;\n      case \"community-feed\":\n        this.loadCommunityFeed(element);\n        break;\n      case \"business-listings\":\n        this.loadBusinessListings(element);\n        break;\n      case \"event-details\":\n        this.loadEventDetails(element);\n        break;\n      default:\n        logger.warn(\n          `[Bundle Optimizer] Unknown Lusophone content type: ${contentType}`\n        );\n    }\n  }\n\n  private async loadCulturalGallery(element: HTMLElement): Promise<void> {\n    try {\n      const { default: CulturalGallery } = await import(\n        \"@/components/CulturalGallery\"\n      );\n      // Render component in element\n      element.innerHTML =\n        '<div class=\"cultural-gallery-loaded\">Gallery loaded</div>';\n    } catch (error) {\n      logger.error(\n        \"[Bundle Optimizer] Failed to load cultural gallery:\",\n        error\n      );\n    }\n  }\n\n  private async loadCommunityFeed(element: HTMLElement): Promise<void> {\n    try {\n      const { default: CommunityFeed } = await import(\n        \"@/components/CommunityFeedSection\"\n      );\n      element.innerHTML =\n        '<div class=\"community-feed-loaded\">Feed loaded</div>';\n    } catch (error) {\n      logger.error(\"[Bundle Optimizer] Failed to load community feed:\", error);\n    }\n  }\n\n  private async loadBusinessListings(element: HTMLElement): Promise<void> {\n    try {\n      const { default: BusinessDirectory } = await import(\n        \"@/components/BusinessDirectory\"\n      );\n      element.innerHTML =\n        '<div class=\"business-listings-loaded\">Businesses loaded</div>';\n    } catch (error) {\n      logger.error(\n        \"[Bundle Optimizer] Failed to load business listings:\",\n        error\n      );\n    }\n  }\n\n  private async loadEventDetails(element: HTMLElement): Promise<void> {\n    try {\n      const eventId = element.dataset.eventId;\n      if (eventId) {\n        const response = await fetch(`/api/events/${eventId}`);\n        const eventData = await response.json();\n        element.innerHTML = `<div class=\"event-details-loaded\">${eventData.title}</div>`;\n      }\n    } catch (error) {\n      logger.error(\"[Bundle Optimizer] Failed to load event details:\", error);\n    }\n  }\n\n  private optimizePortugueseMobilePatterns(): void {\n    // Optimize for Lusophone mobile usage patterns\n    // 73% of Portuguese-speaking community uses mobile\n\n    // Prioritize touch-friendly interactions\n    this.optimizeTouchTargets();\n\n    // Optimize for Lusophone text rendering\n    this.optimizePortugueseTextRendering();\n\n    // Implement Lusophone cultural color optimization\n    this.optimizeCulturalTheming();\n  }\n\n  private optimizeTouchTargets(): void {\n    const touchTargets = document.querySelectorAll(\n      'button, a[role=\"button\"], [onclick]'\n    );\n    touchTargets.forEach((target) => {\n      const element = target as HTMLElement;\n      const rect = element.getBoundingClientRect();\n\n      // Ensure minimum 44px touch targets\n      if (rect.width < 44 || rect.height < 44) {\n        element.style.minWidth = \"44px\";\n        element.style.minHeight = \"44px\";\n        element.style.padding = element.style.padding || \"8px\";\n      }\n    });\n  }\n\n  private optimizePortugueseTextRendering(): void {\n    // Optimize for Lusophone diacritics and special characters\n    document.documentElement.style.textRendering = \"optimizeLegibility\";\n    document.documentElement.style.fontFeatureSettings = '\"liga\" 1, \"kern\" 1';\n\n    // Ensure proper Lusophone text wrapping\n    const textElements = document.querySelectorAll(\n      \"p, h1, h2, h3, h4, h5, h6, span\"\n    );\n    textElements.forEach((element) => {\n      const htmlElement = element as HTMLElement;\n      htmlElement.style.wordBreak = \"break-word\";\n      htmlElement.style.hyphens = \"auto\";\n      htmlElement.lang = htmlElement.lang || \"pt-PT\";\n    });\n  }\n\n  private optimizeCulturalTheming(): void {\n    // Apply Lusophone cultural color optimizations\n    const colorOptimizations = document.createElement(\"style\");\n    colorOptimizations.textContent = `\n      .portuguese-optimized {\n        --primary-cultural: #1e40af; /* Lusophone blue */\n        --secondary-cultural: #059669; /* Lusophone green */\n        --accent-cultural: #dc2626; /* Lusophone red */\n        --gold-cultural: #f59e0b; /* Lusophone gold */\n      }\n      \n      .mobile-portuguese-text {\n        line-height: 1.6;\n        letter-spacing: 0.025em;\n      }\n      \n      .cultural-gradient {\n        background: linear-gradient(135deg, \n          var(--primary-cultural), \n          var(--secondary-cultural), \n          var(--accent-cultural)\n        );\n      }\n    `;\n    document.head.appendChild(colorOptimizations);\n\n    document.documentElement.classList.add(\"portuguese-optimized\");\n  }\n\n  private deferNonCriticalContent(): void {\n    const nonCriticalSelectors = [\n      \".cultural-video\",\n      \".large-gallery\",\n      \".testimonial-carousel\",\n      \".community-archive\",\n      \".admin-panel\",\n    ];\n\n    nonCriticalSelectors.forEach((selector) => {\n      const elements = document.querySelectorAll(selector);\n      elements.forEach((element) => {\n        const htmlElement = element as HTMLElement;\n        htmlElement.style.display = \"none\";\n        htmlElement.dataset.deferred = \"true\";\n      });\n    });\n  }\n\n  // Public method to get optimization stats\n  public getOptimizationStats(): {\n    loadedBundles: string[];\n    preloadedResources: string[];\n    deviceContext: DeviceOptimizationContext | null;\n    optimizationsApplied: string[];\n  } {\n    const optimizationsApplied = [];\n\n    if (this.deviceContext?.isMobile)\n      optimizationsApplied.push(\"mobile-optimized\");\n    if (this.deviceContext?.isDataSaverMode)\n      optimizationsApplied.push(\"data-saver\");\n    if (this.deviceContext?.prefersReducedMotion)\n      optimizationsApplied.push(\"reduced-motion\");\n\n    return {\n      loadedBundles: Array.from(this.loadedBundles),\n      preloadedResources: Array.from(this.preloadedResources),\n      deviceContext: this.deviceContext,\n      optimizationsApplied,\n    };\n  }\n\n  // Clean up resources\n  public cleanup(): void {\n    this.loadedBundles.clear();\n    this.preloadedResources.clear();\n    this.deviceContext = null;\n  }\n}\n\n// Create global instance\nexport const portugueseBundleOptimizer = new PortugueseBundleOptimizer();\n\n// Optimized hook for React components with error handling\nexport function usePortugueseBundleOptimization() {\n  const [stats, setStats] = React.useState(() => {\n    try {\n      return portugueseBundleOptimizer.getOptimizationStats()\n    } catch (error) {\n      logger.error('Failed to get initial optimization stats:', error)\n      return {\n        loadedBundles: [],\n        preloadedResources: [],\n        deviceContext: null,\n        optimizationsApplied: []\n      }\n    }\n  })\n  const [isInitialized, setIsInitialized] = React.useState(false)\n  const statsUpdateTimeoutRef = React.useRef<NodeJS.Timeout>()\n\n  React.useEffect(() => {\n    const initializeOptimization = async () => {\n      if (isInitialized) return\n\n      try {\n        // Initialize optimization with error handling\n        await Promise.all([\n          portugueseBundleOptimizer.preloadCriticalResources().catch(err => \n            logger.warn('Critical resources preload failed:', err)\n          ),\n          Promise.resolve(portugueseBundleOptimizer.optimizeForMobile()).catch(err =>\n            logger.warn('Mobile optimization failed:', err)\n          )\n        ])\n\n        // Load critical Portuguese cultural content\n        await portugueseBundleOptimizer.loadPortugueseContentBundle('critical').catch(err =>\n          logger.warn('Critical Portuguese bundle loading failed:', err)\n        )\n\n        setIsInitialized(true)\n      } catch (error) {\n        logger.error('Bundle optimization initialization failed:', error)\n        setIsInitialized(true) // Continue even if initialization fails\n      }\n    }\n\n    initializeOptimization()\n\n    // Debounced stats update to prevent excessive re-renders\n    const updateStats = () => {\n      if (statsUpdateTimeoutRef.current) {\n        clearTimeout(statsUpdateTimeoutRef.current)\n      }\n      \n      statsUpdateTimeoutRef.current = setTimeout(() => {\n        try {\n          setStats(portugueseBundleOptimizer.getOptimizationStats())\n        } catch (error) {\n          logger.warn('Failed to update optimization stats:', error)\n        }\n      }, 500)\n    }\n\n    const interval = setInterval(updateStats, 3000) // Reduced frequency\n\n    return () => {\n      clearInterval(interval)\n      if (statsUpdateTimeoutRef.current) {\n        clearTimeout(statsUpdateTimeoutRef.current)\n      }\n      try {\n        portugueseBundleOptimizer.cleanup()\n      } catch (error) {\n        logger.warn('Bundle optimizer cleanup failed:', error)\n      }\n    }\n  }, [isInitialized])\n\n  const loadBundle = React.useCallback(async (priority: keyof PortugueseContentPriority) => {\n    try {\n      await portugueseBundleOptimizer.loadPortugueseContentBundle(priority)\n    } catch (error) {\n      logger.error(`Failed to load Portuguese bundle: ${priority}`, error)\n    }\n  }, [])\n\n  const preloadResources = React.useCallback(async () => {\n    try {\n      await portugueseBundleOptimizer.preloadCriticalResources()\n    } catch (error) {\n      logger.error('Failed to preload Portuguese cultural resources:', error)\n    }\n  }, [])\n\n  return {\n    stats,\n    isInitialized,\n    loadBundle,\n    preloadResources,\n    isOptimized: stats.optimizationsApplied.length > 0\n  }\n}\n\n// Utility functions\nexport function preloadPortugueseRoute(route: string): void {\n  if (typeof window !== \"undefined\" && \"requestIdleCallback\" in window) {\n    requestIdleCallback(() => {\n      const link = document.createElement(\"link\");\n      link.rel = \"prefetch\";\n      link.href = route;\n      document.head.appendChild(link);\n    });\n  }\n}\n\nexport function optimizePortugueseImages(): void {\n  const images = document.querySelectorAll(\n    'img[src*=\"portuguese\"], img[alt*=\"portuguese\" i]'\n  );\n  images.forEach((img) => {\n    const imgElement = img as HTMLImageElement;\n\n    // Add lazy loading\n    if (!imgElement.loading) {\n      imgElement.loading = \"lazy\";\n    }\n\n    // Add proper sizes for Lusophone content\n    if (!imgElement.sizes) {\n      imgElement.sizes =\n        \"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw\";\n    }\n  });\n}\n\n// Lusophone-specific performance measurement\nexport function measurePortuguesePerformance(): Promise<{\n  culturalContentLoadTime: number;\n  portugueseTextRenderTime: number;\n  mobileOptimizationScore: number;\n}> {\n  return new Promise((resolve) => {\n    if (typeof window === \"undefined\") {\n      resolve({\n        culturalContentLoadTime: 0,\n        portugueseTextRenderTime: 0,\n        mobileOptimizationScore: 0,\n      });\n      return;\n    }\n\n    const start = performance.now();\n\n    requestAnimationFrame(() => {\n      const culturalElements = document.querySelectorAll(\n        \"[data-portuguese-content]\"\n      );\n      const textElements = document.querySelectorAll(\"p, h1, h2, h3\");\n      const mobileElements = document.querySelectorAll('[class*=\"mobile\"]');\n\n      const culturalContentLoadTime = performance.now() - start;\n      const portugueseTextRenderTime =\n        culturalElements.length > 0 ? performance.now() - start : 0;\n      const mobileOptimizationScore = Math.min(\n        100,\n        (mobileElements.length / textElements.length) * 100\n      );\n\n      resolve({\n        culturalContentLoadTime,\n        portugueseTextRenderTime,\n        mobileOptimizationScore,\n      });\n    });\n  });\n}\n\nimport React from \"react\"; // For the hook\n"],"names":["PortugueseBundleOptimizer","measurePortuguesePerformance","optimizePortugueseImages","portugueseBundleOptimizer","preloadPortugueseRoute","usePortugueseBundleOptimization","PORTUGUESE_CONTENT_PRIORITIES","critical","high","medium","low","defer","MOBILE_OPTIMIZATION_THRESHOLDS","criticalBundleSize","highPriorityBundleSize","lazyLoadThreshold","slowConnectionThreshold","lowMemoryThreshold","batteryLowThreshold","constructor","config","deviceContext","loadedBundles","Set","preloadedResources","enableCriticalResourcePreload","enablePortugueseContentGrouping","enableMobilePrioritization","enableCulturalContentSplitting","enableLazyLoadingThresholds","initializeDeviceContext","window","connection","navigator","isMobile","innerWidth","connectionType","effectiveType","deviceMemory","isDataSaverMode","saveData","viewportWidth","prefersReducedMotion","matchMedia","matches","preloadCriticalResources","criticalResources","splice","preloadPromises","map","resource","has","response","fetch","method","headers","ok","add","error","logger","info","Promise","allSettled","loadPortugueseContentBundle","priority","bundleKey","contentTypes","shouldDeferLoading","setTimeout","loadPromises","contentType","loadContentTypeBundle","bundleMap","optimizeForMobile","implementMobileOptimizations","setupIntersectionObserver","optimizePortugueseMobilePatterns","document","documentElement","classList","enableDataSaverMode","includes","enableSlowConnectionOptimizations","videos","querySelectorAll","forEach","video","removeAttribute","images","img","imgElement","src","replace","deferNonCriticalContent","criticalLinks","link","getAttribute","remove","observer","IntersectionObserver","entries","entry","isIntersecting","element","target","loadElementContent","unobserve","rootMargin","threshold","lazyElements","observe","dataset","portugueseLazy","loadCulturalGallery","loadCommunityFeed","loadBusinessListings","loadEventDetails","warn","default","CulturalGallery","innerHTML","CommunityFeed","BusinessDirectory","eventId","eventData","json","title","optimizeTouchTargets","optimizePortugueseTextRendering","optimizeCulturalTheming","touchTargets","rect","getBoundingClientRect","width","height","style","minWidth","minHeight","padding","textRendering","fontFeatureSettings","textElements","htmlElement","wordBreak","hyphens","lang","colorOptimizations","createElement","textContent","head","appendChild","nonCriticalSelectors","selector","elements","display","deferred","getOptimizationStats","optimizationsApplied","push","Array","from","cleanup","clear","stats","setStats","React","useState","isInitialized","setIsInitialized","statsUpdateTimeoutRef","useRef","useEffect","initializeOptimization","all","catch","err","resolve","updateStats","current","clearTimeout","interval","setInterval","clearInterval","loadBundle","useCallback","preloadResources","isOptimized","length","route","requestIdleCallback","rel","href","loading","sizes","culturalContentLoadTime","portugueseTextRenderTime","mobileOptimizationScore","start","performance","now","requestAnimationFrame","culturalElements","mobileElements","Math","min"],"mappings":"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"}