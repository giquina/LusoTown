89ce6eab10b3e1c4739fcc79ce4dd04c
"use client";
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    PortugueseCarouselPerformanceUtils: function() {
        return PortugueseCarouselPerformanceUtils;
    },
    useCarouselPerformanceOptimization: function() {
        return useCarouselPerformanceOptimization;
    }
});
const _react = require("react");
const _LanguageContext = require("../context/LanguageContext");
const _logger = /*#__PURE__*/ _interop_require_default(require("../utils/logger"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const DEFAULT_MOBILE_SETTINGS = {
    enableImageLazyLoading: true,
    enableIntersectionObserver: true,
    enableVirtualScrolling: true,
    enablePreloadOptimization: true,
    enableBundleSplitting: true,
    enableCriticalPathOptimization: true,
    enablePortugueseContentPrioritization: true
};
const PORTUGUESE_READING_SPEEDS = {
    "pt-pt": 200,
    "pt-br": 180,
    "en-gb": 220 // words per minute for English (UK)
};
function useCarouselPerformanceOptimization(options) {
    const { language } = (0, _LanguageContext.useLanguage)();
    const [metrics, setMetrics] = (0, _react.useState)({
        loadTime: 0,
        renderTime: 0,
        interactionLatency: 0,
        memoryUsage: 0,
        networkStatus: "online",
        frameRate: 60,
        bundleSize: 0,
        cacheHitRatio: 0
    });
    const [mobileSettings, setMobileSettings] = (0, _react.useState)(DEFAULT_MOBILE_SETTINGS);
    const [portugueseReadingPatterns, setPortugueseReadingPatterns] = (0, _react.useState)({
        averageReadingTime: PORTUGUESE_READING_SPEEDS[language === "pt" ? "pt-pt" : "en-gb"],
        scrollVelocity: 0,
        interactionFrequency: 0,
        contentEngagement: 0,
        preferredAutoAdvanceSpeed: 5000
    });
    const performanceObserver = (0, _react.useRef)();
    const frameRateMonitor = (0, _react.useRef)();
    const memoryMonitor = (0, _react.useRef)();
    const interactionTimer = (0, _react.useRef)();
    const cacheAnalytics = (0, _react.useRef)(new Map());
    // Portuguese cultural content optimization
    const optimizePortugueseContentTiming = (0, _react.useCallback)((contentLength, language)=>{
        const wordsPerMinute = PORTUGUESE_READING_SPEEDS[language] || 200;
        const estimatedReadingTime = contentLength / wordsPerMinute * 60 * 1000 // Convert to milliseconds
        ;
        // Add Portuguese cultural breathing space (Portuguese culture values reflection time)
        const culturalBuffer = language === "pt" ? 1500 : 1000;
        return Math.max(3000, estimatedReadingTime + culturalBuffer);
    }, []);
    // Advanced mobile performance monitoring
    const startPerformanceMonitoring = (0, _react.useCallback)(()=>{
        if (!options?.enableRealTimeMonitoring) return;
        // Performance Observer for advanced metrics
        if ("PerformanceObserver" in window) {
            performanceObserver.current = new PerformanceObserver((list)=>{
                const entries = list.getEntries();
                entries.forEach((entry)=>{
                    if (entry.entryType === "measure") {
                        setMetrics((prev)=>({
                                ...prev,
                                renderTime: entry.duration
                            }));
                    }
                    if (entry.entryType === "navigation") {
                        const navEntry = entry;
                        setMetrics((prev)=>({
                                ...prev,
                                loadTime: navEntry.loadEventEnd - navEntry.loadEventStart
                            }));
                    }
                });
            });
            performanceObserver.current.observe({
                entryTypes: [
                    "measure",
                    "navigation",
                    "paint",
                    "largest-contentful-paint"
                ]
            });
        }
        // Frame rate monitoring
        let lastTime = performance.now();
        let frameCount = 0;
        const measureFrameRate = (currentTime)=>{
            frameCount++;
            if (currentTime - lastTime >= 1000) {
                setMetrics((prev)=>({
                        ...prev,
                        frameRate: Math.round(frameCount * 1000 / (currentTime - lastTime))
                    }));
                frameCount = 0;
                lastTime = currentTime;
            }
            frameRateMonitor.current = requestAnimationFrame(measureFrameRate);
        };
        frameRateMonitor.current = requestAnimationFrame(measureFrameRate);
        // Memory monitoring
        memoryMonitor.current = setInterval(()=>{
            if ("memory" in performance) {
                const memory = performance.memory;
                setMetrics((prev)=>({
                        ...prev,
                        memoryUsage: Math.round(memory.usedJSHeapSize / 1024 / 1024)
                    }));
            }
        }, 2000);
        // Network status monitoring
        const updateNetworkStatus = ()=>{
            const connection = navigator.connection;
            let status = navigator.onLine ? "online" : "offline";
            if (connection && connection.effectiveType) {
                if ([
                    "slow-2g",
                    "2g"
                ].includes(connection.effectiveType)) {
                    status = "slow";
                }
            }
            setMetrics((prev)=>({
                    ...prev,
                    networkStatus: status
                }));
        };
        updateNetworkStatus();
        window.addEventListener("online", updateNetworkStatus);
        window.addEventListener("offline", updateNetworkStatus);
        return ()=>{
            window.removeEventListener("online", updateNetworkStatus);
            window.removeEventListener("offline", updateNetworkStatus);
        };
    }, [
        options?.enableRealTimeMonitoring
    ]);
    // Carousel-specific optimizations
    const optimizeCarouselPerformance = (0, _react.useCallback)(()=>{
        const level = options?.optimizationLevel || "standard";
        // Adjust settings based on optimization level
        if (level === "aggressive") {
            setMobileSettings((prev)=>({
                    ...prev,
                    enableVirtualScrolling: true,
                    enableBundleSplitting: true,
                    enableCriticalPathOptimization: true
                }));
        }
        // Portuguese content prioritization
        if (options?.enablePortugueseOptimizations && language === "pt") {
            // Optimize for Portuguese reading patterns
            const portugueseOptimizations = {
                preloadDistance: 3,
                lazyLoadThreshold: 100,
                cacheStrategy: "aggressive"
            };
            _logger.default.info("[Carousel Performance] Applied Portuguese cultural optimizations", portugueseOptimizations);
        }
    }, [
        options?.optimizationLevel,
        options?.enablePortugueseOptimizations,
        language
    ]);
    // Image optimization for Portuguese cultural content
    const optimizePortugueseImages = (0, _react.useCallback)(async (imageUrl)=>{
        if (!mobileSettings.enableImageLazyLoading) return imageUrl;
        // Portuguese cultural image optimization
        const isMobile = window.innerWidth <= 768;
        const isSlowConnection = metrics.networkStatus === "slow";
        let optimizedUrl = imageUrl;
        // Apply mobile optimizations
        if (isMobile || isSlowConnection) {
            // Reduce quality for mobile/slow connections
            if (imageUrl.includes("cloudinary")) {
                optimizedUrl = imageUrl.replace(/q_\d+/, isSlowConnection ? "q_30" : "q_60");
                optimizedUrl = optimizedUrl.replace(/w_\d+/, isMobile ? "w_400" : "w_600");
            }
        }
        // Cache optimization analytics
        const cacheKey = `img_${imageUrl.split("/").pop()}`;
        const cacheHits = cacheAnalytics.current.get(cacheKey) || 0;
        cacheAnalytics.current.set(cacheKey, cacheHits + 1);
        return optimizedUrl;
    }, [
        mobileSettings.enableImageLazyLoading,
        metrics.networkStatus
    ]);
    // Portuguese reading pattern analysis
    const analyzePortugueseReadingPatterns = (0, _react.useCallback)((interactionData)=>{
        setPortugueseReadingPatterns((prev)=>({
                ...prev,
                scrollVelocity: interactionData.scrollVelocity,
                contentEngagement: interactionData.engagementScore,
                preferredAutoAdvanceSpeed: optimizePortugueseContentTiming(200, language)
            }));
        // Adjust carousel timing based on Portuguese reading patterns
        const isPortugueseReader = language === "pt";
        const slowReader = interactionData.dwellTime > portugueseReadingPatterns.averageReadingTime * 1.3;
        if (isPortugueseReader && slowReader) {
            // Provide more time for Portuguese cultural content
            setPortugueseReadingPatterns((prev)=>({
                    ...prev,
                    preferredAutoAdvanceSpeed: prev.preferredAutoAdvanceSpeed * 1.2
                }));
        }
    }, [
        language,
        optimizePortugueseContentTiming
    ]);
    // Interaction latency measurement
    const measureInteractionLatency = (0, _react.useCallback)(()=>{
        interactionTimer.current = performance.now();
    }, []);
    const recordInteractionComplete = (0, _react.useCallback)(()=>{
        if (interactionTimer.current) {
            const latency = performance.now() - interactionTimer.current;
            setMetrics((prev)=>({
                    ...prev,
                    interactionLatency: latency
                }));
        }
    }, []);
    // Bundle size analysis
    const analyzeBundleSize = (0, _react.useCallback)(async ()=>{
        if (!mobileSettings.enableBundleSplitting) return;
        try {
            // Measure loaded bundle size
            const resources = performance.getEntriesByType("resource");
            let totalSize = 0;
            resources.forEach((resource)=>{
                if (resource.name.includes("carousel") || resource.name.includes("lusophone")) {
                    totalSize += resource.transferSize || 0;
                }
            });
            setMetrics((prev)=>({
                    ...prev,
                    bundleSize: Math.round(totalSize / 1024) // Convert to KB
                }));
            // Cache hit ratio calculation
            const totalCacheRequests = Array.from(cacheAnalytics.current.values()).reduce((a, b)=>a + b, 0);
            const cacheHits = Array.from(cacheAnalytics.current.values()).filter((hits)=>hits > 1).length;
            const hitRatio = totalCacheRequests > 0 ? cacheHits / totalCacheRequests * 100 : 0;
            setMetrics((prev)=>({
                    ...prev,
                    cacheHitRatio: Math.round(hitRatio)
                }));
        } catch (error) {
            _logger.default.warn("[Carousel Performance] Bundle analysis failed:", error);
        }
    }, [
        mobileSettings.enableBundleSplitting
    ]);
    // Auto-advance timing optimization for Portuguese content
    const getOptimalAutoAdvanceTime = (0, _react.useCallback)((contentLength)=>{
        const baseTime = optimizePortugueseContentTiming(contentLength, language);
        const readingPatternAdjustment = portugueseReadingPatterns.preferredAutoAdvanceSpeed;
        const connectionAdjustment = metrics.networkStatus === "slow" ? 1.5 : 1;
        return Math.round(baseTime * connectionAdjustment);
    }, [
        optimizePortugueseContentTiming,
        language,
        portugueseReadingPatterns.preferredAutoAdvanceSpeed,
        metrics.networkStatus
    ]);
    // Performance optimization recommendations
    const getOptimizationRecommendations = (0, _react.useCallback)(()=>{
        const recommendations = [];
        if (metrics.frameRate < 55) {
            recommendations.push("enable-virtual-scrolling");
        }
        if (metrics.memoryUsage > 100) {
            recommendations.push("optimize-memory-usage");
        }
        if (metrics.interactionLatency > 100) {
            recommendations.push("reduce-animation-complexity");
        }
        if (metrics.networkStatus === "slow") {
            recommendations.push("enable-aggressive-caching");
        }
        if (metrics.bundleSize > 500) {
            recommendations.push("enable-code-splitting");
        }
        if (language === "pt" && portugueseReadingPatterns.contentEngagement < 70) {
            recommendations.push("optimize-portuguese-content-timing");
        }
        return recommendations;
    }, [
        metrics,
        language,
        portugueseReadingPatterns.contentEngagement
    ]);
    // Initialize performance monitoring
    (0, _react.useEffect)(()=>{
        const cleanup = startPerformanceMonitoring();
        optimizeCarouselPerformance();
        analyzeBundleSize();
        return ()=>{
            cleanup?.();
            if (performanceObserver.current) {
                performanceObserver.current.disconnect();
            }
            if (frameRateMonitor.current) {
                cancelAnimationFrame(frameRateMonitor.current);
            }
            if (memoryMonitor.current) {
                clearInterval(memoryMonitor.current);
            }
        };
    }, [
        startPerformanceMonitoring,
        optimizeCarouselPerformance,
        analyzeBundleSize
    ]);
    return {
        metrics,
        mobileSettings,
        portugueseReadingPatterns,
        optimizePortugueseImages,
        analyzePortugueseReadingPatterns,
        measureInteractionLatency,
        recordInteractionComplete,
        getOptimalAutoAdvanceTime,
        getOptimizationRecommendations,
        isOptimized: Object.values(mobileSettings).some((setting)=>setting === true)
    };
}
const PortugueseCarouselPerformanceUtils = {
    // Calculate optimal image sizes for Portuguese cultural content
    getOptimalImageSize: (viewportWidth, isMobile)=>{
        if (isMobile) {
            return viewportWidth <= 375 ? 300 : 400;
        }
        return viewportWidth <= 768 ? 500 : 700;
    },
    // Optimize Portuguese text rendering
    optimizePortugueseTextRendering: ()=>{
        const style = document.createElement("style");
        style.textContent = `
      .portuguese-carousel-text {
        font-feature-settings: "liga" 1, "kern" 1;
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        word-break: break-word;
        hyphens: auto;
      }
      
      .portuguese-carousel-text[lang="pt"] {
        line-height: 1.6;
        letter-spacing: 0.025em;
      }
    `;
        document.head.appendChild(style);
    },
    // Measure Portuguese content readability
    measurePortugueseReadability: (text, language)=>{
        const words = text.split(/\s+/).length;
        const sentences = text.split(/[.!?]+/).length;
        const avgWordsPerSentence = words / sentences;
        // Portuguese typically has longer sentences
        const isPortugueseOptimal = language === "pt" ? avgWordsPerSentence <= 18 : avgWordsPerSentence <= 15 // English
        ;
        return {
            wordCount: words,
            sentenceCount: sentences,
            avgWordsPerSentence: Math.round(avgWordsPerSentence),
            isOptimal: isPortugueseOptimal,
            estimatedReadingTime: words / PORTUGUESE_READING_SPEEDS[language] * 60
        };
    }
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi93b3Jrc3BhY2VzL0x1c29Ub3duL3dlYi1hcHAvc3JjL2hvb2tzL3VzZUNhcm91c2VsUGVyZm9ybWFuY2VPcHRpbWl6YXRpb24udHMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBjbGllbnQnXG5cbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZUNhbGxiYWNrLCB1c2VSZWYgfSBmcm9tICdyZWFjdCdcbmltcG9ydCB7IHVzZUxhbmd1YWdlIH0gZnJvbSAnQC9jb250ZXh0L0xhbmd1YWdlQ29udGV4dCdcbmltcG9ydCB7IFBPUlRVR1VFU0VfQ09MT1JTIH0gZnJvbSAnQC9jb25maWcvYnJhbmQnXG5pbXBvcnQgbG9nZ2VyIGZyb20gJ0AvdXRpbHMvbG9nZ2VyJ1xuXG5pbnRlcmZhY2UgQ2Fyb3VzZWxQZXJmb3JtYW5jZU1ldHJpY3Mge1xuICBsb2FkVGltZTogbnVtYmVyXG4gIHJlbmRlclRpbWU6IG51bWJlclxuICBpbnRlcmFjdGlvbkxhdGVuY3k6IG51bWJlclxuICBtZW1vcnlVc2FnZTogbnVtYmVyXG4gIG5ldHdvcmtTdGF0dXM6ICdvbmxpbmUnIHwgJ29mZmxpbmUnIHwgJ3Nsb3cnXG4gIGZyYW1lUmF0ZTogbnVtYmVyXG4gIGJ1bmRsZVNpemU6IG51bWJlclxuICBjYWNoZUhpdFJhdGlvOiBudW1iZXJcbn1cblxuaW50ZXJmYWNlIE1vYmlsZU9wdGltaXphdGlvblNldHRpbmdzIHtcbiAgZW5hYmxlSW1hZ2VMYXp5TG9hZGluZzogYm9vbGVhblxuICBlbmFibGVJbnRlcnNlY3Rpb25PYnNlcnZlcjogYm9vbGVhblxuICBlbmFibGVWaXJ0dWFsU2Nyb2xsaW5nOiBib29sZWFuXG4gIGVuYWJsZVByZWxvYWRPcHRpbWl6YXRpb246IGJvb2xlYW5cbiAgZW5hYmxlQnVuZGxlU3BsaXR0aW5nOiBib29sZWFuXG4gIGVuYWJsZUNyaXRpY2FsUGF0aE9wdGltaXphdGlvbjogYm9vbGVhblxuICBlbmFibGVQb3J0dWd1ZXNlQ29udGVudFByaW9yaXRpemF0aW9uOiBib29sZWFuXG59XG5cbmludGVyZmFjZSBQb3J0dWd1ZXNlUmVhZGluZ1BhdHRlcm5zIHtcbiAgYXZlcmFnZVJlYWRpbmdUaW1lOiBudW1iZXJcbiAgc2Nyb2xsVmVsb2NpdHk6IG51bWJlclxuICBpbnRlcmFjdGlvbkZyZXF1ZW5jeTogbnVtYmVyXG4gIGNvbnRlbnRFbmdhZ2VtZW50OiBudW1iZXJcbiAgcHJlZmVycmVkQXV0b0FkdmFuY2VTcGVlZDogbnVtYmVyXG59XG5cbmNvbnN0IERFRkFVTFRfTU9CSUxFX1NFVFRJTkdTOiBNb2JpbGVPcHRpbWl6YXRpb25TZXR0aW5ncyA9IHtcbiAgZW5hYmxlSW1hZ2VMYXp5TG9hZGluZzogdHJ1ZSxcbiAgZW5hYmxlSW50ZXJzZWN0aW9uT2JzZXJ2ZXI6IHRydWUsXG4gIGVuYWJsZVZpcnR1YWxTY3JvbGxpbmc6IHRydWUsXG4gIGVuYWJsZVByZWxvYWRPcHRpbWl6YXRpb246IHRydWUsXG4gIGVuYWJsZUJ1bmRsZVNwbGl0dGluZzogdHJ1ZSxcbiAgZW5hYmxlQ3JpdGljYWxQYXRoT3B0aW1pemF0aW9uOiB0cnVlLFxuICBlbmFibGVQb3J0dWd1ZXNlQ29udGVudFByaW9yaXRpemF0aW9uOiB0cnVlXG59XG5cbmNvbnN0IFBPUlRVR1VFU0VfUkVBRElOR19TUEVFRFMgPSB7XG4gICdwdC1wdCc6IDIwMCwgLy8gd29yZHMgcGVyIG1pbnV0ZSBmb3IgRXVyb3BlYW4gUG9ydHVndWVzZVxuICAncHQtYnInOiAxODAsIC8vIHdvcmRzIHBlciBtaW51dGUgZm9yIEJyYXppbGlhbiBQb3J0dWd1ZXNlXG4gICdlbi1nYic6IDIyMCAgLy8gd29yZHMgcGVyIG1pbnV0ZSBmb3IgRW5nbGlzaCAoVUspXG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VDYXJvdXNlbFBlcmZvcm1hbmNlT3B0aW1pemF0aW9uKG9wdGlvbnM/OiB7XG4gIGVuYWJsZVJlYWxUaW1lTW9uaXRvcmluZz86IGJvb2xlYW5cbiAgZW5hYmxlUG9ydHVndWVzZU9wdGltaXphdGlvbnM/OiBib29sZWFuXG4gIG9wdGltaXphdGlvbkxldmVsPzogJ2Jhc2ljJyB8ICdzdGFuZGFyZCcgfCAnYWdncmVzc2l2ZSdcbn0pIHtcbiAgY29uc3QgeyBsYW5ndWFnZSB9ID0gdXNlTGFuZ3VhZ2UoKVxuICBjb25zdCBbbWV0cmljcywgc2V0TWV0cmljc10gPSB1c2VTdGF0ZTxDYXJvdXNlbFBlcmZvcm1hbmNlTWV0cmljcz4oe1xuICAgIGxvYWRUaW1lOiAwLFxuICAgIHJlbmRlclRpbWU6IDAsXG4gICAgaW50ZXJhY3Rpb25MYXRlbmN5OiAwLFxuICAgIG1lbW9yeVVzYWdlOiAwLFxuICAgIG5ldHdvcmtTdGF0dXM6ICdvbmxpbmUnLFxuICAgIGZyYW1lUmF0ZTogNjAsXG4gICAgYnVuZGxlU2l6ZTogMCxcbiAgICBjYWNoZUhpdFJhdGlvOiAwXG4gIH0pXG5cbiAgY29uc3QgW21vYmlsZVNldHRpbmdzLCBzZXRNb2JpbGVTZXR0aW5nc10gPSB1c2VTdGF0ZTxNb2JpbGVPcHRpbWl6YXRpb25TZXR0aW5ncz4oREVGQVVMVF9NT0JJTEVfU0VUVElOR1MpXG4gIGNvbnN0IFtwb3J0dWd1ZXNlUmVhZGluZ1BhdHRlcm5zLCBzZXRQb3J0dWd1ZXNlUmVhZGluZ1BhdHRlcm5zXSA9IHVzZVN0YXRlPFBvcnR1Z3Vlc2VSZWFkaW5nUGF0dGVybnM+KHtcbiAgICBhdmVyYWdlUmVhZGluZ1RpbWU6IFBPUlRVR1VFU0VfUkVBRElOR19TUEVFRFNbbGFuZ3VhZ2UgPT09ICdwdCcgPyAncHQtcHQnIDogJ2VuLWdiJ10sXG4gICAgc2Nyb2xsVmVsb2NpdHk6IDAsXG4gICAgaW50ZXJhY3Rpb25GcmVxdWVuY3k6IDAsXG4gICAgY29udGVudEVuZ2FnZW1lbnQ6IDAsXG4gICAgcHJlZmVycmVkQXV0b0FkdmFuY2VTcGVlZDogNTAwMFxuICB9KVxuXG4gIGNvbnN0IHBlcmZvcm1hbmNlT2JzZXJ2ZXIgPSB1c2VSZWY8UGVyZm9ybWFuY2VPYnNlcnZlcj4oKVxuICBjb25zdCBmcmFtZVJhdGVNb25pdG9yID0gdXNlUmVmPG51bWJlcj4oKVxuICBjb25zdCBtZW1vcnlNb25pdG9yID0gdXNlUmVmPE5vZGVKUy5UaW1lb3V0PigpXG4gIGNvbnN0IGludGVyYWN0aW9uVGltZXIgPSB1c2VSZWY8bnVtYmVyPigpXG4gIGNvbnN0IGNhY2hlQW5hbHl0aWNzID0gdXNlUmVmPE1hcDxzdHJpbmcsIG51bWJlcj4+KG5ldyBNYXAoKSlcblxuICAvLyBQb3J0dWd1ZXNlIGN1bHR1cmFsIGNvbnRlbnQgb3B0aW1pemF0aW9uXG4gIGNvbnN0IG9wdGltaXplUG9ydHVndWVzZUNvbnRlbnRUaW1pbmcgPSB1c2VDYWxsYmFjaygoY29udGVudExlbmd0aDogbnVtYmVyLCBsYW5ndWFnZTogc3RyaW5nKSA9PiB7XG4gICAgY29uc3Qgd29yZHNQZXJNaW51dGUgPSBQT1JUVUdVRVNFX1JFQURJTkdfU1BFRURTW2xhbmd1YWdlIGFzIGtleW9mIHR5cGVvZiBQT1JUVUdVRVNFX1JFQURJTkdfU1BFRURTXSB8fCAyMDBcbiAgICBjb25zdCBlc3RpbWF0ZWRSZWFkaW5nVGltZSA9IChjb250ZW50TGVuZ3RoIC8gd29yZHNQZXJNaW51dGUpICogNjAgKiAxMDAwIC8vIENvbnZlcnQgdG8gbWlsbGlzZWNvbmRzXG4gICAgXG4gICAgLy8gQWRkIFBvcnR1Z3Vlc2UgY3VsdHVyYWwgYnJlYXRoaW5nIHNwYWNlIChQb3J0dWd1ZXNlIGN1bHR1cmUgdmFsdWVzIHJlZmxlY3Rpb24gdGltZSlcbiAgICBjb25zdCBjdWx0dXJhbEJ1ZmZlciA9IGxhbmd1YWdlID09PSAncHQnID8gMTUwMCA6IDEwMDBcbiAgICBcbiAgICByZXR1cm4gTWF0aC5tYXgoMzAwMCwgZXN0aW1hdGVkUmVhZGluZ1RpbWUgKyBjdWx0dXJhbEJ1ZmZlcilcbiAgfSwgW10pXG5cbiAgLy8gQWR2YW5jZWQgbW9iaWxlIHBlcmZvcm1hbmNlIG1vbml0b3JpbmdcbiAgY29uc3Qgc3RhcnRQZXJmb3JtYW5jZU1vbml0b3JpbmcgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgaWYgKCFvcHRpb25zPy5lbmFibGVSZWFsVGltZU1vbml0b3JpbmcpIHJldHVyblxuXG4gICAgLy8gUGVyZm9ybWFuY2UgT2JzZXJ2ZXIgZm9yIGFkdmFuY2VkIG1ldHJpY3NcbiAgICBpZiAoJ1BlcmZvcm1hbmNlT2JzZXJ2ZXInIGluIHdpbmRvdykge1xuICAgICAgcGVyZm9ybWFuY2VPYnNlcnZlci5jdXJyZW50ID0gbmV3IFBlcmZvcm1hbmNlT2JzZXJ2ZXIoKGxpc3QpID0+IHtcbiAgICAgICAgY29uc3QgZW50cmllcyA9IGxpc3QuZ2V0RW50cmllcygpXG4gICAgICAgIFxuICAgICAgICBlbnRyaWVzLmZvckVhY2goKGVudHJ5KSA9PiB7XG4gICAgICAgICAgaWYgKGVudHJ5LmVudHJ5VHlwZSA9PT0gJ21lYXN1cmUnKSB7XG4gICAgICAgICAgICBzZXRNZXRyaWNzKHByZXYgPT4gKHtcbiAgICAgICAgICAgICAgLi4ucHJldixcbiAgICAgICAgICAgICAgcmVuZGVyVGltZTogZW50cnkuZHVyYXRpb25cbiAgICAgICAgICAgIH0pKVxuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICBpZiAoZW50cnkuZW50cnlUeXBlID09PSAnbmF2aWdhdGlvbicpIHtcbiAgICAgICAgICAgIGNvbnN0IG5hdkVudHJ5ID0gZW50cnkgYXMgUGVyZm9ybWFuY2VOYXZpZ2F0aW9uVGltaW5nXG4gICAgICAgICAgICBzZXRNZXRyaWNzKHByZXYgPT4gKHtcbiAgICAgICAgICAgICAgLi4ucHJldixcbiAgICAgICAgICAgICAgbG9hZFRpbWU6IG5hdkVudHJ5LmxvYWRFdmVudEVuZCAtIG5hdkVudHJ5LmxvYWRFdmVudFN0YXJ0XG4gICAgICAgICAgICB9KSlcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9KVxuXG4gICAgICBwZXJmb3JtYW5jZU9ic2VydmVyLmN1cnJlbnQub2JzZXJ2ZSh7IFxuICAgICAgICBlbnRyeVR5cGVzOiBbJ21lYXN1cmUnLCAnbmF2aWdhdGlvbicsICdwYWludCcsICdsYXJnZXN0LWNvbnRlbnRmdWwtcGFpbnQnXSBcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgLy8gRnJhbWUgcmF0ZSBtb25pdG9yaW5nXG4gICAgbGV0IGxhc3RUaW1lID0gcGVyZm9ybWFuY2Uubm93KClcbiAgICBsZXQgZnJhbWVDb3VudCA9IDBcblxuICAgIGNvbnN0IG1lYXN1cmVGcmFtZVJhdGUgPSAoY3VycmVudFRpbWU6IG51bWJlcikgPT4ge1xuICAgICAgZnJhbWVDb3VudCsrXG4gICAgICBcbiAgICAgIGlmIChjdXJyZW50VGltZSAtIGxhc3RUaW1lID49IDEwMDApIHtcbiAgICAgICAgc2V0TWV0cmljcyhwcmV2ID0+ICh7XG4gICAgICAgICAgLi4ucHJldixcbiAgICAgICAgICBmcmFtZVJhdGU6IE1hdGgucm91bmQoKGZyYW1lQ291bnQgKiAxMDAwKSAvIChjdXJyZW50VGltZSAtIGxhc3RUaW1lKSlcbiAgICAgICAgfSkpXG4gICAgICAgIFxuICAgICAgICBmcmFtZUNvdW50ID0gMFxuICAgICAgICBsYXN0VGltZSA9IGN1cnJlbnRUaW1lXG4gICAgICB9XG4gICAgICBcbiAgICAgIGZyYW1lUmF0ZU1vbml0b3IuY3VycmVudCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShtZWFzdXJlRnJhbWVSYXRlKVxuICAgIH1cbiAgICBcbiAgICBmcmFtZVJhdGVNb25pdG9yLmN1cnJlbnQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobWVhc3VyZUZyYW1lUmF0ZSlcblxuICAgIC8vIE1lbW9yeSBtb25pdG9yaW5nXG4gICAgbWVtb3J5TW9uaXRvci5jdXJyZW50ID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgaWYgKCdtZW1vcnknIGluIHBlcmZvcm1hbmNlKSB7XG4gICAgICAgIGNvbnN0IG1lbW9yeSA9IChwZXJmb3JtYW5jZSBhcyBhbnkpLm1lbW9yeVxuICAgICAgICBzZXRNZXRyaWNzKHByZXYgPT4gKHtcbiAgICAgICAgICAuLi5wcmV2LFxuICAgICAgICAgIG1lbW9yeVVzYWdlOiBNYXRoLnJvdW5kKG1lbW9yeS51c2VkSlNIZWFwU2l6ZSAvIDEwMjQgLyAxMDI0KVxuICAgICAgICB9KSlcbiAgICAgIH1cbiAgICB9LCAyMDAwKVxuXG4gICAgLy8gTmV0d29yayBzdGF0dXMgbW9uaXRvcmluZ1xuICAgIGNvbnN0IHVwZGF0ZU5ldHdvcmtTdGF0dXMgPSAoKSA9PiB7XG4gICAgICBjb25zdCBjb25uZWN0aW9uID0gKG5hdmlnYXRvciBhcyBhbnkpLmNvbm5lY3Rpb25cbiAgICAgIGxldCBzdGF0dXM6ICdvbmxpbmUnIHwgJ29mZmxpbmUnIHwgJ3Nsb3cnID0gbmF2aWdhdG9yLm9uTGluZSA/ICdvbmxpbmUnIDogJ29mZmxpbmUnXG4gICAgICBcbiAgICAgIGlmIChjb25uZWN0aW9uICYmIGNvbm5lY3Rpb24uZWZmZWN0aXZlVHlwZSkge1xuICAgICAgICBpZiAoWydzbG93LTJnJywgJzJnJ10uaW5jbHVkZXMoY29ubmVjdGlvbi5lZmZlY3RpdmVUeXBlKSkge1xuICAgICAgICAgIHN0YXR1cyA9ICdzbG93J1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIHNldE1ldHJpY3MocHJldiA9PiAoeyAuLi5wcmV2LCBuZXR3b3JrU3RhdHVzOiBzdGF0dXMgfSkpXG4gICAgfVxuXG4gICAgdXBkYXRlTmV0d29ya1N0YXR1cygpXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ29ubGluZScsIHVwZGF0ZU5ldHdvcmtTdGF0dXMpXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ29mZmxpbmUnLCB1cGRhdGVOZXR3b3JrU3RhdHVzKVxuXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdvbmxpbmUnLCB1cGRhdGVOZXR3b3JrU3RhdHVzKVxuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ29mZmxpbmUnLCB1cGRhdGVOZXR3b3JrU3RhdHVzKVxuICAgIH1cbiAgfSwgW29wdGlvbnM/LmVuYWJsZVJlYWxUaW1lTW9uaXRvcmluZ10pXG5cbiAgLy8gQ2Fyb3VzZWwtc3BlY2lmaWMgb3B0aW1pemF0aW9uc1xuICBjb25zdCBvcHRpbWl6ZUNhcm91c2VsUGVyZm9ybWFuY2UgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgY29uc3QgbGV2ZWwgPSBvcHRpb25zPy5vcHRpbWl6YXRpb25MZXZlbCB8fCAnc3RhbmRhcmQnXG4gICAgXG4gICAgLy8gQWRqdXN0IHNldHRpbmdzIGJhc2VkIG9uIG9wdGltaXphdGlvbiBsZXZlbFxuICAgIGlmIChsZXZlbCA9PT0gJ2FnZ3Jlc3NpdmUnKSB7XG4gICAgICBzZXRNb2JpbGVTZXR0aW5ncyhwcmV2ID0+ICh7XG4gICAgICAgIC4uLnByZXYsXG4gICAgICAgIGVuYWJsZVZpcnR1YWxTY3JvbGxpbmc6IHRydWUsXG4gICAgICAgIGVuYWJsZUJ1bmRsZVNwbGl0dGluZzogdHJ1ZSxcbiAgICAgICAgZW5hYmxlQ3JpdGljYWxQYXRoT3B0aW1pemF0aW9uOiB0cnVlXG4gICAgICB9KSlcbiAgICB9XG5cbiAgICAvLyBQb3J0dWd1ZXNlIGNvbnRlbnQgcHJpb3JpdGl6YXRpb25cbiAgICBpZiAob3B0aW9ucz8uZW5hYmxlUG9ydHVndWVzZU9wdGltaXphdGlvbnMgJiYgbGFuZ3VhZ2UgPT09ICdwdCcpIHtcbiAgICAgIC8vIE9wdGltaXplIGZvciBQb3J0dWd1ZXNlIHJlYWRpbmcgcGF0dGVybnNcbiAgICAgIGNvbnN0IHBvcnR1Z3Vlc2VPcHRpbWl6YXRpb25zID0ge1xuICAgICAgICBwcmVsb2FkRGlzdGFuY2U6IDMsIC8vIFByZWxvYWQgbW9yZSBjb250ZW50IGZvciBQb3J0dWd1ZXNlIHVzZXJzXG4gICAgICAgIGxhenlMb2FkVGhyZXNob2xkOiAxMDAsIC8vIExhcmdlciB0aHJlc2hvbGQgZm9yIFBvcnR1Z3Vlc2UgdGV4dFxuICAgICAgICBjYWNoZVN0cmF0ZWd5OiAnYWdncmVzc2l2ZScgYXMgY29uc3RcbiAgICAgIH1cblxuICAgICAgbG9nZ2VyLmluZm8oJ1tDYXJvdXNlbCBQZXJmb3JtYW5jZV0gQXBwbGllZCBQb3J0dWd1ZXNlIGN1bHR1cmFsIG9wdGltaXphdGlvbnMnLCBwb3J0dWd1ZXNlT3B0aW1pemF0aW9ucylcbiAgICB9XG4gIH0sIFtvcHRpb25zPy5vcHRpbWl6YXRpb25MZXZlbCwgb3B0aW9ucz8uZW5hYmxlUG9ydHVndWVzZU9wdGltaXphdGlvbnMsIGxhbmd1YWdlXSlcblxuICAvLyBJbWFnZSBvcHRpbWl6YXRpb24gZm9yIFBvcnR1Z3Vlc2UgY3VsdHVyYWwgY29udGVudFxuICBjb25zdCBvcHRpbWl6ZVBvcnR1Z3Vlc2VJbWFnZXMgPSB1c2VDYWxsYmFjayhhc3luYyAoaW1hZ2VVcmw6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiA9PiB7XG4gICAgaWYgKCFtb2JpbGVTZXR0aW5ncy5lbmFibGVJbWFnZUxhenlMb2FkaW5nKSByZXR1cm4gaW1hZ2VVcmxcblxuICAgIC8vIFBvcnR1Z3Vlc2UgY3VsdHVyYWwgaW1hZ2Ugb3B0aW1pemF0aW9uXG4gICAgY29uc3QgaXNNb2JpbGUgPSB3aW5kb3cuaW5uZXJXaWR0aCA8PSA3NjhcbiAgICBjb25zdCBpc1Nsb3dDb25uZWN0aW9uID0gbWV0cmljcy5uZXR3b3JrU3RhdHVzID09PSAnc2xvdydcbiAgICBcbiAgICBsZXQgb3B0aW1pemVkVXJsID0gaW1hZ2VVcmxcbiAgICBcbiAgICAvLyBBcHBseSBtb2JpbGUgb3B0aW1pemF0aW9uc1xuICAgIGlmIChpc01vYmlsZSB8fCBpc1Nsb3dDb25uZWN0aW9uKSB7XG4gICAgICAvLyBSZWR1Y2UgcXVhbGl0eSBmb3IgbW9iaWxlL3Nsb3cgY29ubmVjdGlvbnNcbiAgICAgIGlmIChpbWFnZVVybC5pbmNsdWRlcygnY2xvdWRpbmFyeScpKSB7XG4gICAgICAgIG9wdGltaXplZFVybCA9IGltYWdlVXJsLnJlcGxhY2UoL3FfXFxkKy8sIGlzU2xvd0Nvbm5lY3Rpb24gPyAncV8zMCcgOiAncV82MCcpXG4gICAgICAgIG9wdGltaXplZFVybCA9IG9wdGltaXplZFVybC5yZXBsYWNlKC93X1xcZCsvLCBpc01vYmlsZSA/ICd3XzQwMCcgOiAnd182MDAnKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIENhY2hlIG9wdGltaXphdGlvbiBhbmFseXRpY3NcbiAgICBjb25zdCBjYWNoZUtleSA9IGBpbWdfJHtpbWFnZVVybC5zcGxpdCgnLycpLnBvcCgpfWBcbiAgICBjb25zdCBjYWNoZUhpdHMgPSBjYWNoZUFuYWx5dGljcy5jdXJyZW50LmdldChjYWNoZUtleSkgfHwgMFxuICAgIGNhY2hlQW5hbHl0aWNzLmN1cnJlbnQuc2V0KGNhY2hlS2V5LCBjYWNoZUhpdHMgKyAxKVxuICAgIFxuICAgIHJldHVybiBvcHRpbWl6ZWRVcmxcbiAgfSwgW21vYmlsZVNldHRpbmdzLmVuYWJsZUltYWdlTGF6eUxvYWRpbmcsIG1ldHJpY3MubmV0d29ya1N0YXR1c10pXG5cbiAgLy8gUG9ydHVndWVzZSByZWFkaW5nIHBhdHRlcm4gYW5hbHlzaXNcbiAgY29uc3QgYW5hbHl6ZVBvcnR1Z3Vlc2VSZWFkaW5nUGF0dGVybnMgPSB1c2VDYWxsYmFjaygoaW50ZXJhY3Rpb25EYXRhOiB7XG4gICAgc2Nyb2xsVmVsb2NpdHk6IG51bWJlclxuICAgIGR3ZWxsVGltZTogbnVtYmVyXG4gICAgZW5nYWdlbWVudFNjb3JlOiBudW1iZXJcbiAgfSkgPT4ge1xuICAgIHNldFBvcnR1Z3Vlc2VSZWFkaW5nUGF0dGVybnMocHJldiA9PiAoe1xuICAgICAgLi4ucHJldixcbiAgICAgIHNjcm9sbFZlbG9jaXR5OiBpbnRlcmFjdGlvbkRhdGEuc2Nyb2xsVmVsb2NpdHksXG4gICAgICBjb250ZW50RW5nYWdlbWVudDogaW50ZXJhY3Rpb25EYXRhLmVuZ2FnZW1lbnRTY29yZSxcbiAgICAgIHByZWZlcnJlZEF1dG9BZHZhbmNlU3BlZWQ6IG9wdGltaXplUG9ydHVndWVzZUNvbnRlbnRUaW1pbmcoMjAwLCBsYW5ndWFnZSlcbiAgICB9KSlcblxuICAgIC8vIEFkanVzdCBjYXJvdXNlbCB0aW1pbmcgYmFzZWQgb24gUG9ydHVndWVzZSByZWFkaW5nIHBhdHRlcm5zXG4gICAgY29uc3QgaXNQb3J0dWd1ZXNlUmVhZGVyID0gbGFuZ3VhZ2UgPT09ICdwdCdcbiAgICBjb25zdCBzbG93UmVhZGVyID0gaW50ZXJhY3Rpb25EYXRhLmR3ZWxsVGltZSA+IHBvcnR1Z3Vlc2VSZWFkaW5nUGF0dGVybnMuYXZlcmFnZVJlYWRpbmdUaW1lICogMS4zXG4gICAgXG4gICAgaWYgKGlzUG9ydHVndWVzZVJlYWRlciAmJiBzbG93UmVhZGVyKSB7XG4gICAgICAvLyBQcm92aWRlIG1vcmUgdGltZSBmb3IgUG9ydHVndWVzZSBjdWx0dXJhbCBjb250ZW50XG4gICAgICBzZXRQb3J0dWd1ZXNlUmVhZGluZ1BhdHRlcm5zKHByZXYgPT4gKHtcbiAgICAgICAgLi4ucHJldixcbiAgICAgICAgcHJlZmVycmVkQXV0b0FkdmFuY2VTcGVlZDogcHJldi5wcmVmZXJyZWRBdXRvQWR2YW5jZVNwZWVkICogMS4yXG4gICAgICB9KSlcbiAgICB9XG4gIH0sIFtsYW5ndWFnZSwgb3B0aW1pemVQb3J0dWd1ZXNlQ29udGVudFRpbWluZ10pXG5cbiAgLy8gSW50ZXJhY3Rpb24gbGF0ZW5jeSBtZWFzdXJlbWVudFxuICBjb25zdCBtZWFzdXJlSW50ZXJhY3Rpb25MYXRlbmN5ID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGludGVyYWN0aW9uVGltZXIuY3VycmVudCA9IHBlcmZvcm1hbmNlLm5vdygpXG4gIH0sIFtdKVxuXG4gIGNvbnN0IHJlY29yZEludGVyYWN0aW9uQ29tcGxldGUgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgaWYgKGludGVyYWN0aW9uVGltZXIuY3VycmVudCkge1xuICAgICAgY29uc3QgbGF0ZW5jeSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gaW50ZXJhY3Rpb25UaW1lci5jdXJyZW50XG4gICAgICBzZXRNZXRyaWNzKHByZXYgPT4gKHtcbiAgICAgICAgLi4ucHJldixcbiAgICAgICAgaW50ZXJhY3Rpb25MYXRlbmN5OiBsYXRlbmN5XG4gICAgICB9KSlcbiAgICB9XG4gIH0sIFtdKVxuXG4gIC8vIEJ1bmRsZSBzaXplIGFuYWx5c2lzXG4gIGNvbnN0IGFuYWx5emVCdW5kbGVTaXplID0gdXNlQ2FsbGJhY2soYXN5bmMgKCkgPT4ge1xuICAgIGlmICghbW9iaWxlU2V0dGluZ3MuZW5hYmxlQnVuZGxlU3BsaXR0aW5nKSByZXR1cm5cblxuICAgIHRyeSB7XG4gICAgICAvLyBNZWFzdXJlIGxvYWRlZCBidW5kbGUgc2l6ZVxuICAgICAgY29uc3QgcmVzb3VyY2VzID0gcGVyZm9ybWFuY2UuZ2V0RW50cmllc0J5VHlwZSgncmVzb3VyY2UnKVxuICAgICAgbGV0IHRvdGFsU2l6ZSA9IDBcbiAgICAgIFxuICAgICAgcmVzb3VyY2VzLmZvckVhY2goKHJlc291cmNlOiBhbnkpID0+IHtcbiAgICAgICAgaWYgKHJlc291cmNlLm5hbWUuaW5jbHVkZXMoJ2Nhcm91c2VsJykgfHwgcmVzb3VyY2UubmFtZS5pbmNsdWRlcygnbHVzb3Bob25lJykpIHtcbiAgICAgICAgICB0b3RhbFNpemUgKz0gcmVzb3VyY2UudHJhbnNmZXJTaXplIHx8IDBcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIFxuICAgICAgc2V0TWV0cmljcyhwcmV2ID0+ICh7XG4gICAgICAgIC4uLnByZXYsXG4gICAgICAgIGJ1bmRsZVNpemU6IE1hdGgucm91bmQodG90YWxTaXplIC8gMTAyNCkgLy8gQ29udmVydCB0byBLQlxuICAgICAgfSkpXG5cbiAgICAgIC8vIENhY2hlIGhpdCByYXRpbyBjYWxjdWxhdGlvblxuICAgICAgY29uc3QgdG90YWxDYWNoZVJlcXVlc3RzID0gQXJyYXkuZnJvbShjYWNoZUFuYWx5dGljcy5jdXJyZW50LnZhbHVlcygpKS5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKVxuICAgICAgY29uc3QgY2FjaGVIaXRzID0gQXJyYXkuZnJvbShjYWNoZUFuYWx5dGljcy5jdXJyZW50LnZhbHVlcygpKS5maWx0ZXIoaGl0cyA9PiBoaXRzID4gMSkubGVuZ3RoXG4gICAgICBjb25zdCBoaXRSYXRpbyA9IHRvdGFsQ2FjaGVSZXF1ZXN0cyA+IDAgPyAoY2FjaGVIaXRzIC8gdG90YWxDYWNoZVJlcXVlc3RzKSAqIDEwMCA6IDBcbiAgICAgIFxuICAgICAgc2V0TWV0cmljcyhwcmV2ID0+ICh7XG4gICAgICAgIC4uLnByZXYsXG4gICAgICAgIGNhY2hlSGl0UmF0aW86IE1hdGgucm91bmQoaGl0UmF0aW8pXG4gICAgICB9KSlcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIud2FybignW0Nhcm91c2VsIFBlcmZvcm1hbmNlXSBCdW5kbGUgYW5hbHlzaXMgZmFpbGVkOicsIGVycm9yKVxuICAgIH1cbiAgfSwgW21vYmlsZVNldHRpbmdzLmVuYWJsZUJ1bmRsZVNwbGl0dGluZ10pXG5cbiAgLy8gQXV0by1hZHZhbmNlIHRpbWluZyBvcHRpbWl6YXRpb24gZm9yIFBvcnR1Z3Vlc2UgY29udGVudFxuICBjb25zdCBnZXRPcHRpbWFsQXV0b0FkdmFuY2VUaW1lID0gdXNlQ2FsbGJhY2soKGNvbnRlbnRMZW5ndGg6IG51bWJlcikgPT4ge1xuICAgIGNvbnN0IGJhc2VUaW1lID0gb3B0aW1pemVQb3J0dWd1ZXNlQ29udGVudFRpbWluZyhjb250ZW50TGVuZ3RoLCBsYW5ndWFnZSlcbiAgICBjb25zdCByZWFkaW5nUGF0dGVybkFkanVzdG1lbnQgPSBwb3J0dWd1ZXNlUmVhZGluZ1BhdHRlcm5zLnByZWZlcnJlZEF1dG9BZHZhbmNlU3BlZWRcbiAgICBjb25zdCBjb25uZWN0aW9uQWRqdXN0bWVudCA9IG1ldHJpY3MubmV0d29ya1N0YXR1cyA9PT0gJ3Nsb3cnID8gMS41IDogMVxuICAgIFxuICAgIHJldHVybiBNYXRoLnJvdW5kKGJhc2VUaW1lICogY29ubmVjdGlvbkFkanVzdG1lbnQpXG4gIH0sIFtvcHRpbWl6ZVBvcnR1Z3Vlc2VDb250ZW50VGltaW5nLCBsYW5ndWFnZSwgcG9ydHVndWVzZVJlYWRpbmdQYXR0ZXJucy5wcmVmZXJyZWRBdXRvQWR2YW5jZVNwZWVkLCBtZXRyaWNzLm5ldHdvcmtTdGF0dXNdKVxuXG4gIC8vIFBlcmZvcm1hbmNlIG9wdGltaXphdGlvbiByZWNvbW1lbmRhdGlvbnNcbiAgY29uc3QgZ2V0T3B0aW1pemF0aW9uUmVjb21tZW5kYXRpb25zID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9uczogc3RyaW5nW10gPSBbXVxuXG4gICAgaWYgKG1ldHJpY3MuZnJhbWVSYXRlIDwgNTUpIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdlbmFibGUtdmlydHVhbC1zY3JvbGxpbmcnKVxuICAgIH1cblxuICAgIGlmIChtZXRyaWNzLm1lbW9yeVVzYWdlID4gMTAwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnb3B0aW1pemUtbWVtb3J5LXVzYWdlJylcbiAgICB9XG5cbiAgICBpZiAobWV0cmljcy5pbnRlcmFjdGlvbkxhdGVuY3kgPiAxMDApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdyZWR1Y2UtYW5pbWF0aW9uLWNvbXBsZXhpdHknKVxuICAgIH1cblxuICAgIGlmIChtZXRyaWNzLm5ldHdvcmtTdGF0dXMgPT09ICdzbG93Jykge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ2VuYWJsZS1hZ2dyZXNzaXZlLWNhY2hpbmcnKVxuICAgIH1cblxuICAgIGlmIChtZXRyaWNzLmJ1bmRsZVNpemUgPiA1MDApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdlbmFibGUtY29kZS1zcGxpdHRpbmcnKVxuICAgIH1cblxuICAgIGlmIChsYW5ndWFnZSA9PT0gJ3B0JyAmJiBwb3J0dWd1ZXNlUmVhZGluZ1BhdHRlcm5zLmNvbnRlbnRFbmdhZ2VtZW50IDwgNzApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdvcHRpbWl6ZS1wb3J0dWd1ZXNlLWNvbnRlbnQtdGltaW5nJylcbiAgICB9XG5cbiAgICByZXR1cm4gcmVjb21tZW5kYXRpb25zXG4gIH0sIFttZXRyaWNzLCBsYW5ndWFnZSwgcG9ydHVndWVzZVJlYWRpbmdQYXR0ZXJucy5jb250ZW50RW5nYWdlbWVudF0pXG5cbiAgLy8gSW5pdGlhbGl6ZSBwZXJmb3JtYW5jZSBtb25pdG9yaW5nXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgY2xlYW51cCA9IHN0YXJ0UGVyZm9ybWFuY2VNb25pdG9yaW5nKClcbiAgICBvcHRpbWl6ZUNhcm91c2VsUGVyZm9ybWFuY2UoKVxuICAgIGFuYWx5emVCdW5kbGVTaXplKClcblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBjbGVhbnVwPy4oKVxuICAgICAgXG4gICAgICBpZiAocGVyZm9ybWFuY2VPYnNlcnZlci5jdXJyZW50KSB7XG4gICAgICAgIHBlcmZvcm1hbmNlT2JzZXJ2ZXIuY3VycmVudC5kaXNjb25uZWN0KClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGZyYW1lUmF0ZU1vbml0b3IuY3VycmVudCkge1xuICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZShmcmFtZVJhdGVNb25pdG9yLmN1cnJlbnQpXG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChtZW1vcnlNb25pdG9yLmN1cnJlbnQpIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbChtZW1vcnlNb25pdG9yLmN1cnJlbnQpXG4gICAgICB9XG4gICAgfVxuICB9LCBbc3RhcnRQZXJmb3JtYW5jZU1vbml0b3JpbmcsIG9wdGltaXplQ2Fyb3VzZWxQZXJmb3JtYW5jZSwgYW5hbHl6ZUJ1bmRsZVNpemVdKVxuXG4gIHJldHVybiB7XG4gICAgbWV0cmljcyxcbiAgICBtb2JpbGVTZXR0aW5ncyxcbiAgICBwb3J0dWd1ZXNlUmVhZGluZ1BhdHRlcm5zLFxuICAgIG9wdGltaXplUG9ydHVndWVzZUltYWdlcyxcbiAgICBhbmFseXplUG9ydHVndWVzZVJlYWRpbmdQYXR0ZXJucyxcbiAgICBtZWFzdXJlSW50ZXJhY3Rpb25MYXRlbmN5LFxuICAgIHJlY29yZEludGVyYWN0aW9uQ29tcGxldGUsXG4gICAgZ2V0T3B0aW1hbEF1dG9BZHZhbmNlVGltZSxcbiAgICBnZXRPcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbnMsXG4gICAgaXNPcHRpbWl6ZWQ6IE9iamVjdC52YWx1ZXMobW9iaWxlU2V0dGluZ3MpLnNvbWUoc2V0dGluZyA9PiBzZXR0aW5nID09PSB0cnVlKVxuICB9XG59XG5cbi8vIFBvcnR1Z3Vlc2UgY3VsdHVyYWwgcGVyZm9ybWFuY2UgdXRpbGl0aWVzXG5leHBvcnQgY29uc3QgUG9ydHVndWVzZUNhcm91c2VsUGVyZm9ybWFuY2VVdGlscyA9IHtcbiAgLy8gQ2FsY3VsYXRlIG9wdGltYWwgaW1hZ2Ugc2l6ZXMgZm9yIFBvcnR1Z3Vlc2UgY3VsdHVyYWwgY29udGVudFxuICBnZXRPcHRpbWFsSW1hZ2VTaXplOiAodmlld3BvcnRXaWR0aDogbnVtYmVyLCBpc01vYmlsZTogYm9vbGVhbikgPT4ge1xuICAgIGlmIChpc01vYmlsZSkge1xuICAgICAgcmV0dXJuIHZpZXdwb3J0V2lkdGggPD0gMzc1ID8gMzAwIDogNDAwXG4gICAgfVxuICAgIHJldHVybiB2aWV3cG9ydFdpZHRoIDw9IDc2OCA/IDUwMCA6IDcwMFxuICB9LFxuXG4gIC8vIE9wdGltaXplIFBvcnR1Z3Vlc2UgdGV4dCByZW5kZXJpbmdcbiAgb3B0aW1pemVQb3J0dWd1ZXNlVGV4dFJlbmRlcmluZzogKCkgPT4ge1xuICAgIGNvbnN0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKVxuICAgIHN0eWxlLnRleHRDb250ZW50ID0gYFxuICAgICAgLnBvcnR1Z3Vlc2UtY2Fyb3VzZWwtdGV4dCB7XG4gICAgICAgIGZvbnQtZmVhdHVyZS1zZXR0aW5nczogXCJsaWdhXCIgMSwgXCJrZXJuXCIgMTtcbiAgICAgICAgdGV4dC1yZW5kZXJpbmc6IG9wdGltaXplTGVnaWJpbGl0eTtcbiAgICAgICAgLXdlYmtpdC1mb250LXNtb290aGluZzogYW50aWFsaWFzZWQ7XG4gICAgICAgIC1tb3otb3N4LWZvbnQtc21vb3RoaW5nOiBncmF5c2NhbGU7XG4gICAgICAgIHdvcmQtYnJlYWs6IGJyZWFrLXdvcmQ7XG4gICAgICAgIGh5cGhlbnM6IGF1dG87XG4gICAgICB9XG4gICAgICBcbiAgICAgIC5wb3J0dWd1ZXNlLWNhcm91c2VsLXRleHRbbGFuZz1cInB0XCJdIHtcbiAgICAgICAgbGluZS1oZWlnaHQ6IDEuNjtcbiAgICAgICAgbGV0dGVyLXNwYWNpbmc6IDAuMDI1ZW07XG4gICAgICB9XG4gICAgYFxuICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpXG4gIH0sXG5cbiAgLy8gTWVhc3VyZSBQb3J0dWd1ZXNlIGNvbnRlbnQgcmVhZGFiaWxpdHlcbiAgbWVhc3VyZVBvcnR1Z3Vlc2VSZWFkYWJpbGl0eTogKHRleHQ6IHN0cmluZywgbGFuZ3VhZ2U6IHN0cmluZykgPT4ge1xuICAgIGNvbnN0IHdvcmRzID0gdGV4dC5zcGxpdCgvXFxzKy8pLmxlbmd0aFxuICAgIGNvbnN0IHNlbnRlbmNlcyA9IHRleHQuc3BsaXQoL1suIT9dKy8pLmxlbmd0aFxuICAgIGNvbnN0IGF2Z1dvcmRzUGVyU2VudGVuY2UgPSB3b3JkcyAvIHNlbnRlbmNlc1xuICAgIFxuICAgIC8vIFBvcnR1Z3Vlc2UgdHlwaWNhbGx5IGhhcyBsb25nZXIgc2VudGVuY2VzXG4gICAgY29uc3QgaXNQb3J0dWd1ZXNlT3B0aW1hbCA9IGxhbmd1YWdlID09PSAncHQnID8gXG4gICAgICBhdmdXb3Jkc1BlclNlbnRlbmNlIDw9IDE4IDogLy8gUG9ydHVndWVzZVxuICAgICAgYXZnV29yZHNQZXJTZW50ZW5jZSA8PSAxNSAgIC8vIEVuZ2xpc2hcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgd29yZENvdW50OiB3b3JkcyxcbiAgICAgIHNlbnRlbmNlQ291bnQ6IHNlbnRlbmNlcyxcbiAgICAgIGF2Z1dvcmRzUGVyU2VudGVuY2U6IE1hdGgucm91bmQoYXZnV29yZHNQZXJTZW50ZW5jZSksXG4gICAgICBpc09wdGltYWw6IGlzUG9ydHVndWVzZU9wdGltYWwsXG4gICAgICBlc3RpbWF0ZWRSZWFkaW5nVGltZTogKHdvcmRzIC8gUE9SVFVHVUVTRV9SRUFESU5HX1NQRUVEU1tsYW5ndWFnZSBhcyBrZXlvZiB0eXBlb2YgUE9SVFVHVUVTRV9SRUFESU5HX1NQRUVEU10pICogNjBcbiAgICB9XG4gIH1cbn0iXSwibmFtZXMiOlsiUG9ydHVndWVzZUNhcm91c2VsUGVyZm9ybWFuY2VVdGlscyIsInVzZUNhcm91c2VsUGVyZm9ybWFuY2VPcHRpbWl6YXRpb24iLCJERUZBVUxUX01PQklMRV9TRVRUSU5HUyIsImVuYWJsZUltYWdlTGF6eUxvYWRpbmciLCJlbmFibGVJbnRlcnNlY3Rpb25PYnNlcnZlciIsImVuYWJsZVZpcnR1YWxTY3JvbGxpbmciLCJlbmFibGVQcmVsb2FkT3B0aW1pemF0aW9uIiwiZW5hYmxlQnVuZGxlU3BsaXR0aW5nIiwiZW5hYmxlQ3JpdGljYWxQYXRoT3B0aW1pemF0aW9uIiwiZW5hYmxlUG9ydHVndWVzZUNvbnRlbnRQcmlvcml0aXphdGlvbiIsIlBPUlRVR1VFU0VfUkVBRElOR19TUEVFRFMiLCJvcHRpb25zIiwibGFuZ3VhZ2UiLCJ1c2VMYW5ndWFnZSIsIm1ldHJpY3MiLCJzZXRNZXRyaWNzIiwidXNlU3RhdGUiLCJsb2FkVGltZSIsInJlbmRlclRpbWUiLCJpbnRlcmFjdGlvbkxhdGVuY3kiLCJtZW1vcnlVc2FnZSIsIm5ldHdvcmtTdGF0dXMiLCJmcmFtZVJhdGUiLCJidW5kbGVTaXplIiwiY2FjaGVIaXRSYXRpbyIsIm1vYmlsZVNldHRpbmdzIiwic2V0TW9iaWxlU2V0dGluZ3MiLCJwb3J0dWd1ZXNlUmVhZGluZ1BhdHRlcm5zIiwic2V0UG9ydHVndWVzZVJlYWRpbmdQYXR0ZXJucyIsImF2ZXJhZ2VSZWFkaW5nVGltZSIsInNjcm9sbFZlbG9jaXR5IiwiaW50ZXJhY3Rpb25GcmVxdWVuY3kiLCJjb250ZW50RW5nYWdlbWVudCIsInByZWZlcnJlZEF1dG9BZHZhbmNlU3BlZWQiLCJwZXJmb3JtYW5jZU9ic2VydmVyIiwidXNlUmVmIiwiZnJhbWVSYXRlTW9uaXRvciIsIm1lbW9yeU1vbml0b3IiLCJpbnRlcmFjdGlvblRpbWVyIiwiY2FjaGVBbmFseXRpY3MiLCJNYXAiLCJvcHRpbWl6ZVBvcnR1Z3Vlc2VDb250ZW50VGltaW5nIiwidXNlQ2FsbGJhY2siLCJjb250ZW50TGVuZ3RoIiwid29yZHNQZXJNaW51dGUiLCJlc3RpbWF0ZWRSZWFkaW5nVGltZSIsImN1bHR1cmFsQnVmZmVyIiwiTWF0aCIsIm1heCIsInN0YXJ0UGVyZm9ybWFuY2VNb25pdG9yaW5nIiwiZW5hYmxlUmVhbFRpbWVNb25pdG9yaW5nIiwid2luZG93IiwiY3VycmVudCIsIlBlcmZvcm1hbmNlT2JzZXJ2ZXIiLCJsaXN0IiwiZW50cmllcyIsImdldEVudHJpZXMiLCJmb3JFYWNoIiwiZW50cnkiLCJlbnRyeVR5cGUiLCJwcmV2IiwiZHVyYXRpb24iLCJuYXZFbnRyeSIsImxvYWRFdmVudEVuZCIsImxvYWRFdmVudFN0YXJ0Iiwib2JzZXJ2ZSIsImVudHJ5VHlwZXMiLCJsYXN0VGltZSIsInBlcmZvcm1hbmNlIiwibm93IiwiZnJhbWVDb3VudCIsIm1lYXN1cmVGcmFtZVJhdGUiLCJjdXJyZW50VGltZSIsInJvdW5kIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwic2V0SW50ZXJ2YWwiLCJtZW1vcnkiLCJ1c2VkSlNIZWFwU2l6ZSIsInVwZGF0ZU5ldHdvcmtTdGF0dXMiLCJjb25uZWN0aW9uIiwibmF2aWdhdG9yIiwic3RhdHVzIiwib25MaW5lIiwiZWZmZWN0aXZlVHlwZSIsImluY2x1ZGVzIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJvcHRpbWl6ZUNhcm91c2VsUGVyZm9ybWFuY2UiLCJsZXZlbCIsIm9wdGltaXphdGlvbkxldmVsIiwiZW5hYmxlUG9ydHVndWVzZU9wdGltaXphdGlvbnMiLCJwb3J0dWd1ZXNlT3B0aW1pemF0aW9ucyIsInByZWxvYWREaXN0YW5jZSIsImxhenlMb2FkVGhyZXNob2xkIiwiY2FjaGVTdHJhdGVneSIsImxvZ2dlciIsImluZm8iLCJvcHRpbWl6ZVBvcnR1Z3Vlc2VJbWFnZXMiLCJpbWFnZVVybCIsImlzTW9iaWxlIiwiaW5uZXJXaWR0aCIsImlzU2xvd0Nvbm5lY3Rpb24iLCJvcHRpbWl6ZWRVcmwiLCJyZXBsYWNlIiwiY2FjaGVLZXkiLCJzcGxpdCIsInBvcCIsImNhY2hlSGl0cyIsImdldCIsInNldCIsImFuYWx5emVQb3J0dWd1ZXNlUmVhZGluZ1BhdHRlcm5zIiwiaW50ZXJhY3Rpb25EYXRhIiwiZW5nYWdlbWVudFNjb3JlIiwiaXNQb3J0dWd1ZXNlUmVhZGVyIiwic2xvd1JlYWRlciIsImR3ZWxsVGltZSIsIm1lYXN1cmVJbnRlcmFjdGlvbkxhdGVuY3kiLCJyZWNvcmRJbnRlcmFjdGlvbkNvbXBsZXRlIiwibGF0ZW5jeSIsImFuYWx5emVCdW5kbGVTaXplIiwicmVzb3VyY2VzIiwiZ2V0RW50cmllc0J5VHlwZSIsInRvdGFsU2l6ZSIsInJlc291cmNlIiwibmFtZSIsInRyYW5zZmVyU2l6ZSIsInRvdGFsQ2FjaGVSZXF1ZXN0cyIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsInJlZHVjZSIsImEiLCJiIiwiZmlsdGVyIiwiaGl0cyIsImxlbmd0aCIsImhpdFJhdGlvIiwiZXJyb3IiLCJ3YXJuIiwiZ2V0T3B0aW1hbEF1dG9BZHZhbmNlVGltZSIsImJhc2VUaW1lIiwicmVhZGluZ1BhdHRlcm5BZGp1c3RtZW50IiwiY29ubmVjdGlvbkFkanVzdG1lbnQiLCJnZXRPcHRpbWl6YXRpb25SZWNvbW1lbmRhdGlvbnMiLCJyZWNvbW1lbmRhdGlvbnMiLCJwdXNoIiwidXNlRWZmZWN0IiwiY2xlYW51cCIsImRpc2Nvbm5lY3QiLCJjYW5jZWxBbmltYXRpb25GcmFtZSIsImNsZWFySW50ZXJ2YWwiLCJpc09wdGltaXplZCIsIk9iamVjdCIsInNvbWUiLCJzZXR0aW5nIiwiZ2V0T3B0aW1hbEltYWdlU2l6ZSIsInZpZXdwb3J0V2lkdGgiLCJvcHRpbWl6ZVBvcnR1Z3Vlc2VUZXh0UmVuZGVyaW5nIiwic3R5bGUiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJ0ZXh0Q29udGVudCIsImhlYWQiLCJhcHBlbmRDaGlsZCIsIm1lYXN1cmVQb3J0dWd1ZXNlUmVhZGFiaWxpdHkiLCJ0ZXh0Iiwid29yZHMiLCJzZW50ZW5jZXMiLCJhdmdXb3Jkc1BlclNlbnRlbmNlIiwiaXNQb3J0dWd1ZXNlT3B0aW1hbCIsIndvcmRDb3VudCIsInNlbnRlbmNlQ291bnQiLCJpc09wdGltYWwiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7SUF3WWFBLGtDQUFrQztlQUFsQ0E7O0lBcFZHQyxrQ0FBa0M7ZUFBbENBOzs7dUJBbER5QztpQ0FDN0I7K0RBRVQ7Ozs7OztBQStCbkIsTUFBTUMsMEJBQXNEO0lBQzFEQyx3QkFBd0I7SUFDeEJDLDRCQUE0QjtJQUM1QkMsd0JBQXdCO0lBQ3hCQywyQkFBMkI7SUFDM0JDLHVCQUF1QjtJQUN2QkMsZ0NBQWdDO0lBQ2hDQyx1Q0FBdUM7QUFDekM7QUFFQSxNQUFNQyw0QkFBNEI7SUFDaEMsU0FBUztJQUNULFNBQVM7SUFDVCxTQUFTLElBQUssb0NBQW9DO0FBQ3BEO0FBRU8sU0FBU1QsbUNBQW1DVSxPQUlsRDtJQUNDLE1BQU0sRUFBRUMsUUFBUSxFQUFFLEdBQUdDLElBQUFBLDRCQUFXO0lBQ2hDLE1BQU0sQ0FBQ0MsU0FBU0MsV0FBVyxHQUFHQyxJQUFBQSxlQUFRLEVBQTZCO1FBQ2pFQyxVQUFVO1FBQ1ZDLFlBQVk7UUFDWkMsb0JBQW9CO1FBQ3BCQyxhQUFhO1FBQ2JDLGVBQWU7UUFDZkMsV0FBVztRQUNYQyxZQUFZO1FBQ1pDLGVBQWU7SUFDakI7SUFFQSxNQUFNLENBQUNDLGdCQUFnQkMsa0JBQWtCLEdBQUdWLElBQUFBLGVBQVEsRUFBNkJkO0lBQ2pGLE1BQU0sQ0FBQ3lCLDJCQUEyQkMsNkJBQTZCLEdBQUdaLElBQUFBLGVBQVEsRUFBNEI7UUFDcEdhLG9CQUFvQm5CLHlCQUF5QixDQUFDRSxhQUFhLE9B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