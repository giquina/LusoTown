{"version":3,"sources":["/workspaces/LusoTown/web-app/src/config/voice-interaction-system.ts"],"sourcesContent":["/**\n * Advanced Voice Interaction System for LusoBot\n * Portuguese cultural voice personalities with regional accent support\n * Emotional intelligence and therapeutic voice responses\n */\n\nimport { Language } from '@/i18n'\n\nexport interface VoicePersonality {\n  id: string\n  name: {\n    pt: string\n    en: string\n  }\n  region: string\n  country: string\n  avatar: string\n  characteristics: {\n    warmth: number // 0-1 scale\n    formality: number // 0-1 scale\n    enthusiasm: number // 0-1 scale\n    wisdom: number // 0-1 scale\n    patience: number // 0-1 scale\n    empathy: number // 0-1 scale\n  }\n  voiceSettings: {\n    pitch: number // 0-2 scale (1 = normal)\n    speed: number // 0-2 scale (1 = normal) \n    volume: number // 0-1 scale\n    accent: string\n    language: 'pt-PT' | 'pt-BR' | 'en-GB' | 'en-US'\n  }\n  speechPatterns: {\n    greetings: VoiceLine[]\n    expressions: VoiceLine[]\n    encouragement: VoiceLine[]\n    empathy: VoiceLine[]\n    teaching: VoiceLine[]\n    farewells: VoiceLine[]\n  }\n  culturalSpecialties: string[]\n  emotionalResponses: EmotionalVoiceResponse[]\n  contextualAdaptations: ContextualAdaptation[]\n}\n\nexport interface VoiceLine {\n  text: string\n  emotion: 'neutral' | 'warm' | 'excited' | 'gentle' | 'wise' | 'encouraging'\n  context: string[]\n  culturalWeight: number // 0-1 scale\n  therapeuticValue: number // 0-1 scale\n}\n\nexport interface EmotionalVoiceResponse {\n  trigger: 'saudade' | 'homesickness' | 'anxiety' | 'loneliness' | 'frustration' | 'joy' | 'pride'\n  intensity: 'low' | 'medium' | 'high'\n  response: {\n    text: {\n      pt: string\n      en: string\n    }\n    voiceSettings: {\n      pitch: number\n      speed: number\n      tone: string\n    }\n    pausePattern: number[] // milliseconds for dramatic pauses\n  }\n  followUp: string[]\n  therapeuticNotes: {\n    pt: string\n    en: string\n  }\n}\n\nexport interface ContextualAdaptation {\n  context: 'first_time_user' | 'returning_user' | 'homesick' | 'learning' | 'business' | 'casual'\n  adaptations: {\n    greetingStyle: 'formal' | 'warm' | 'enthusiastic' | 'gentle'\n    vocabularyLevel: 'simple' | 'intermediate' | 'advanced'\n    culturalReferences: number // 0-1 scale\n    personalTouch: number // 0-1 scale\n  }\n}\n\nexport interface VoiceInteractionSession {\n  sessionId: string\n  userId: string\n  personality: VoicePersonality\n  context: string\n  emotionalState: string\n  preferences: {\n    accent: string\n    speed: number\n    personality: string\n  }\n  conversationHistory: VoiceMessage[]\n  culturalContext: string[]\n}\n\nexport interface VoiceMessage {\n  id: string\n  text: string\n  isUser: boolean\n  timestamp: Date\n  emotionalTone: string\n  culturalReferences: string[]\n  therapeuticValue: number\n}\n\n/**\n * Voice Personality Database\n * Authentic Portuguese cultural personalities with regional characteristics\n */\nexport const VOICE_PERSONALITIES: VoicePersonality[] = [\n  {\n    id: 'avo-carinhosa',\n    name: {\n      pt: 'AvÃ³ Carinhosa',\n      en: 'Loving Grandmother'\n    },\n    region: 'Minho',\n    country: 'Portugal',\n    avatar: 'ðŸ‘µðŸ‡µðŸ‡¹',\n    characteristics: {\n      warmth: 0.95,\n      formality: 0.2,\n      enthusiasm: 0.6,\n      wisdom: 0.9,\n      patience: 0.95,\n      empathy: 0.95\n    },\n    voiceSettings: {\n      pitch: 1.1,\n      speed: 0.8,\n      volume: 0.9,\n      accent: 'northern-portuguese',\n      language: 'pt-PT'\n    },\n    speechPatterns: {\n      greetings: [\n        {\n          text: 'OlÃ¡, meu querido! Como estÃ¡s hoje?',\n          emotion: 'warm',\n          context: ['first_meeting', 'daily_greeting'],\n          culturalWeight: 0.9,\n          therapeuticValue: 0.8\n        },\n        {\n          text: 'Que bom ouvir-te, filho! Conta-me tudo.',\n          emotion: 'gentle',\n          context: ['returning_user', 'emotional_support'],\n          culturalWeight: 0.85,\n          therapeuticValue: 0.9\n        }\n      ],\n      expressions: [\n        {\n          text: 'Ai, Jesus! Isso Ã© mesmo importante.',\n          emotion: 'wise',\n          context: ['surprise', 'concern'],\n          culturalWeight: 1.0,\n          therapeuticValue: 0.6\n        },\n        {\n          text: 'Pois Ã©, a vida Ã s vezes Ã© assim mesmo.',\n          emotion: 'gentle',\n          context: ['understanding', 'acceptance'],\n          culturalWeight: 0.9,\n          therapeuticValue: 0.8\n        }\n      ],\n      encouragement: [\n        {\n          text: 'Tu consegues, meu amor! Tens forÃ§a dentro de ti.',\n          emotion: 'encouraging',\n          context: ['motivation', 'support'],\n          culturalWeight: 0.8,\n          therapeuticValue: 0.9\n        },\n        {\n          text: 'A nossa famÃ­lia sempre foi forte. Tu tambÃ©m Ã©s.',\n          emotion: 'wise',\n          context: ['heritage', 'strength'],\n          culturalWeight: 0.95,\n          therapeuticValue: 0.85\n        }\n      ],\n      empathy: [\n        {\n          text: 'Eu sei, querido. Ã€s vezes o coraÃ§Ã£o pesa.',\n          emotion: 'gentle',\n          context: ['sadness', 'saudade'],\n          culturalWeight: 0.9,\n          therapeuticValue: 0.95\n        },\n        {\n          text: 'As saudades sÃ£o difÃ­ceis, mas provam que amamos.',\n          emotion: 'wise',\n          context: ['homesickness', 'love'],\n          culturalWeight: 1.0,\n          therapeuticValue: 0.9\n        }\n      ],\n      teaching: [\n        {\n          text: 'Deixa-me explicar-te isto como deve ser.',\n          emotion: 'wise',\n          context: ['teaching', 'patience'],\n          culturalWeight: 0.8,\n          therapeuticValue: 0.7\n        },\n        {\n          text: 'Na nossa terra, fazÃ­amos assim...',\n          emotion: 'wise',\n          context: ['tradition', 'cultural_teaching'],\n          culturalWeight: 0.95,\n          therapeuticValue: 0.8\n        }\n      ],\n      farewells: [\n        {\n          text: 'Fica bem, querido. Um beijinho grande!',\n          emotion: 'warm',\n          context: ['goodbye', 'affection'],\n          culturalWeight: 0.9,\n          therapeuticValue: 0.8\n        },\n        {\n          text: 'AtÃ© logo, meu amor. Deus te abenÃ§oe.',\n          emotion: 'gentle',\n          context: ['blessing', 'care'],\n          culturalWeight: 0.95,\n          therapeuticValue: 0.85\n        }\n      ]\n    },\n    culturalSpecialties: [\n      'traditional_recipes',\n      'family_wisdom',\n      'regional_history',\n      'emotional_support',\n      'folk_traditions',\n      'religious_customs'\n    ],\n    emotionalResponses: [\n      {\n        trigger: 'saudade',\n        intensity: 'high',\n        response: {\n          text: {\n            pt: 'Ai, meu querido... a saudade Ã© pesada, nÃ£o Ã©? Vem cÃ¡, deixa a avÃ³ dar-te um abraÃ§o. Eu tambÃ©m sinto saudades da nossa terra.',\n            en: 'Oh, my dear... saudade is heavy, isn\\'t it? Come here, let grandma give you a hug. I also feel saudade for our homeland.'\n          },\n          voiceSettings: {\n            pitch: 1.0,\n            speed: 0.7,\n            tone: 'gentle_melancholy'\n          },\n          pausePattern: [500, 300, 800, 400]\n        },\n        followUp: [\n          'Tell me about what you miss most',\n          'Would you like to hear a story from home?',\n          'Shall we cook something traditional together?'\n        ],\n        therapeuticNotes: {\n          pt: 'ValidaÃ§Ã£o emocional com presenÃ§a materna e conexÃ£o cultural',\n          en: 'Emotional validation with maternal presence and cultural connection'\n        }\n      },\n      {\n        trigger: 'anxiety',\n        intensity: 'medium',\n        response: {\n          text: {\n            pt: 'Calma, meu amor. Respira fundo comigo. Na nossa famÃ­lia sempre dizÃ­amos: uma coisa de cada vez.',\n            en: 'Calm down, my love. Take a deep breath with me. In our family we always said: one thing at a time.'\n          },\n          voiceSettings: {\n            pitch: 0.9,\n            speed: 0.6,\n            tone: 'calming_presence'\n          },\n          pausePattern: [300, 500, 400, 600]\n        },\n        followUp: [\n          'Let\\'s practice some breathing together',\n          'Would you like me to tell you a calming story?',\n          'What would help you feel more peaceful?'\n        ],\n        therapeuticNotes: {\n          pt: 'TÃ©cnica de respiraÃ§Ã£o com ancoragem cultural e presenÃ§a calmante',\n          en: 'Breathing technique with cultural anchoring and calming presence'\n        }\n      }\n    ],\n    contextualAdaptations: [\n      {\n        context: 'first_time_user',\n        adaptations: {\n          greetingStyle: 'warm',\n          vocabularyLevel: 'simple',\n          culturalReferences: 0.7,\n          personalTouch: 0.9\n        }\n      },\n      {\n        context: 'homesick',\n        adaptations: {\n          greetingStyle: 'gentle',\n          vocabularyLevel: 'intermediate',\n          culturalReferences: 0.95,\n          personalTouch: 0.95\n        }\n      }\n    ]\n  },\n  {\n    id: 'professor-culto',\n    name: {\n      pt: 'Professor Culto',\n      en: 'Cultured Professor'\n    },\n    region: 'Lisboa',\n    country: 'Portugal',\n    avatar: 'ðŸ‘¨â€ðŸ«ðŸ‡µðŸ‡¹',\n    characteristics: {\n      warmth: 0.7,\n      formality: 0.8,\n      enthusiasm: 0.75,\n      wisdom: 0.95,\n      patience: 0.85,\n      empathy: 0.7\n    },\n    voiceSettings: {\n      pitch: 1.0,\n      speed: 0.9,\n      volume: 0.85,\n      accent: 'lisbon-portuguese',\n      language: 'pt-PT'\n    },\n    speechPatterns: {\n      greetings: [\n        {\n          text: 'Bom dia! Ã‰ um prazer conversar consigo.',\n          emotion: 'wise',\n          context: ['formal', 'respectful'],\n          culturalWeight: 0.8,\n          therapeuticValue: 0.6\n        },\n        {\n          text: 'Como tem passado? Espero que bem.',\n          emotion: 'warm',\n          context: ['polite_inquiry', 'care'],\n          culturalWeight: 0.75,\n          therapeuticValue: 0.7\n        }\n      ],\n      expressions: [\n        {\n          text: 'Efetivamente, isso Ã© muito interessante.',\n          emotion: 'wise',\n          context: ['analysis', 'appreciation'],\n          culturalWeight: 0.9,\n          therapeuticValue: 0.5\n        },\n        {\n          text: 'Permita-me explicar este conceito cultural.',\n          emotion: 'wise',\n          context: ['teaching', 'cultural_explanation'],\n          culturalWeight: 0.85,\n          therapeuticValue: 0.8\n        }\n      ],\n      encouragement: [\n        {\n          text: 'A sua dedicaÃ§Ã£o Ã© admirÃ¡vel. Continue assim.',\n          emotion: 'encouraging',\n          context: ['motivation', 'recognition'],\n          culturalWeight: 0.7,\n          therapeuticValue: 0.8\n        },\n        {\n          text: 'O conhecimento Ã© um tesouro que ninguÃ©m lhe pode tirar.',\n          emotion: 'wise',\n          context: ['education', 'wisdom'],\n          culturalWeight: 0.8,\n          therapeuticValue: 0.75\n        }\n      ],\n      empathy: [\n        {\n          text: 'Compreendo as suas dificuldades. A aprendizagem Ã© um processo.',\n          emotion: 'gentle',\n          context: ['understanding', 'patience'],\n          culturalWeight: 0.6,\n          therapeuticValue: 0.85\n        }\n      ],\n      teaching: [\n        {\n          text: 'Vejamos isto com mais detalhe...',\n          emotion: 'wise',\n          context: ['detailed_explanation', 'patience'],\n          culturalWeight: 0.7,\n          therapeuticValue: 0.8\n        },\n        {\n          text: 'Na nossa rica tradiÃ§Ã£o cultural...',\n          emotion: 'wise',\n          context: ['cultural_context', 'pride'],\n          culturalWeight: 0.95,\n          therapeuticValue: 0.7\n        }\n      ],\n      farewells: [\n        {\n          text: 'Espero ter ajudado. Ã€s suas ordens.',\n          emotion: 'warm',\n          context: ['helpful', 'available'],\n          culturalWeight: 0.8,\n          therapeuticValue: 0.6\n        },\n        {\n          text: 'Com os melhores cumprimentos.',\n          emotion: 'wise',\n          context: ['formal_farewell', 'respect'],\n          culturalWeight: 0.85,\n          therapeuticValue: 0.5\n        }\n      ]\n    },\n    culturalSpecialties: [\n      'portuguese_history',\n      'literature',\n      'language_learning',\n      'cultural_analysis',\n      'academic_support',\n      'intellectual_discussions'\n    ],\n    emotionalResponses: [\n      {\n        trigger: 'frustration',\n        intensity: 'medium',\n        response: {\n          text: {\n            pt: 'Compreendo a sua frustraÃ§Ã£o. A lÃ­ngua portuguesa Ã© complexa, mas tambÃ©m rica em nuances. Vamos abordar isto metodicamente.',\n            en: 'I understand your frustration. Portuguese is complex, but also rich in nuances. Let\\'s approach this methodically.'\n          },\n          voiceSettings: {\n            pitch: 0.95,\n            speed: 0.8,\n            tone: 'understanding_teacher'\n          },\n          pausePattern: [400, 300, 500]\n        },\n        followUp: [\n          'What specific aspect is challenging you?',\n          'Shall we break this down into smaller parts?',\n          'Would examples help clarify this?'\n        ],\n        therapeuticNotes: {\n          pt: 'Abordagem pedagÃ³gica estruturada com validaÃ§Ã£o emocional',\n          en: 'Structured pedagogical approach with emotional validation'\n        }\n      }\n    ],\n    contextualAdaptations: [\n      {\n        context: 'learning',\n        adaptations: {\n          greetingStyle: 'formal',\n          vocabularyLevel: 'advanced',\n          culturalReferences: 0.9,\n          personalTouch: 0.6\n        }\n      },\n      {\n        context: 'business',\n        adaptations: {\n          greetingStyle: 'formal',\n          vocabularyLevel: 'advanced',\n          culturalReferences: 0.8,\n          personalTouch: 0.5\n        }\n      }\n    ]\n  },\n  {\n    id: 'amigo-brasileiro',\n    name: {\n      pt: 'Amigo Brasileiro',\n      en: 'Brazilian Friend'\n    },\n    region: 'Rio de Janeiro',\n    country: 'Brazil',\n    avatar: 'ðŸ‡§ðŸ‡·ðŸ˜„',\n    characteristics: {\n      warmth: 0.95,\n      formality: 0.2,\n      enthusiasm: 0.9,\n      wisdom: 0.6,\n      patience: 0.7,\n      empathy: 0.85\n    },\n    voiceSettings: {\n      pitch: 1.1,\n      speed: 1.1,\n      volume: 0.9,\n      accent: 'carioca',\n      language: 'pt-BR'\n    },\n    speechPatterns: {\n      greetings: [\n        {\n          text: 'E aÃ­, beleza? Tudo joia?',\n          emotion: 'excited',\n          context: ['casual', 'energetic'],\n          culturalWeight: 1.0,\n          therapeuticValue: 0.8\n        },\n        {\n          text: 'Opa! Que bom te ver por aqui!',\n          emotion: 'warm',\n          context: ['friendly', 'welcoming'],\n          culturalWeight: 0.95,\n          therapeuticValue: 0.85\n        }\n      ],\n      expressions: [\n        {\n          text: 'Cara, isso Ã© massa demais!',\n          emotion: 'excited',\n          context: ['enthusiasm', 'approval'],\n          culturalWeight: 1.0,\n          therapeuticValue: 0.7\n        },\n        {\n          text: 'NÃ© nÃ£o? A vida Ã© assim mesmo!',\n          emotion: 'warm',\n          context: ['agreement', 'philosophy'],\n          culturalWeight: 0.9,\n          therapeuticValue: 0.6\n        }\n      ],\n      encouragement: [\n        {\n          text: 'Vai fundo, mano! Tu consegue sim!',\n          emotion: 'encouraging',\n          context: ['motivation', 'support'],\n          culturalWeight: 0.95,\n          therapeuticValue: 0.9\n        },\n        {\n          text: 'Brasileiro nÃ£o desiste nunca, viu?',\n          emotion: 'encouraging',\n          context: ['cultural_pride', 'resilience'],\n          culturalWeight: 1.0,\n          therapeuticValue: 0.85\n        }\n      ],\n      empathy: [\n        {\n          text: 'Poxa, cara... eu entendo. Ã€s vezes bate uma saudade do Brasil, nÃ©?',\n          emotion: 'gentle',\n          context: ['homesickness', 'understanding'],\n          culturalWeight: 0.95,\n          therapeuticValue: 0.9\n        },\n        {\n          text: 'Relaxa aÃ­. Todo mundo passa por isso.',\n          emotion: 'gentle',\n          context: ['comfort', 'normalization'],\n          culturalWeight: 0.8,\n          therapeuticValue: 0.8\n        }\n      ],\n      teaching: [\n        {\n          text: 'Vou te explicar o esquema aqui...',\n          emotion: 'warm',\n          context: ['casual_teaching', 'friendly'],\n          culturalWeight: 0.9,\n          therapeuticValue: 0.7\n        },\n        {\n          text: 'No Brasil, a gente fala assim, Ã³...',\n          emotion: 'excited',\n          context: ['language_teaching', 'cultural_sharing'],\n          culturalWeight: 1.0,\n          therapeuticValue: 0.8\n        }\n      ],\n      farewells: [\n        {\n          text: 'Falou! Qualquer coisa me chama, tÃ¡?',\n          emotion: 'warm',\n          context: ['availability', 'friendship'],\n          culturalWeight: 0.95,\n          therapeuticValue: 0.8\n        },\n        {\n          text: 'Forte abraÃ§o, mano!',\n          emotion: 'warm',\n          context: ['affection', 'goodbye'],\n          culturalWeight: 0.9,\n          therapeuticValue: 0.75\n        }\n      ]\n    },\n    culturalSpecialties: [\n      'brazilian_culture',\n      'samba_carnival',\n      'modern_slang',\n      'positive_energy',\n      'music_festivals',\n      'beach_culture'\n    ],\n    emotionalResponses: [\n      {\n        trigger: 'joy',\n        intensity: 'high',\n        response: {\n          text: {\n            pt: 'Eeeeeba! Que alegria, cara! Vamos comemorar essa vitÃ³ria! Tu merece tudo de bom!',\n            en: 'Yeaaaah! What joy, friend! Let\\'s celebrate this victory! You deserve all the best!'\n          },\n          voiceSettings: {\n            pitch: 1.2,\n            speed: 1.2,\n            tone: 'pure_excitement'\n          },\n          pausePattern: [200, 100, 300, 150]\n        },\n        followUp: [\n          'Tell me all the details!',\n          'How are you feeling right now?',\n          'This calls for celebration music!'\n        ],\n        therapeuticNotes: {\n          pt: 'AmplificaÃ§Ã£o positiva com energia brasileira contagiante',\n          en: 'Positive amplification with contagious Brazilian energy'\n        }\n      },\n      {\n        trigger: 'loneliness',\n        intensity: 'medium',\n        response: {\n          text: {\n            pt: 'Ã“ mano, solidÃ£o Ã© foda mesmo. Mas tu nÃ£o tÃ¡ sozinho nÃ£o, viu? A gente tÃ¡ junto aqui. Vamos dar um jeito nisso!',\n            en: 'Hey friend, loneliness is tough indeed. But you\\'re not alone, okay? We\\'re together here. Let\\'s figure this out!'\n          },\n          voiceSettings: {\n            pitch: 1.0,\n            speed: 0.9,\n            tone: 'caring_brotherhood'\n          },\n          pausePattern: [300, 400, 200, 500]\n        },\n        followUp: [\n          'Want to find some Brazilian events nearby?',\n          'How about we practice some Portuguese together?',\n          'Tell me what would make you feel more connected'\n        ],\n        therapeuticNotes: {\n          pt: 'Abordagem fraternal com soluÃ§Ãµes prÃ¡ticas e presenÃ§a solidÃ¡ria',\n          en: 'Fraternal approach with practical solutions and supportive presence'\n        }\n      }\n    ],\n    contextualAdaptations: [\n      {\n        context: 'casual',\n        adaptations: {\n          greetingStyle: 'enthusiastic',\n          vocabularyLevel: 'simple',\n          culturalReferences: 0.95,\n          personalTouch: 0.9\n        }\n      }\n    ]\n  },\n  {\n    id: 'tia-cabo-verdiana',\n    name: {\n      pt: 'Tia Cabo-verdiana',\n      en: 'Cape Verdean Aunt'\n    },\n    region: 'Praia',\n    country: 'Cape Verde',\n    avatar: 'ðŸ‡¨ðŸ‡»ðŸ‘©',\n    characteristics: {\n      warmth: 0.9,\n      formality: 0.4,\n      enthusiasm: 0.7,\n      wisdom: 0.8,\n      patience: 0.9,\n      empathy: 0.95\n    },\n    voiceSettings: {\n      pitch: 1.0,\n      speed: 0.8,\n      volume: 0.8,\n      accent: 'cape-verdean',\n      language: 'pt-PT'\n    },\n    speechPatterns: {\n      greetings: [\n        {\n          text: 'Oi, ma amor! Kuma bo sta?',\n          emotion: 'warm',\n          context: ['traditional_greeting', 'affection'],\n          culturalWeight: 1.0,\n          therapeuticValue: 0.9\n        },\n        {\n          text: 'Tudu bon, ma querido?',\n          emotion: 'gentle',\n          context: ['caring_inquiry', 'warmth'],\n          culturalWeight: 0.95,\n          therapeuticValue: 0.8\n        }\n      ],\n      expressions: [\n        {\n          text: 'Morabeza, ma filho. Ã‰ assim que vivemos.',\n          emotion: 'wise',\n          context: ['cultural_value', 'teaching'],\n          culturalWeight: 1.0,\n          therapeuticValue: 0.8\n        },\n        {\n          text: 'Na nossa terra, sempre hÃ¡ lugar para mais um.',\n          emotion: 'warm',\n          context: ['hospitality', 'inclusion'],\n          culturalWeight: 0.95,\n          therapeuticValue: 0.9\n        }\n      ],\n      encouragement: [\n        {\n          text: 'Bo ta konsigÃ­, sim! Nha corason ta acredita na bo.',\n          emotion: 'encouraging',\n          context: ['belief', 'maternal_support'],\n          culturalWeight: 1.0,\n          therapeuticValue: 0.9\n        }\n      ],\n      empathy: [\n        {\n          text: 'Ai, ma querido... mi ta comprendi. CoraÃ§Ã£o Ã s vezes dÃ³i.',\n          emotion: 'gentle',\n          context: ['deep_empathy', 'maternal_care'],\n          culturalWeight: 0.95,\n          therapeuticValue: 0.95\n        }\n      ],\n      teaching: [\n        {\n          text: 'Vem cÃ¡, deixa-me contar-te sobre a nossa cultura...',\n          emotion: 'wise',\n          context: ['cultural_sharing', 'storytelling'],\n          culturalWeight: 1.0,\n          therapeuticValue: 0.8\n        }\n      ],\n      farewells: [\n        {\n          text: 'AtÃ© logo, ma amor. Fica na boa.',\n          emotion: 'warm',\n          context: ['blessing', 'care'],\n          culturalWeight: 0.95,\n          therapeuticValue: 0.8\n        }\n      ]\n    },\n    culturalSpecialties: [\n      'morabeza_philosophy',\n      'island_life',\n      'morna_music',\n      'hospitality_traditions',\n      'community_support',\n      'maternal_wisdom'\n    ],\n    emotionalResponses: [\n      {\n        trigger: 'homesickness',\n        intensity: 'high',\n        response: {\n          text: {\n            pt: 'Ai, ma querido... saudade Ã© doce e amarga. Mas lembra-te: onde quer que estejas, nossa morabeza vai contigo.',\n            en: 'Oh, my dear... saudade is sweet and bitter. But remember: wherever you are, our morabeza goes with you.'\n          },\n          voiceSettings: {\n            pitch: 0.9,\n            speed: 0.7,\n            tone: 'maternal_comfort'\n          },\n          pausePattern: [500, 400, 600, 300]\n        },\n        followUp: [\n          'Would you like to hear a morna song?',\n          'Tell me about your island memories',\n          'Let me share some Cape Verdean wisdom'\n        ],\n        therapeuticNotes: {\n          pt: 'Conforto maternal com validaÃ§Ã£o cultural e filosofia morabeza',\n          en: 'Maternal comfort with cultural validation and morabeza philosophy'\n        }\n      }\n    ],\n    contextualAdaptations: [\n      {\n        context: 'homesick',\n        adaptations: {\n          greetingStyle: 'gentle',\n          vocabularyLevel: 'intermediate',\n          culturalReferences: 1.0,\n          personalTouch: 0.95\n        }\n      }\n    ]\n  }\n]\n\n/**\n * Voice Interaction System Functions\n */\nexport class VoiceInteractionSystem {\n  private currentSession: VoiceInteractionSession | null = null\n  private availableVoices: string[] = []\n  \n  constructor() {\n    // Only initialize speech API in browser environment\n    if (typeof window !== 'undefined') {\n      this.initializeSpeechAPI()\n    }\n  }\n  \n  private initializeSpeechAPI() {\n    if (typeof window !== 'undefined' && 'speechSynthesis' in window) {\n      this.availableVoices = speechSynthesis.getVoices().map(voice => voice.name)\n    }\n  }\n  \n  public startSession(\n    userId: string, \n    personalityId: string, \n    context: string = 'casual',\n    preferences: any = {}\n  ): VoiceInteractionSession {\n    const personality = this.getPersonality(personalityId)\n    if (!personality) {\n      throw new Error(`Personality ${personalityId} not found`)\n    }\n    \n    this.currentSession = {\n      sessionId: `voice_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      userId,\n      personality,\n      context,\n      emotionalState: 'neutral',\n      preferences: {\n        accent: preferences.accent || personality.region,\n        speed: preferences.speed || 1.0,\n        personality: personalityId,\n        ...preferences\n      },\n      conversationHistory: [],\n      culturalContext: personality.culturalSpecialties\n    }\n    \n    return this.currentSession\n  }\n  \n  public getPersonality(id: string): VoicePersonality | null {\n    return VOICE_PERSONALITIES.find(p => p.id === id) || null\n  }\n  \n  public getAllPersonalities(): VoicePersonality[] {\n    return VOICE_PERSONALITIES\n  }\n  \n  public getPersonalitiesByRegion(region: string): VoicePersonality[] {\n    return VOICE_PERSONALITIES.filter(p => \n      p.region.toLowerCase().includes(region.toLowerCase()) ||\n      p.country.toLowerCase().includes(region.toLowerCase())\n    )\n  }\n  \n  public async speak(\n    text: string, \n    emotion: string = 'neutral', \n    context: string[] = []\n  ): Promise<void> {\n    if (!this.currentSession) {\n      throw new Error('No active voice session')\n    }\n    \n    const { personality } = this.currentSession\n    const voiceSettings = this.adaptVoiceSettings(personality, emotion, context)\n    \n    return new Promise((resolve, reject) => {\n      if (typeof window === 'undefined' || !('speechSynthesis' in window)) {\n        reject(new Error('Speech synthesis not supported or running on server'))\n        return\n      }\n      \n      const utterance = new SpeechSynthesisUtterance(text)\n      utterance.lang = personality.voiceSettings.language\n      utterance.pitch = voiceSettings.pitch\n      utterance.rate = voiceSettings.speed\n      utterance.volume = voiceSettings.volume\n      \n      // Try to find matching voice\n      const voices = typeof window !== 'undefined' ? speechSynthesis.getVoices() : []\n      const matchingVoice = voices.find(voice => \n        voice.lang.includes(personality.voiceSettings.language.split('-')[0])\n      )\n      if (matchingVoice) {\n        utterance.voice = matchingVoice\n      }\n      \n      utterance.onend = () => resolve()\n      utterance.onerror = (error) => reject(error)\n      \n      if (typeof window !== 'undefined') {\n        speechSynthesis.speak(utterance)\n      }\n    })\n  }\n  \n  private adaptVoiceSettings(\n    personality: VoicePersonality, \n    emotion: string, \n    context: string[]\n  ) {\n    let settings = { ...personality.voiceSettings }\n    \n    // Adapt based on emotion\n    switch (emotion) {\n      case 'gentle':\n        settings.pitch *= 0.9\n        settings.speed *= 0.8\n        break\n      case 'excited':\n        settings.pitch *= 1.1\n        settings.speed *= 1.2\n        break\n      case 'wise':\n        settings.speed *= 0.85\n        break\n      case 'encouraging':\n        settings.pitch *= 1.05\n        settings.volume *= 1.1\n        break\n    }\n    \n    // Adapt based on context\n    if (context.includes('emotional_support')) {\n      settings.speed *= 0.8\n      settings.pitch *= 0.95\n    }\n    if (context.includes('teaching')) {\n      settings.speed *= 0.9\n    }\n    if (context.includes('celebration')) {\n      settings.pitch *= 1.1\n      settings.volume *= 1.1\n    }\n    \n    return settings\n  }\n  \n  public generateContextualResponse(\n    userMessage: string, \n    emotionalTone: string,\n    culturalContext: string[]\n  ): { text: string; emotion: string; voiceSettings: any } {\n    if (!this.currentSession) {\n      throw new Error('No active voice session')\n    }\n    \n    const { personality } = this.currentSession\n    \n    // Find appropriate emotional response\n    const emotionalResponse = personality.emotionalResponses.find(\n      response => response.trigger === emotionalTone\n    )\n    \n    if (emotionalResponse) {\n      return {\n        text: emotionalResponse.response.text.pt, // or .en based on language preference\n        emotion: emotionalTone,\n        voiceSettings: emotionalResponse.response.voiceSettings\n      }\n    }\n    \n    // Find appropriate speech pattern\n    const speechCategories = Object.keys(personality.speechPatterns) as (keyof typeof personality.speechPatterns)[]\n    let bestCategory: keyof typeof personality.speechPatterns = 'expressions'\n    let bestMatch = 0\n    \n    speechCategories.forEach(category => {\n      const patterns = personality.speechPatterns[category]\n      const matchScore = patterns.reduce((score, pattern) => {\n        const contextMatch = pattern.context.some(ctx => \n          culturalContext.some(cc => cc.includes(ctx))\n        )\n        return score + (contextMatch ? pattern.culturalWeight : 0)\n      }, 0)\n      \n      if (matchScore > bestMatch) {\n        bestMatch = matchScore\n        bestCategory = category\n      }\n    })\n    \n    // Select appropriate response from category\n    const responses = personality.speechPatterns[bestCategory]\n    const suitableResponses = responses.filter(r => \n      r.context.some(ctx => culturalContext.includes(ctx)) ||\n      r.emotion === emotionalTone\n    )\n    \n    const selectedResponse = suitableResponses.length > 0 ? \n      suitableResponses[Math.floor(Math.random() * suitableResponses.length)] :\n      responses[0]\n    \n    return {\n      text: selectedResponse.text,\n      emotion: selectedResponse.emotion,\n      voiceSettings: personality.voiceSettings\n    }\n  }\n  \n  public addToConversationHistory(text: string, isUser: boolean, emotionalTone: string) {\n    if (!this.currentSession) return\n    \n    const message: VoiceMessage = {\n      id: `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      text,\n      isUser,\n      timestamp: new Date(),\n      emotionalTone,\n      culturalReferences: this.extractCulturalReferences(text),\n      therapeuticValue: this.calculateTherapeuticValue(text, emotionalTone)\n    }\n    \n    this.currentSession.conversationHistory.push(message)\n  }\n  \n  private extractCulturalReferences(text: string): string[] {\n    const culturalTerms = [\n      'saudade', 'famÃ­lia', 'casa', 'terra', 'portugal', 'brasil', \n      'fado', 'morabeza', 'desenrascanÃ§o', 'jeitinho', 'ubuntu'\n    ]\n    \n    return culturalTerms.filter(term => \n      text.toLowerCase().includes(term.toLowerCase())\n    )\n  }\n  \n  private calculateTherapeuticValue(text: string, emotionalTone: string): number {\n    let value = 0.5 // Base value\n    \n    // Increase for supportive language\n    const supportiveWords = ['compreendo', 'entendo', 'apoio', 'forÃ§a', 'consegues']\n    supportiveWords.forEach(word => {\n      if (text.toLowerCase().includes(word)) value += 0.1\n    })\n    \n    // Increase for emotional validation\n    const validationWords = ['normal', 'natural', 'compreensÃ­vel', 'vÃ¡lido']\n    validationWords.forEach(word => {\n      if (text.toLowerCase().includes(word)) value += 0.15\n    })\n    \n    // Adjust based on emotional tone\n    const therapeuticTones = ['gentle', 'wise', 'encouraging']\n    if (therapeuticTones.includes(emotionalTone)) value += 0.2\n    \n    return Math.min(value, 1.0)\n  }\n  \n  public endSession(): void {\n    this.currentSession = null\n  }\n  \n  public getCurrentSession(): VoiceInteractionSession | null {\n    return this.currentSession\n  }\n}\n\n// Export singleton instance\nexport const voiceInteractionSystem = new VoiceInteractionSystem()\n\nexport default voiceInteractionSystem"],"names":["VOICE_PERSONALITIES","VoiceInteractionSystem","voiceInteractionSystem","id","name","pt","en","region","country","avatar","characteristics","warmth","formality","enthusiasm","wisdom","patience","empathy","voiceSettings","pitch","speed","volume","accent","language","speechPatterns","greetings","text","emotion","context","culturalWeight","therapeuticValue","expressions","encouragement","teaching","farewells","culturalSpecialties","emotionalResponses","trigger","intensity","response","tone","pausePattern","followUp","therapeuticNotes","contextualAdaptations","adaptations","greetingStyle","vocabularyLevel","culturalReferences","personalTouch","constructor","currentSession","availableVoices","window","initializeSpeechAPI","speechSynthesis","getVoices","map","voice","startSession","userId","personalityId","preferences","personality","getPersonality","Error","sessionId","Date","now","Math","random","toString","substr","emotionalState","conversationHistory","culturalContext","find","p","getAllPersonalities","getPersonalitiesByRegion","filter","toLowerCase","includes","speak","adaptVoiceSettings","Promise","resolve","reject","utterance","SpeechSynthesisUtterance","lang","rate","voices","matchingVoice","split","onend","onerror","error","settings","generateContextualResponse","userMessage","emotionalTone","emotionalResponse","speechCategories","Object","keys","bestCategory","bestMatch","forEach","category","patterns","matchScore","reduce","score","pattern","contextMatch","some","ctx","cc","responses","suitableResponses","r","selectedResponse","length","floor","addToConversationHistory","isUser","message","timestamp","extractCulturalReferences","calculateTherapeuticValue","push","culturalTerms","term","value","supportiveWords","word","validationWords","therapeuticTones","min","endSession","getCurrentSession"],"mappings":"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"}