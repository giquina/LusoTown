{"version":3,"sources":["/workspaces/LusoTown/web-app/src/lib/search.ts"],"sourcesContent":["'use client'\n\nimport { Event, eventService } from '@/lib/events'\nimport { ROUTES } from '@/config/routes'\nimport { IMAGES } from '@/config/cdn'\n\nexport interface SearchResult {\n  id: string\n  type: 'event' | 'business' | 'group' | 'page' | 'service'\n  title: string\n  description: string\n  url: string\n  location?: string\n  date?: string\n  category?: string\n  tags?: string[]\n  image?: string\n  price?: number\n  rating?: number\n}\n\n// Mock business data for search\nconst mockBusinesses = [\n  {\n    id: 'business-1',\n    name: 'Nata Lisboa',\n    description: 'Authentic Lusophone pastéis de nata bakery in Borough Market',\n    category: 'Food & Drink',\n    location: 'Borough Market, London',\n    url: '/business-directory/nata-lisboa',\n    image: '/images/businesses/nata-lisboa.jpg',\n    rating: 4.8,\n    tags: ['pastéis de nata', 'portuguese bakery', 'borough market', 'desserts', 'coffee']\n  },\n  {\n    id: 'business-2',\n    name: 'Casa do Fado',\n    description: 'Traditional Portuguese restaurant with live Fado performances',\n    category: 'Restaurant',\n    location: 'Vauxhall, London',\n    url: '/business-directory/casa-do-fado',\n    image: '/images/businesses/casa-do-fado.jpg',\n    rating: 4.6,\n    tags: ['fado', 'portuguese restaurant', 'live music', 'traditional', 'dinner']\n  },\n  {\n    id: 'business-3',\n    name: 'Lusophone Language Academy',\n    description: 'Professional Portuguese language courses for all levels',\n    category: 'Education',\n    location: 'Camden, London',\n    url: '/business-directory/portuguese-language-academy',\n    image: '/images/businesses/language-academy.jpg',\n    rating: 4.9,\n    tags: ['portuguese lessons', 'language learning', 'education', 'classes', 'tutoring']\n  },\n  {\n    id: 'business-4',\n    name: 'Lusitânia Market',\n    description: 'Specialized Lusophone grocery store and delicatessen',\n    category: 'Grocery',\n    location: 'Stockwell, London',\n    url: '/business-directory/lusitania-market',\n    image: '/images/businesses/lusitania-market.jpg',\n    rating: 4.7,\n    tags: ['portuguese food', 'grocery', 'delicatessen', 'imported goods', 'stockwell']\n  }\n]\n\n// Mock groups data\nconst mockGroups = [\n  {\n    id: 'group-1',\n    name: 'Lusophone Professionals Network',\n    description: 'Networking group for Portuguese-speaking professionals in London',\n    category: 'Professional',\n    location: 'London',\n    url: '/groups/portuguese-professionals-network',\n    image: '/images/groups/professionals.jpg',\n    memberCount: 245,\n    tags: ['networking', 'professionals', 'career', 'business', 'london']\n  },\n  {\n    id: 'group-2',\n    name: 'Young Lusophone in London',\n    description: 'Social group for Portuguese speakers aged 18-35 living in London',\n    category: 'Social',\n    location: 'London',\n    url: '/groups/young-portuguese-london',\n    image: '/images/groups/young-portuguese.jpg',\n    memberCount: 182,\n    tags: ['young adults', 'social', 'friends', '18-35', 'activities']\n  },\n  {\n    id: 'group-3',\n    name: 'Lusophone Football Fans',\n    description: 'Watch Portuguese national team matches and Premier League games together',\n    category: 'Sports',\n    location: 'Various Pubs',\n    url: '/groups/portuguese-football-fans',\n    image: '/images/groups/football.jpg',\n    memberCount: 156,\n    tags: ['football', 'sports', 'national team', 'premier league', 'pubs']\n  }\n]\n\n// Premium services data for search\nconst premiumServices = [\n  {\n    id: 'service-executive-transport',\n    name: 'Executive Transport Services',\n    description: 'Professional transport services with Lusophone cultural expertise',\n    category: 'Transportation',\n    location: 'London & United Kingdom',\n    url: '/services#executive-transport',\n    image: IMAGES.transport.executive,\n    price: 35,\n    rating: 4.8,\n    tags: ['executive transport', 'professional driver', 'premium vehicles', 'airport transfer', 'business transport']\n  },\n  {\n    id: 'service-close-protection',\n    name: 'Close Protection Services',\n    description: 'SIA-licensed CPOs providing discrete, culturally-aware security',\n    category: 'Security',\n    location: 'London & United Kingdom',\n    url: '/services#close-protection',\n    image: IMAGES.transport.closeProtection,\n    price: 800,\n    rating: 5.0,\n    tags: ['close protection', 'security', 'sia licensed', 'vip escort', 'personal protection']\n  },\n  {\n    id: 'service-transport-sia',\n    name: 'Transport & SIA Compliance',\n    description: 'Comprehensive transport services with full SIA compliance and luxury fleet',\n    category: 'Premium Transport',\n    location: 'London & United Kingdom',\n    url: '/transport',\n    image: IMAGES.transport.security,\n    price: 75,\n    rating: 4.9,\n    tags: ['transport', 'sia compliance', 'luxury fleet', 'security transport', 'bentley', 'mercedes']\n  }\n]\n\n// Mock pages/content data\nconst mockPages = [\n  {\n    id: 'events-page',\n    title: 'Events & Tours',\n    description: 'Discover Lusophone cultural events, tours, and activities in London',\n  url: ROUTES.events,\n    category: 'Navigation',\n    tags: ['events', 'tours', 'activities', 'culture', 'social calendar']\n  },\n  {\n    id: 'business-directory',\n    title: 'Lusophone Business Directory',\n    description: 'Find Lusophone-owned businesses and services in London',\n    url: '/business-directory',\n    category: 'Directory',\n    tags: ['businesses', 'services', 'directory', 'portuguese owned', 'support local']\n  },\n  {\n    id: 'community-guidelines',\n    title: 'Community Guidelines',\n    description: 'Learn about our community standards and membership guidelines',\n    url: '/community-guidelines',\n    category: 'Support',\n    tags: ['guidelines', 'rules', 'community standards', 'membership', 'safety']\n  },\n  {\n    id: 'help',\n    title: 'Help & Support',\n    description: 'Get help with your LusoTown account and find answers to common questions',\n    url: '/help',\n    category: 'Support',\n    tags: ['help', 'support', 'faq', 'account', 'assistance']\n  },\n  {\n    id: 'pricing',\n    title: 'Membership Pricing',\n    description: 'Explore our membership plans and find the perfect fit for your Lusophone social calendar',\n    url: '/pricing',\n    category: 'Membership',\n    tags: ['pricing', 'membership', 'plans', 'subscription', 'premium']\n  },\n  {\n    id: 'safety',\n    title: 'Safety Center',\n    description: 'Learn about our safety measures and how to stay safe in the Portuguese-speaking community',\n    url: '/safety',\n    category: 'Safety',\n    tags: ['safety', 'security', 'protection', 'community safety', 'guidelines']\n  }\n]\n\n// Text similarity function for search ranking\nfunction calculateSimilarity(searchTerm: string, text: string): number {\n  const search = searchTerm.toLowerCase()\n  const target = text.toLowerCase()\n  \n  // Exact match gets highest score\n  if (target.includes(search)) {\n    const index = target.indexOf(search)\n    // Bonus for matches at the beginning\n    const positionBonus = index === 0 ? 0.5 : 0\n    // Bonus for whole word matches\n    const wordBonus = target.split(' ').some(word => word.includes(search)) ? 0.3 : 0\n    return 1 + positionBonus + wordBonus\n  }\n  \n  // Partial word matches\n  const searchWords = search.split(' ')\n  const targetWords = target.split(' ')\n  let matchScore = 0\n  \n  for (const searchWord of searchWords) {\n    for (const targetWord of targetWords) {\n      if (targetWord.includes(searchWord) || searchWord.includes(targetWord)) {\n        matchScore += 0.3\n      }\n    }\n  }\n  \n  return matchScore\n}\n\n// Search through events\nexport async function searchEvents(query: string): Promise<SearchResult[]> {\n  try {\n    const events = await eventService.getEvents()\n    const searchTerm = query.toLowerCase().trim()\n    \n    if (!searchTerm) return []\n    \n    const results: Array<SearchResult & { score: number }> = []\n    \n    for (const event of events) {\n      let score = 0\n      \n      // Search in title\n      score += calculateSimilarity(searchTerm, event.title) * 3\n      \n      // Search in description\n      score += calculateSimilarity(searchTerm, event.description) * 2\n      score += calculateSimilarity(searchTerm, event.longDescription) * 1.5\n      \n      // Search in location\n      if (event.location) {\n        score += calculateSimilarity(searchTerm, event.location) * 2\n      }\n      \n      // Search in category\n      score += calculateSimilarity(searchTerm, event.category) * 1.5\n      \n      // Search in tags\n      for (const tag of event.tags || []) {\n        score += calculateSimilarity(searchTerm, tag) * 1\n      }\n      \n      // Search in host name\n      if (event.hostName) {\n        score += calculateSimilarity(searchTerm, event.hostName) * 1\n      }\n      \n      if (score > 0.5) {\n        results.push({\n          id: event.id,\n          type: 'event',\n          title: event.title,\n          description: event.description,\n          url: `/events/${event.id}`,\n          location: event.location,\n          date: event.date,\n          category: event.category,\n          tags: event.tags,\n          image: event.images?.[0],\n          price: event.price,\n          score\n        })\n      }\n    }\n    \n    // Sort by relevance score and return top results\n    return results\n      .sort((a, b) => b.score - a.score)\n      .slice(0, 10)\n      .map(({ score, ...result }) => result)\n      \n  } catch (error) {\n    console.error('Error searching events:', error)\n    return []\n  }\n}\n\n// Search through businesses, groups, and pages\nexport async function searchContent(query: string): Promise<SearchResult[]> {\n  const searchTerm = query.toLowerCase().trim()\n  \n  if (!searchTerm) return []\n  \n  const results: Array<SearchResult & { score: number }> = []\n  \n  // Search businesses\n  for (const business of mockBusinesses) {\n    let score = 0\n    \n    score += calculateSimilarity(searchTerm, business.name) * 3\n    score += calculateSimilarity(searchTerm, business.description) * 2\n    score += calculateSimilarity(searchTerm, business.category) * 1.5\n    score += calculateSimilarity(searchTerm, business.location) * 2\n    \n    for (const tag of business.tags) {\n      score += calculateSimilarity(searchTerm, tag) * 1\n    }\n    \n    if (score > 0.5) {\n      results.push({\n        id: business.id,\n        type: 'business',\n        title: business.name,\n        description: business.description,\n        url: business.url,\n        location: business.location,\n        category: business.category,\n        tags: business.tags,\n        image: business.image,\n        rating: business.rating,\n        score\n      })\n    }\n  }\n  \n  // Search groups\n  for (const group of mockGroups) {\n    let score = 0\n    \n    score += calculateSimilarity(searchTerm, group.name) * 3\n    score += calculateSimilarity(searchTerm, group.description) * 2\n    score += calculateSimilarity(searchTerm, group.category) * 1.5\n    score += calculateSimilarity(searchTerm, group.location) * 1\n    \n    for (const tag of group.tags) {\n      score += calculateSimilarity(searchTerm, tag) * 1\n    }\n    \n    if (score > 0.5) {\n      results.push({\n        id: group.id,\n        type: 'group',\n        title: group.name,\n        description: group.description,\n        url: group.url,\n        location: group.location,\n        category: group.category,\n        tags: group.tags,\n        image: group.image,\n        score\n      })\n    }\n  }\n  \n  // Search premium services\n  for (const service of premiumServices) {\n    let score = 0\n    \n    score += calculateSimilarity(searchTerm, service.name) * 3\n    score += calculateSimilarity(searchTerm, service.description) * 2\n    score += calculateSimilarity(searchTerm, service.category) * 1.5\n    score += calculateSimilarity(searchTerm, service.location) * 1\n    \n    for (const tag of service.tags) {\n      score += calculateSimilarity(searchTerm, tag) * 1\n    }\n    \n    if (score > 0.5) {\n      results.push({\n        id: service.id,\n        type: 'service',\n        title: service.name,\n        description: service.description,\n        url: service.url,\n        location: service.location,\n        category: service.category,\n        tags: service.tags,\n        image: service.image,\n        price: service.price,\n        rating: service.rating,\n        score\n      })\n    }\n  }\n\n  // Search pages\n  for (const page of mockPages) {\n    let score = 0\n    \n    score += calculateSimilarity(searchTerm, page.title) * 3\n    score += calculateSimilarity(searchTerm, page.description) * 2\n    score += calculateSimilarity(searchTerm, page.category) * 1.5\n    \n    for (const tag of page.tags) {\n      score += calculateSimilarity(searchTerm, tag) * 1\n    }\n    \n    if (score > 0.5) {\n      results.push({\n        id: page.id,\n        type: 'page',\n        title: page.title,\n        description: page.description,\n        url: page.url,\n        category: page.category,\n        tags: page.tags,\n        score\n      })\n    }\n  }\n  \n  // Sort by relevance score and return top results\n  return results\n    .sort((a, b) => b.score - a.score)\n    .slice(0, 15)\n    .map(({ score, ...result }) => result)\n}\n\n// Combined search function\nexport async function search(query: string): Promise<{\n  events: SearchResult[]\n  businesses: SearchResult[]\n  groups: SearchResult[]\n  pages: SearchResult[]\n  all: SearchResult[]\n}> {\n  const [eventResults, contentResults] = await Promise.all([\n    searchEvents(query),\n    searchContent(query)\n  ])\n  \n  const businesses = contentResults.filter(r => r.type === 'business')\n  const groups = contentResults.filter(r => r.type === 'group')\n  const pages = contentResults.filter(r => r.type === 'page')\n  \n  const all = [...eventResults, ...contentResults]\n    .sort((a, b) => {\n      // Priority order: events, businesses, groups, pages\n      const typeOrder = { event: 0, business: 1, group: 2, page: 3 }\n      const aOrder = typeOrder[a.type as keyof typeof typeOrder] || 4\n      const bOrder = typeOrder[b.type as keyof typeof typeOrder] || 4\n      \n      if (aOrder !== bOrder) {\n        return aOrder - bOrder\n      }\n      \n      // Within same type, sort by relevance (already sorted in individual searches)\n      return 0\n    })\n  \n  return {\n    events: eventResults,\n    businesses,\n    groups,\n    pages,\n    all\n  }\n}\n\n// Popular search suggestions\nexport function getPopularSearches(language: 'en' | 'pt' = 'en'): string[] {\n  if (language === 'pt') {\n    return [\n      'eventos portugueses',\n      'restaurantes portugueses',\n      'fado',\n      'pastel de nata',\n      'futebol',\n      'networking',\n      'jovens portugueses',\n      'negócios portugueses',\n      'cultura portuguesa',\n      'língua portuguesa'\n    ]\n  }\n  \n  return [\n    'portuguese events',\n    'fado music',\n    'portuguese restaurants',\n    'networking',\n    'young portuguese',\n    'football',\n    'pastéis de nata',\n    'portuguese businesses',\n    'cultural events',\n    'language exchange'\n  ]\n}\n\n// Search categories for filtering\nexport function getSearchCategories(language: 'en' | 'pt' = 'en'): Array<{\n  id: string\n  label: string\n  type: SearchResult['type'][]\n}> {\n  if (language === 'pt') {\n    return [\n      { id: 'all', label: 'Todos', type: ['event', 'business', 'group', 'page'] },\n      { id: 'events', label: 'Eventos', type: ['event'] },\n      { id: 'businesses', label: 'Negócios', type: ['business'] },\n      { id: 'groups', label: 'Grupos', type: ['group'] },\n      { id: 'pages', label: 'Páginas', type: ['page'] }\n    ]\n  }\n  \n  return [\n    { id: 'all', label: 'All', type: ['event', 'business', 'group', 'page'] },\n    { id: 'events', label: 'Events', type: ['event'] },\n    { id: 'businesses', label: 'Businesses', type: ['business'] },\n    { id: 'groups', label: 'Groups', type: ['group'] },\n    { id: 'pages', label: 'Pages', type: ['page'] }\n  ]\n}"],"names":["getPopularSearches","getSearchCategories","search","searchContent","searchEvents","mockBusinesses","id","name","description","category","location","url","image","rating","tags","mockGroups","memberCount","premiumServices","IMAGES","transport","executive","price","closeProtection","security","mockPages","title","ROUTES","events","calculateSimilarity","searchTerm","text","toLowerCase","target","includes","index","indexOf","positionBonus","wordBonus","split","some","word","searchWords","targetWords","matchScore","searchWord","targetWord","query","eventService","getEvents","trim","results","event","score","longDescription","tag","hostName","push","type","date","images","sort","a","b","slice","map","result","error","console","business","group","service","page","eventResults","contentResults","Promise","all","businesses","filter","r","groups","pages","typeOrder","aOrder","bOrder","language","label"],"mappings":"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"}