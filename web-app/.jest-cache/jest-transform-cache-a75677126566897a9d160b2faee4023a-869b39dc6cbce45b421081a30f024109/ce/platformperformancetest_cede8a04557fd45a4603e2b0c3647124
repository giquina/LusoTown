6529f5e963d549529bda076bf16ea40f
"use strict";
// Mock Next.js router
jest.mock("next/navigation", ()=>({
        useRouter: ()=>({
                push: jest.fn(),
                prefetch: jest.fn()
            }),
        useSearchParams: ()=>({
                get: jest.fn()
            })
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = require("@testing-library/react");
const _performanceutils = require("../utils/performance-utils");
const _LanguageContext = require("../../src/context/LanguageContext");
const _portuguesebundleoptimizer = require("../../src/utils/portuguese-bundle-optimizer");
// Mock components for performance testing
const MockPortugueseComponent = ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
        "data-testid": "portuguese-content",
        children: "Portuguese Content"
    });
const MockEventCard = ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
        "data-testid": "event-card",
        children: "Event Card"
    });
const MockCulturalGallery = ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
        "data-testid": "cultural-gallery",
        children: "Cultural Gallery"
    });
describe("Platform Performance Tests", ()=>{
    let performanceTester;
    beforeEach(()=>{
        performanceTester = new _performanceutils.PerformanceTester();
        // Reset any global state
        document.documentElement.className = "";
    });
    afterEach(()=>{
        performanceTester = null;
    });
    describe("Component Rendering Performance", ()=>{
        test("Portuguese content components render within performance thresholds", ()=>{
            performanceTester.startTiming();
            const component = ()=>{
                (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsxs)(_LanguageContext.LanguageProvider, {
                    children: [
                        /*#__PURE__*/ (0, _jsxruntime.jsx)(MockPortugueseComponent, {}),
                        /*#__PURE__*/ (0, _jsxruntime.jsx)(MockEventCard, {}),
                        /*#__PURE__*/ (0, _jsxruntime.jsx)(MockCulturalGallery, {})
                    ]
                }));
            };
            const renderTime = performanceTester.measureRenderTime(component);
            expect(renderTime).toBeLessThan(_performanceutils.performanceThresholds.renderTime.acceptable);
            // Verify content is rendered
            expect(_react.screen.getByTestId("portuguese-content")).toBeInTheDocument();
            expect(_react.screen.getByTestId("event-card")).toBeInTheDocument();
            expect(_react.screen.getByTestId("cultural-gallery")).toBeInTheDocument();
        });
        test("Large component trees maintain good performance", ()=>{
            const startTime = performance.now();
            // Simulate rendering multiple Portuguese components
            const components = Array.from({
                length: 50
            }, (_, i)=>/*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                    "data-testid": `portuguese-item-${i}`,
                    children: [
                        "Portuguese Item ",
                        i
                    ]
                }, i));
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_LanguageContext.LanguageProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: components
                })
            }));
            const renderTime = performance.now() - startTime;
            expect(renderTime).toBeLessThan(_performanceutils.performanceThresholds.renderTime.poor);
            // Verify all components rendered
            expect(_react.screen.getAllByText(/Portuguese Item/)).toHaveLength(50);
        });
    });
    describe("Bundle Optimization Performance", ()=>{
        test("Portuguese bundle optimizer initializes quickly", ()=>{
            const startTime = performance.now();
            // Simulate optimizer initialization
            const stats = _portuguesebundleoptimizer.portugueseBundleOptimizer.getOptimizationStats();
            const initTime = performance.now() - startTime;
            expect(initTime).toBeLessThan(100); // Should initialize in < 100ms
            expect(stats).toHaveProperty("loadedBundles");
            expect(stats).toHaveProperty("preloadedResources");
            expect(stats).toHaveProperty("deviceContext");
        });
        test("Critical Portuguese content loading is fast", async ()=>{
            const startTime = performance.now();
            // Mock Portuguese bundle loading
            await _portuguesebundleoptimizer.portugueseBundleOptimizer.loadPortugueseContentBundle("critical");
            const loadTime = performance.now() - startTime;
            expect(loadTime).toBeLessThan(_performanceutils.performanceThresholds.loadTime.good);
        });
        test("Non-critical content loading is properly deferred", async ()=>{
            const startTime = performance.now();
            // Test that low priority content doesn't block critical loading
            const criticalPromise = _portuguesebundleoptimizer.portugueseBundleOptimizer.loadPortugueseContentBundle("critical");
            const lowPriorityPromise = _portuguesebundleoptimizer.portugueseBundleOptimizer.loadPortugueseContentBundle("low");
            // Critical should complete first
            await criticalPromise;
            const criticalTime = performance.now() - startTime;
            await lowPriorityPromise;
            const totalTime = performance.now() - startTime;
            expect(criticalTime).toBeLessThan(_performanceutils.performanceThresholds.loadTime.good);
            expect(totalTime).toBeGreaterThan(criticalTime); // Low priority takes longer
        });
    });
    describe("Mobile Performance Optimization", ()=>{
        beforeEach(()=>{
            // Mock mobile viewport
            Object.defineProperty(window, "innerWidth", {
                writable: true,
                configurable: true,
                value: 375
            });
            // Mock mobile connection
            Object.defineProperty(navigator, "connection", {
                writable: true,
                configurable: true,
                value: {
                    effectiveType: "3g",
                    saveData: false
                }
            });
        });
        test("Mobile optimizations apply within performance budget", ()=>{
            const startTime = performance.now();
            _portuguesebundleoptimizer.portugueseBundleOptimizer.optimizeForMobile();
            const optimizationTime = performance.now() - startTime;
            expect(optimizationTime).toBeLessThan(50); // Should be very fast
            // Check mobile optimizations were applied
            const stats = _portuguesebundleoptimizer.portugueseBundleOptimizer.getOptimizationStats();
            expect(stats.optimizationsApplied).toContain("mobile-optimized");
        });
        test("Touch targets meet minimum size requirements", ()=>{
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                children: [
                    /*#__PURE__*/ (0, _jsxruntime.jsx)("button", {
                        "data-testid": "touch-button",
                        children: "Portuguese Button"
                    }),
                    /*#__PURE__*/ (0, _jsxruntime.jsx)("a", {
                        href: "#",
                        role: "button",
                        "data-testid": "touch-link",
                        children: "Portuguese Link"
                    })
                ]
            }));
            _portuguesebundleoptimizer.portugueseBundleOptimizer.optimizeForMobile();
            const button = _react.screen.getByTestId("touch-button");
            const link = _react.screen.getByTestId("touch-link");
            // Check computed styles would have minimum dimensions
            // (In real environment, this would check actual computed styles)
            expect(button).toBeInTheDocument();
            expect(link).toBeInTheDocument();
        });
    });
    describe("Portuguese Content Loading Performance", ()=>{
        test("Portuguese text rendering is optimized", ()=>{
            const portugueseText = "Bem-vindos � comunidade portuguesa do Reino Unido! Aqui voc� encontrar� eventos culturais aut�nticos.";
            const startTime = performance.now();
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_LanguageContext.LanguageProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                    children: [
                        /*#__PURE__*/ (0, _jsxruntime.jsx)("h1", {
                            children: portugueseText
                        }),
                        /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                            children: 'Comunidade " Cultura " Tradi��o'
                        }),
                        /*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                            children: 'S�o Jo�o " Fado " Bacalhau'
                        })
                    ]
                })
            }));
            const renderTime = performance.now() - startTime;
            expect(renderTime).toBeLessThan(_performanceutils.performanceThresholds.renderTime.good);
            // Verify Portuguese content is rendered
            expect(_react.screen.getByText(portugueseText)).toBeInTheDocument();
            expect(_react.screen.getByText('Comunidade " Cultura " Tradi��o')).toBeInTheDocument();
        });
        test("Cultural categories load with appropriate priorities", async ()=>{
            const categories = [
                "events",
                "cultural",
                "business",
                "community",
                "heritage"
            ];
            const loadTimes = {};
            for (const category of categories){
                const startTime = performance.now();
                // Simulate loading content for each category
                await new Promise((resolve)=>setTimeout(resolve, Math.random() * 10));
                loadTimes[category] = performance.now() - startTime;
            }
            // All categories should load within acceptable time
            Object.values(loadTimes).forEach((time)=>{
                expect(time).toBeLessThan(50); // Very fast mock loading
            });
            // Verify all categories processed
            expect(Object.keys(loadTimes)).toHaveLength(5);
        });
    });
    describe("Memory Performance", ()=>{
        test("Component cleanup prevents memory leaks", ()=>{
            const initialMemory = performance.memory?.usedJSHeapSize || 0;
            // Render and unmount many components
            for(let i = 0; i < 100; i++){
                const { unmount } = (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_LanguageContext.LanguageProvider, {
                    children: /*#__PURE__*/ (0, _jsxruntime.jsx)(MockPortugueseComponent, {})
                }));
                unmount();
            }
            const finalMemory = performance.memory?.usedJSHeapSize || 0;
            const memoryIncrease = finalMemory - initialMemory;
            // Memory increase should be reasonable (less than 5MB)
            expect(memoryIncrease).toBeLessThan(5 * 1024 * 1024);
        });
        test("Large Portuguese content sets handle memory efficiently", ()=>{
            const largeDataSet = Array.from({
                length: 1000
            }, (_, i)=>({
                    id: i,
                    title: `Evento Portugu�s ${i}`,
                    description: "Descri��o do evento cultural portugu�s na comunidade",
                    category: "cultural"
                }));
            const startTime = performance.now();
            const initialMemory = performance.memory?.usedJSHeapSize || 0;
            (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_LanguageContext.LanguageProvider, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                    children: largeDataSet.slice(0, 50).map((item)=>/*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                            "data-testid": `event-${item.id}`,
                            children: [
                                /*#__PURE__*/ (0, _jsxruntime.jsx)("h3", {
                                    children: item.title
                                }),
                                /*#__PURE__*/ (0, _jsxruntime.jsx)("p", {
                                    children: item.description
                                })
                            ]
                        }, item.id))
                })
            }));
            const renderTime = performance.now() - startTime;
            const finalMemory = performance.memory?.usedJSHeapSize || 0;
            expect(renderTime).toBeLessThan(_performanceutils.performanceThresholds.renderTime.acceptable);
            expect(finalMemory - initialMemory).toBeLessThan(2 * 1024 * 1024); // Less than 2MB
            // Verify content rendered
            expect(_react.screen.getByTestId("event-0")).toBeInTheDocument();
            expect(_react.screen.getByTestId("event-49")).toBeInTheDocument();
        });
    });
    describe("Network-Aware Performance", ()=>{
        test("Slow connection triggers appropriate optimizations", ()=>{
            // Mock slow connection
            Object.defineProperty(navigator, "connection", {
                writable: true,
                configurable: true,
                value: {
                    effectiveType: "2g",
                    saveData: true
                }
            });
            const startTime = performance.now();
            _portuguesebundleoptimizer.portugueseBundleOptimizer.optimizeForMobile();
            const optimizationTime = performance.now() - startTime;
            expect(optimizationTime).toBeLessThan(100);
            const stats = _portuguesebundleoptimizer.portugueseBundleOptimizer.getOptimizationStats();
            expect(stats.optimizationsApplied).toContain("data-saver");
        });
        test("Fast connection allows full feature loading", ()=>{
            // Mock fast connection
            Object.defineProperty(navigator, "connection", {
                writable: true,
                configurable: true,
                value: {
                    effectiveType: "4g",
                    saveData: false
                }
            });
            const stats = _portuguesebundleoptimizer.portugueseBundleOptimizer.getOptimizationStats();
            // Fast connections should not have data-saver optimizations
            expect(stats.optimizationsApplied).not.toContain("data-saver");
        });
    });
    describe("Performance Metrics Collection", ()=>{
        test("Performance metrics are collected efficiently", ()=>{
            const metrics = performanceTester.getMetrics();
            expect(metrics).toHaveProperty("loadTime");
            expect(metrics).toHaveProperty("renderTime");
            expect(metrics).toHaveProperty("interactionTime");
            expect(metrics).toHaveProperty("memoryUsage");
            expect(metrics).toHaveProperty("networkRequests");
            expect(metrics).toHaveProperty("cacheHitRate");
            // All metrics should be numbers
            Object.values(metrics).forEach((value)=>{
                expect(typeof value).toBe("number");
            });
        });
        test("Performance thresholds are within acceptable ranges", ()=>{
            expect(_performanceutils.performanceThresholds.loadTime.excellent).toBeLessThan(_performanceutils.performanceThresholds.loadTime.good);
            expect(_performanceutils.performanceThresholds.loadTime.good).toBeLessThan(_performanceutils.performanceThresholds.loadTime.acceptable);
            expect(_performanceutils.performanceThresholds.loadTime.acceptable).toBeLessThan(_performanceutils.performanceThresholds.loadTime.poor);
            expect(_performanceutils.performanceThresholds.renderTime.excellent).toBeLessThan(_performanceutils.performanceThresholds.renderTime.good);
            expect(_performanceutils.performanceThresholds.renderTime.good).toBeLessThan(_performanceutils.performanceThresholds.renderTime.acceptable);
            // Mobile thresholds should be reasonable
            expect(_performanceutils.performanceThresholds.mobile.touchResponseTime.excellent).toBeLessThan(50);
        });
    });
});
describe("Portuguese-Specific Performance Tests", ()=>{
    test("Portuguese diacritics render without performance penalty", ()=>{
        const textWithDiacritics = [
            "A��o",
            "Cora��o",
            "Jo�o",
            "S�o Paulo",
            "Tradi��o",
            "Informa��o",
            "Organiza��o",
            "Na��o",
            "Educa��o",
            "Constru��o"
        ];
        const startTime = performance.now();
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_LanguageContext.LanguageProvider, {
            children: /*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                children: textWithDiacritics.map((text, i)=>/*#__PURE__*/ (0, _jsxruntime.jsx)("span", {
                        "data-testid": `diacritic-${i}`,
                        children: text
                    }, i))
            })
        }));
        const renderTime = performance.now() - startTime;
        expect(renderTime).toBeLessThan(_performanceutils.performanceThresholds.renderTime.good);
        // Verify all diacritics rendered correctly
        textWithDiacritics.forEach((text, i)=>{
            expect(_react.screen.getByTestId(`diacritic-${i}`)).toHaveTextContent(text);
        });
    });
    test("Portuguese flag colors render efficiently", ()=>{
        const portugalColors = [
            "#006600",
            "#FF0000",
            "#FFD700"
        ]; // Green, Red, Gold
        const startTime = performance.now();
        (0, _react.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
            children: portugalColors.map((color, i)=>/*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
                    "data-testid": `color-${i}`,
                    style: {
                        backgroundColor: color,
                        width: 100,
                        height: 50
                    },
                    children: [
                        "Portuguese Color ",
                        i + 1
                    ]
                }, i))
        }));
        const renderTime = performance.now() - startTime;
        expect(renderTime).toBeLessThan(_performanceutils.performanceThresholds.renderTime.good);
        // Verify all colors rendered
        portugalColors.forEach((_, i)=>{
            expect(_react.screen.getByTestId(`color-${i}`)).toBeInTheDocument();
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi93b3Jrc3BhY2VzL0x1c29Ub3duL3dlYi1hcHAvX190ZXN0c19fL3BlcmZvcm1hbmNlL3BsYXRmb3JtLXBlcmZvcm1hbmNlLnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlbmRlciwgc2NyZWVuIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XG5pbXBvcnQgeyBQZXJmb3JtYW5jZVRlc3RlciwgcGVyZm9ybWFuY2VUaHJlc2hvbGRzIH0gZnJvbSAnLi4vdXRpbHMvcGVyZm9ybWFuY2UtdXRpbHMnO1xuaW1wb3J0IHsgTGFuZ3VhZ2VQcm92aWRlciB9IGZyb20gJ0AvY29udGV4dC9MYW5ndWFnZUNvbnRleHQnO1xuaW1wb3J0IHsgcG9ydHVndWVzZUJ1bmRsZU9wdGltaXplciB9IGZyb20gJ0AvdXRpbHMvcG9ydHVndWVzZS1idW5kbGUtb3B0aW1pemVyJztcblxuLy8gTW9jayBOZXh0LmpzIHJvdXRlclxuamVzdC5tb2NrKCduZXh0L25hdmlnYXRpb24nLCAoKSA9PiAoe1xuICB1c2VSb3V0ZXI6ICgpID0+ICh7XG4gICAgcHVzaDogamVzdC5mbigpLFxuICAgIHByZWZldGNoOiBqZXN0LmZuKCksXG4gIH0pLFxuICB1c2VTZWFyY2hQYXJhbXM6ICgpID0+ICh7XG4gICAgZ2V0OiBqZXN0LmZuKCksXG4gIH0pLFxufSkpO1xuXG4vLyBNb2NrIGNvbXBvbmVudHMgZm9yIHBlcmZvcm1hbmNlIHRlc3RpbmdcbmNvbnN0IE1vY2tQb3J0dWd1ZXNlQ29tcG9uZW50ID0gKCkgPT4gPGRpdiBkYXRhLXRlc3RpZD1cInBvcnR1Z3Vlc2UtY29udGVudFwiPlBvcnR1Z3Vlc2UgQ29udGVudDwvZGl2PjtcbmNvbnN0IE1vY2tFdmVudENhcmQgPSAoKSA9PiA8ZGl2IGRhdGEtdGVzdGlkPVwiZXZlbnQtY2FyZFwiPkV2ZW50IENhcmQ8L2Rpdj47XG5jb25zdCBNb2NrQ3VsdHVyYWxHYWxsZXJ5ID0gKCkgPT4gPGRpdiBkYXRhLXRlc3RpZD1cImN1bHR1cmFsLWdhbGxlcnlcIj5DdWx0dXJhbCBHYWxsZXJ5PC9kaXY+O1xuXG5kZXNjcmliZSgnUGxhdGZvcm0gUGVyZm9ybWFuY2UgVGVzdHMnLCAoKSA9PiB7XG4gIGxldCBwZXJmb3JtYW5jZVRlc3RlcjogUGVyZm9ybWFuY2VUZXN0ZXI7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgcGVyZm9ybWFuY2VUZXN0ZXIgPSBuZXcgUGVyZm9ybWFuY2VUZXN0ZXIoKTtcbiAgICAvLyBSZXNldCBhbnkgZ2xvYmFsIHN0YXRlXG4gICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsYXNzTmFtZSA9ICcnO1xuICB9KTtcblxuICBhZnRlckVhY2goKCkgPT4ge1xuICAgIHBlcmZvcm1hbmNlVGVzdGVyID0gbnVsbCBhcyBhbnk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdDb21wb25lbnQgUmVuZGVyaW5nIFBlcmZvcm1hbmNlJywgKCkgPT4ge1xuICAgIHRlc3QoJ1BvcnR1Z3Vlc2UgY29udGVudCBjb21wb25lbnRzIHJlbmRlciB3aXRoaW4gcGVyZm9ybWFuY2UgdGhyZXNob2xkcycsICgpID0+IHtcbiAgICAgIHBlcmZvcm1hbmNlVGVzdGVyLnN0YXJ0VGltaW5nKCk7XG5cbiAgICAgIGNvbnN0IGNvbXBvbmVudCA9ICgpID0+IHtcbiAgICAgICAgcmVuZGVyKFxuICAgICAgICAgIDxMYW5ndWFnZVByb3ZpZGVyPlxuICAgICAgICAgICAgPE1vY2tQb3J0dWd1ZXNlQ29tcG9uZW50IC8+XG4gICAgICAgICAgICA8TW9ja0V2ZW50Q2FyZCAvPlxuICAgICAgICAgICAgPE1vY2tDdWx0dXJhbEdhbGxlcnkgLz5cbiAgICAgICAgICA8L0xhbmd1YWdlUHJvdmlkZXI+XG4gICAgICAgICk7XG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZW5kZXJUaW1lID0gcGVyZm9ybWFuY2VUZXN0ZXIubWVhc3VyZVJlbmRlclRpbWUoY29tcG9uZW50KTtcbiAgICAgIGV4cGVjdChyZW5kZXJUaW1lKS50b0JlTGVzc1RoYW4ocGVyZm9ybWFuY2VUaHJlc2hvbGRzLnJlbmRlclRpbWUuYWNjZXB0YWJsZSk7XG5cbiAgICAgIC8vIFZlcmlmeSBjb250ZW50IGlzIHJlbmRlcmVkXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGVzdElkKCdwb3J0dWd1ZXNlLWNvbnRlbnQnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ2V2ZW50LWNhcmQnKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoJ2N1bHR1cmFsLWdhbGxlcnknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ0xhcmdlIGNvbXBvbmVudCB0cmVlcyBtYWludGFpbiBnb29kIHBlcmZvcm1hbmNlJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG5cbiAgICAgIC8vIFNpbXVsYXRlIHJlbmRlcmluZyBtdWx0aXBsZSBQb3J0dWd1ZXNlIGNvbXBvbmVudHNcbiAgICAgIGNvbnN0IGNvbXBvbmVudHMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiA1MCB9LCAoXywgaSkgPT4gKFxuICAgICAgICA8ZGl2IGtleT17aX0gZGF0YS10ZXN0aWQ9e2Bwb3J0dWd1ZXNlLWl0ZW0tJHtpfWB9PlxuICAgICAgICAgIFBvcnR1Z3Vlc2UgSXRlbSB7aX1cbiAgICAgICAgPC9kaXY+XG4gICAgICApKTtcblxuICAgICAgcmVuZGVyKFxuICAgICAgICA8TGFuZ3VhZ2VQcm92aWRlcj5cbiAgICAgICAgICA8ZGl2Pntjb21wb25lbnRzfTwvZGl2PlxuICAgICAgICA8L0xhbmd1YWdlUHJvdmlkZXI+XG4gICAgICApO1xuXG4gICAgICBjb25zdCByZW5kZXJUaW1lID0gcGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICBleHBlY3QocmVuZGVyVGltZSkudG9CZUxlc3NUaGFuKHBlcmZvcm1hbmNlVGhyZXNob2xkcy5yZW5kZXJUaW1lLnBvb3IpO1xuXG4gICAgICAvLyBWZXJpZnkgYWxsIGNvbXBvbmVudHMgcmVuZGVyZWRcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QWxsQnlUZXh0KC9Qb3J0dWd1ZXNlIEl0ZW0vKSkudG9IYXZlTGVuZ3RoKDUwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0J1bmRsZSBPcHRpbWl6YXRpb24gUGVyZm9ybWFuY2UnLCAoKSA9PiB7XG4gICAgdGVzdCgnUG9ydHVndWVzZSBidW5kbGUgb3B0aW1pemVyIGluaXRpYWxpemVzIHF1aWNrbHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgIFxuICAgICAgLy8gU2ltdWxhdGUgb3B0aW1pemVyIGluaXRpYWxpemF0aW9uXG4gICAgICBjb25zdCBzdGF0cyA9IHBvcnR1Z3Vlc2VCdW5kbGVPcHRpbWl6ZXIuZ2V0T3B0aW1pemF0aW9uU3RhdHMoKTtcbiAgICAgIFxuICAgICAgY29uc3QgaW5pdFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgIGV4cGVjdChpbml0VGltZSkudG9CZUxlc3NUaGFuKDEwMCk7IC8vIFNob3VsZCBpbml0aWFsaXplIGluIDwgMTAwbXNcblxuICAgICAgZXhwZWN0KHN0YXRzKS50b0hhdmVQcm9wZXJ0eSgnbG9hZGVkQnVuZGxlcycpO1xuICAgICAgZXhwZWN0KHN0YXRzKS50b0hhdmVQcm9wZXJ0eSgncHJlbG9hZGVkUmVzb3VyY2VzJyk7XG4gICAgICBleHBlY3Qoc3RhdHMpLnRvSGF2ZVByb3BlcnR5KCdkZXZpY2VDb250ZXh0Jyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdDcml0aWNhbCBQb3J0dWd1ZXNlIGNvbnRlbnQgbG9hZGluZyBpcyBmYXN0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICBcbiAgICAgIC8vIE1vY2sgUG9ydHVndWVzZSBidW5kbGUgbG9hZGluZ1xuICAgICAgYXdhaXQgcG9ydHVndWVzZUJ1bmRsZU9wdGltaXplci5sb2FkUG9ydHVndWVzZUNvbnRlbnRCdW5kbGUoJ2NyaXRpY2FsJyk7XG4gICAgICBcbiAgICAgIGNvbnN0IGxvYWRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICBleHBlY3QobG9hZFRpbWUpLnRvQmVMZXNzVGhhbihwZXJmb3JtYW5jZVRocmVzaG9sZHMubG9hZFRpbWUuZ29vZCk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdOb24tY3JpdGljYWwgY29udGVudCBsb2FkaW5nIGlzIHByb3Blcmx5IGRlZmVycmVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgdGhhdCBsb3cgcHJpb3JpdHkgY29udGVudCBkb2Vzbid0IGJsb2NrIGNyaXRpY2FsIGxvYWRpbmdcbiAgICAgIGNvbnN0IGNyaXRpY2FsUHJvbWlzZSA9IHBvcnR1Z3Vlc2VCdW5kbGVPcHRpbWl6ZXIubG9hZFBvcnR1Z3Vlc2VDb250ZW50QnVuZGxlKCdjcml0aWNhbCcpO1xuICAgICAgY29uc3QgbG93UHJpb3JpdHlQcm9taXNlID0gcG9ydHVndWVzZUJ1bmRsZU9wdGltaXplci5sb2FkUG9ydHVndWVzZUNvbnRlbnRCdW5kbGUoJ2xvdycpO1xuICAgICAgXG4gICAgICAvLyBDcml0aWNhbCBzaG91bGQgY29tcGxldGUgZmlyc3RcbiAgICAgIGF3YWl0IGNyaXRpY2FsUHJvbWlzZTtcbiAgICAgIGNvbnN0IGNyaXRpY2FsVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgXG4gICAgICBhd2FpdCBsb3dQcmlvcml0eVByb21pc2U7XG4gICAgICBjb25zdCB0b3RhbFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGNyaXRpY2FsVGltZSkudG9CZUxlc3NUaGFuKHBlcmZvcm1hbmNlVGhyZXNob2xkcy5sb2FkVGltZS5nb29kKTtcbiAgICAgIGV4cGVjdCh0b3RhbFRpbWUpLnRvQmVHcmVhdGVyVGhhbihjcml0aWNhbFRpbWUpOyAvLyBMb3cgcHJpb3JpdHkgdGFrZXMgbG9uZ2VyXG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdNb2JpbGUgUGVyZm9ybWFuY2UgT3B0aW1pemF0aW9uJywgKCkgPT4ge1xuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgLy8gTW9jayBtb2JpbGUgdmlld3BvcnRcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdpbm5lcldpZHRoJywge1xuICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICB2YWx1ZTogMzc1LFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIE1vY2sgbW9iaWxlIGNvbm5lY3Rpb25cbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuYXZpZ2F0b3IsICdjb25uZWN0aW9uJywge1xuICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICB2YWx1ZToge1xuICAgICAgICAgIGVmZmVjdGl2ZVR5cGU6ICczZycsXG4gICAgICAgICAgc2F2ZURhdGE6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdNb2JpbGUgb3B0aW1pemF0aW9ucyBhcHBseSB3aXRoaW4gcGVyZm9ybWFuY2UgYnVkZ2V0JywgKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICBcbiAgICAgIHBvcnR1Z3Vlc2VCdW5kbGVPcHRpbWl6ZXIub3B0aW1pemVGb3JNb2JpbGUoKTtcbiAgICAgIFxuICAgICAgY29uc3Qgb3B0aW1pemF0aW9uVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgZXhwZWN0KG9wdGltaXphdGlvblRpbWUpLnRvQmVMZXNzVGhhbig1MCk7IC8vIFNob3VsZCBiZSB2ZXJ5IGZhc3RcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgbW9iaWxlIG9wdGltaXphdGlvbnMgd2VyZSBhcHBsaWVkXG4gICAgICBjb25zdCBzdGF0cyA9IHBvcnR1Z3Vlc2VCdW5kbGVPcHRpbWl6ZXIuZ2V0T3B0aW1pemF0aW9uU3RhdHMoKTtcbiAgICAgIGV4cGVjdChzdGF0cy5vcHRpbWl6YXRpb25zQXBwbGllZCkudG9Db250YWluKCdtb2JpbGUtb3B0aW1pemVkJyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdUb3VjaCB0YXJnZXRzIG1lZXQgbWluaW11bSBzaXplIHJlcXVpcmVtZW50cycsICgpID0+IHtcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPGRpdj5cbiAgICAgICAgICA8YnV0dG9uIGRhdGEtdGVzdGlkPVwidG91Y2gtYnV0dG9uXCI+UG9ydHVndWVzZSBCdXR0b248L2J1dHRvbj5cbiAgICAgICAgICA8YSBocmVmPVwiI1wiIHJvbGU9XCJidXR0b25cIiBkYXRhLXRlc3RpZD1cInRvdWNoLWxpbmtcIj5Qb3J0dWd1ZXNlIExpbms8L2E+XG4gICAgICAgIDwvZGl2PlxuICAgICAgKTtcblxuICAgICAgcG9ydHVndWVzZUJ1bmRsZU9wdGltaXplci5vcHRpbWl6ZUZvck1vYmlsZSgpO1xuXG4gICAgICBjb25zdCBidXR0b24gPSBzY3JlZW4uZ2V0QnlUZXN0SWQoJ3RvdWNoLWJ1dHRvbicpO1xuICAgICAgY29uc3QgbGluayA9IHNjcmVlbi5nZXRCeVRlc3RJZCgndG91Y2gtbGluaycpO1xuXG4gICAgICAvLyBDaGVjayBjb21wdXRlZCBzdHlsZXMgd291bGQgaGF2ZSBtaW5pbXVtIGRpbWVuc2lvbnNcbiAgICAgIC8vIChJbiByZWFsIGVudmlyb25tZW50LCB0aGlzIHdvdWxkIGNoZWNrIGFjdHVhbCBjb21wdXRlZCBzdHlsZXMpXG4gICAgICBleHBlY3QoYnV0dG9uKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KGxpbmspLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQb3J0dWd1ZXNlIENvbnRlbnQgTG9hZGluZyBQZXJmb3JtYW5jZScsICgpID0+IHtcbiAgICB0ZXN0KCdQb3J0dWd1ZXNlIHRleHQgcmVuZGVyaW5nIGlzIG9wdGltaXplZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHBvcnR1Z3Vlc2VUZXh0ID0gJ0JlbS12aW5kb3Mg77+9IGNvbXVuaWRhZGUgcG9ydHVndWVzYSBkbyBSZWlubyBVbmlkbyEgQXF1aSB2b2Pvv70gZW5jb250cmFy77+9IGV2ZW50b3MgY3VsdHVyYWlzIGF1dO+/vW50aWNvcy4nO1xuICAgICAgXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgIFxuICAgICAgcmVuZGVyKFxuICAgICAgICA8TGFuZ3VhZ2VQcm92aWRlcj5cbiAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPGgxPntwb3J0dWd1ZXNlVGV4dH08L2gxPlxuICAgICAgICAgICAgPHA+Q29tdW5pZGFkZSBcIiBDdWx0dXJhIFwiIFRyYWRp77+977+9bzwvcD5cbiAgICAgICAgICAgIDxzcGFuPlPvv71vIEpv77+9byBcIiBGYWRvIFwiIEJhY2FsaGF1PC9zcGFuPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L0xhbmd1YWdlUHJvdmlkZXI+XG4gICAgICApO1xuICAgICAgXG4gICAgICBjb25zdCByZW5kZXJUaW1lID0gcGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICBleHBlY3QocmVuZGVyVGltZSkudG9CZUxlc3NUaGFuKHBlcmZvcm1hbmNlVGhyZXNob2xkcy5yZW5kZXJUaW1lLmdvb2QpO1xuXG4gICAgICAvLyBWZXJpZnkgUG9ydHVndWVzZSBjb250ZW50IGlzIHJlbmRlcmVkXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dChwb3J0dWd1ZXNlVGV4dCkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgnQ29tdW5pZGFkZSBcIiBDdWx0dXJhIFwiIFRyYWRp77+977+9bycpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnQ3VsdHVyYWwgY2F0ZWdvcmllcyBsb2FkIHdpdGggYXBwcm9wcmlhdGUgcHJpb3JpdGllcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBbJ2V2ZW50cycsICdjdWx0dXJhbCcsICdidXNpbmVzcycsICdjb21tdW5pdHknLCAnaGVyaXRhZ2UnXTtcbiAgICAgIGNvbnN0IGxvYWRUaW1lczogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9O1xuXG4gICAgICBmb3IgKGNvbnN0IGNhdGVnb3J5IG9mIGNhdGVnb3JpZXMpIHtcbiAgICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICAgIFxuICAgICAgICAvLyBTaW11bGF0ZSBsb2FkaW5nIGNvbnRlbnQgZm9yIGVhY2ggY2F0ZWdvcnlcbiAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIE1hdGgucmFuZG9tKCkgKiAxMCkpO1xuICAgICAgICBcbiAgICAgICAgbG9hZFRpbWVzW2NhdGVnb3J5XSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgfVxuXG4gICAgICAvLyBBbGwgY2F0ZWdvcmllcyBzaG91bGQgbG9hZCB3aXRoaW4gYWNjZXB0YWJsZSB0aW1lXG4gICAgICBPYmplY3QudmFsdWVzKGxvYWRUaW1lcykuZm9yRWFjaCh0aW1lID0+IHtcbiAgICAgICAgZXhwZWN0KHRpbWUpLnRvQmVMZXNzVGhhbig1MCk7IC8vIFZlcnkgZmFzdCBtb2NrIGxvYWRpbmdcbiAgICAgIH0pO1xuXG4gICAgICAvLyBWZXJpZnkgYWxsIGNhdGVnb3JpZXMgcHJvY2Vzc2VkXG4gICAgICBleHBlY3QoT2JqZWN0LmtleXMobG9hZFRpbWVzKSkudG9IYXZlTGVuZ3RoKDUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnTWVtb3J5IFBlcmZvcm1hbmNlJywgKCkgPT4ge1xuICAgIHRlc3QoJ0NvbXBvbmVudCBjbGVhbnVwIHByZXZlbnRzIG1lbW9yeSBsZWFrcycsICgpID0+IHtcbiAgICAgIGNvbnN0IGluaXRpYWxNZW1vcnkgPSAocGVyZm9ybWFuY2UgYXMgYW55KS5tZW1vcnk/LnVzZWRKU0hlYXBTaXplIHx8IDA7XG4gICAgICBcbiAgICAgIC8vIFJlbmRlciBhbmQgdW5tb3VudCBtYW55IGNvbXBvbmVudHNcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTAwOyBpKyspIHtcbiAgICAgICAgY29uc3QgeyB1bm1vdW50IH0gPSByZW5kZXIoXG4gICAgICAgICAgPExhbmd1YWdlUHJvdmlkZXI+XG4gICAgICAgICAgICA8TW9ja1BvcnR1Z3Vlc2VDb21wb25lbnQgLz5cbiAgICAgICAgICA8L0xhbmd1YWdlUHJvdmlkZXI+XG4gICAgICAgICk7XG4gICAgICAgIHVubW91bnQoKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZmluYWxNZW1vcnkgPSAocGVyZm9ybWFuY2UgYXMgYW55KS5tZW1vcnk/LnVzZWRKU0hlYXBTaXplIHx8IDA7XG4gICAgICBjb25zdCBtZW1vcnlJbmNyZWFzZSA9IGZpbmFsTWVtb3J5IC0gaW5pdGlhbE1lbW9yeTtcblxuICAgICAgLy8gTWVtb3J5IGluY3JlYXNlIHNob3VsZCBiZSByZWFzb25hYmxlIChsZXNzIHRoYW4gNU1CKVxuICAgICAgZXhwZWN0KG1lbW9yeUluY3JlYXNlKS50b0JlTGVzc1RoYW4oNSAqIDEwMjQgKiAxMDI0KTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ0xhcmdlIFBvcnR1Z3Vlc2UgY29udGVudCBzZXRzIGhhbmRsZSBtZW1vcnkgZWZmaWNpZW50bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBsYXJnZURhdGFTZXQgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiAxMDAwIH0sIChfLCBpKSA9PiAoe1xuICAgICAgICBpZDogaSxcbiAgICAgICAgdGl0bGU6IGBFdmVudG8gUG9ydHVnde+/vXMgJHtpfWAsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnRGVzY3Jp77+977+9byBkbyBldmVudG8gY3VsdHVyYWwgcG9ydHVnde+/vXMgbmEgY29tdW5pZGFkZScsXG4gICAgICAgIGNhdGVnb3J5OiAnY3VsdHVyYWwnLFxuICAgICAgfSkpO1xuXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgIGNvbnN0IGluaXRpYWxNZW1vcnkgPSAocGVyZm9ybWFuY2UgYXMgYW55KS5tZW1vcnk/LnVzZWRKU0hlYXBTaXplIHx8IDA7XG5cbiAgICAgIHJlbmRlcihcbiAgICAgICAgPExhbmd1YWdlUHJvdmlkZXI+XG4gICAgICAgICAgPGRpdj5cbiAgICAgICAgICAgIHtsYXJnZURhdGFTZXQuc2xpY2UoMCwgNTApLm1hcChpdGVtID0+IChcbiAgICAgICAgICAgICAgPGRpdiBrZXk9e2l0ZW0uaWR9IGRhdGEtdGVzdGlkPXtgZXZlbnQtJHtpdGVtLmlkfWB9PlxuICAgICAgICAgICAgICAgIDxoMz57aXRlbS50aXRsZX08L2gzPlxuICAgICAgICAgICAgICAgIDxwPntpdGVtLmRlc2NyaXB0aW9ufTwvcD5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9MYW5ndWFnZVByb3ZpZGVyPlxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVuZGVyVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgY29uc3QgZmluYWxNZW1vcnkgPSAocGVyZm9ybWFuY2UgYXMgYW55KS5tZW1vcnk/LnVzZWRKU0hlYXBTaXplIHx8IDA7XG5cbiAgICAgIGV4cGVjdChyZW5kZXJUaW1lKS50b0JlTGVzc1RoYW4ocGVyZm9ybWFuY2VUaHJlc2hvbGRzLnJlbmRlclRpbWUuYWNjZXB0YWJsZSk7XG4gICAgICBleHBlY3QoZmluYWxNZW1vcnkgLSBpbml0aWFsTWVtb3J5KS50b0JlTGVzc1RoYW4oMiAqIDEwMjQgKiAxMDI0KTsgLy8gTGVzcyB0aGFuIDJNQlxuICAgICAgXG4gICAgICAvLyBWZXJpZnkgY29udGVudCByZW5kZXJlZFxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnZXZlbnQtMCcpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZCgnZXZlbnQtNDknKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ05ldHdvcmstQXdhcmUgUGVyZm9ybWFuY2UnLCAoKSA9PiB7XG4gICAgdGVzdCgnU2xvdyBjb25uZWN0aW9uIHRyaWdnZXJzIGFwcHJvcHJpYXRlIG9wdGltaXphdGlvbnMnLCAoKSA9PiB7XG4gICAgICAvLyBNb2NrIHNsb3cgY29ubmVjdGlvblxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5hdmlnYXRvciwgJ2Nvbm5lY3Rpb24nLCB7XG4gICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgIHZhbHVlOiB7XG4gICAgICAgICAgZWZmZWN0aXZlVHlwZTogJzJnJyxcbiAgICAgICAgICBzYXZlRGF0YTogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgIHBvcnR1Z3Vlc2VCdW5kbGVPcHRpbWl6ZXIub3B0aW1pemVGb3JNb2JpbGUoKTtcbiAgICAgIGNvbnN0IG9wdGltaXphdGlvblRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICAgICAgZXhwZWN0KG9wdGltaXphdGlvblRpbWUpLnRvQmVMZXNzVGhhbigxMDApO1xuXG4gICAgICBjb25zdCBzdGF0cyA9IHBvcnR1Z3Vlc2VCdW5kbGVPcHRpbWl6ZXIuZ2V0T3B0aW1pemF0aW9uU3RhdHMoKTtcbiAgICAgIGV4cGVjdChzdGF0cy5vcHRpbWl6YXRpb25zQXBwbGllZCkudG9Db250YWluKCdkYXRhLXNhdmVyJyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdGYXN0IGNvbm5lY3Rpb24gYWxsb3dzIGZ1bGwgZmVhdHVyZSBsb2FkaW5nJywgKCkgPT4ge1xuICAgICAgLy8gTW9jayBmYXN0IGNvbm5lY3Rpb25cbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuYXZpZ2F0b3IsICdjb25uZWN0aW9uJywge1xuICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICB2YWx1ZToge1xuICAgICAgICAgIGVmZmVjdGl2ZVR5cGU6ICc0ZycsXG4gICAgICAgICAgc2F2ZURhdGE6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHN0YXRzID0gcG9ydHVndWVzZUJ1bmRsZU9wdGltaXplci5nZXRPcHRpbWl6YXRpb25TdGF0cygpO1xuICAgICAgXG4gICAgICAvLyBGYXN0IGNvbm5lY3Rpb25zIHNob3VsZCBub3QgaGF2ZSBkYXRhLXNhdmVyIG9wdGltaXphdGlvbnNcbiAgICAgIGV4cGVjdChzdGF0cy5vcHRpbWl6YXRpb25zQXBwbGllZCkubm90LnRvQ29udGFpbignZGF0YS1zYXZlcicpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnUGVyZm9ybWFuY2UgTWV0cmljcyBDb2xsZWN0aW9uJywgKCkgPT4ge1xuICAgIHRlc3QoJ1BlcmZvcm1hbmNlIG1ldHJpY3MgYXJlIGNvbGxlY3RlZCBlZmZpY2llbnRseScsICgpID0+IHtcbiAgICAgIGNvbnN0IG1ldHJpY3MgPSBwZXJmb3JtYW5jZVRlc3Rlci5nZXRNZXRyaWNzKCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChtZXRyaWNzKS50b0hhdmVQcm9wZXJ0eSgnbG9hZFRpbWUnKTtcbiAgICAgIGV4cGVjdChtZXRyaWNzKS50b0hhdmVQcm9wZXJ0eSgncmVuZGVyVGltZScpO1xuICAgICAgZXhwZWN0KG1ldHJpY3MpLnRvSGF2ZVByb3BlcnR5KCdpbnRlcmFjdGlvblRpbWUnKTtcbiAgICAgIGV4cGVjdChtZXRyaWNzKS50b0hhdmVQcm9wZXJ0eSgnbWVtb3J5VXNhZ2UnKTtcbiAgICAgIGV4cGVjdChtZXRyaWNzKS50b0hhdmVQcm9wZXJ0eSgnbmV0d29ya1JlcXVlc3RzJyk7XG4gICAgICBleHBlY3QobWV0cmljcykudG9IYXZlUHJvcGVydHkoJ2NhY2hlSGl0UmF0ZScpO1xuICAgICAgXG4gICAgICAvLyBBbGwgbWV0cmljcyBzaG91bGQgYmUgbnVtYmVyc1xuICAgICAgT2JqZWN0LnZhbHVlcyhtZXRyaWNzKS5mb3JFYWNoKHZhbHVlID0+IHtcbiAgICAgICAgZXhwZWN0KHR5cGVvZiB2YWx1ZSkudG9CZSgnbnVtYmVyJyk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ1BlcmZvcm1hbmNlIHRocmVzaG9sZHMgYXJlIHdpdGhpbiBhY2NlcHRhYmxlIHJhbmdlcycsICgpID0+IHtcbiAgICAgIGV4cGVjdChwZXJmb3JtYW5jZVRocmVzaG9sZHMubG9hZFRpbWUuZXhjZWxsZW50KS50b0JlTGVzc1RoYW4ocGVyZm9ybWFuY2VUaHJlc2hvbGRzLmxvYWRUaW1lLmdvb2QpO1xuICAgICAgZXhwZWN0KHBlcmZvcm1hbmNlVGhyZXNob2xkcy5sb2FkVGltZS5nb29kKS50b0JlTGVzc1RoYW4ocGVyZm9ybWFuY2VUaHJlc2hvbGRzLmxvYWRUaW1lLmFjY2VwdGFibGUpO1xuICAgICAgZXhwZWN0KHBlcmZvcm1hbmNlVGhyZXNob2xkcy5sb2FkVGltZS5hY2NlcHRhYmxlKS50b0JlTGVzc1RoYW4ocGVyZm9ybWFuY2VUaHJlc2hvbGRzLmxvYWRUaW1lLnBvb3IpO1xuICAgICAgXG4gICAgICBleHBlY3QocGVyZm9ybWFuY2VUaHJlc2hvbGRzLnJlbmRlclRpbWUuZXhjZWxsZW50KS50b0JlTGVzc1RoYW4ocGVyZm9ybWFuY2VUaHJlc2hvbGRzLnJlbmRlclRpbWUuZ29vZCk7XG4gICAgICBleHBlY3QocGVyZm9ybWFuY2VUaHJlc2hvbGRzLnJlbmRlclRpbWUuZ29vZCkudG9CZUxlc3NUaGFuKHBlcmZvcm1hbmNlVGhyZXNob2xkcy5yZW5kZXJUaW1lLmFjY2VwdGFibGUpO1xuICAgICAgXG4gICAgICAvLyBNb2JpbGUgdGhyZXNob2xkcyBzaG91bGQgYmUgcmVhc29uYWJsZVxuICAgICAgZXhwZWN0KHBlcmZvcm1hbmNlVGhyZXNob2xkcy5tb2JpbGUudG91Y2hSZXNwb25zZVRpbWUuZXhjZWxsZW50KS50b0JlTGVzc1RoYW4oNTApO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnUG9ydHVndWVzZS1TcGVjaWZpYyBQZXJmb3JtYW5jZSBUZXN0cycsICgpID0+IHtcbiAgdGVzdCgnUG9ydHVndWVzZSBkaWFjcml0aWNzIHJlbmRlciB3aXRob3V0IHBlcmZvcm1hbmNlIHBlbmFsdHknLCAoKSA9PiB7XG4gICAgY29uc3QgdGV4dFdpdGhEaWFjcml0aWNzID0gW1xuICAgICAgJ0Hvv73vv71vJywgJ0NvcmHvv73vv71vJywgJ0pv77+9bycsICdT77+9byBQYXVsbycsICdUcmFkae+/ve+/vW8nLFxuICAgICAgJ0luZm9ybWHvv73vv71vJywgJ09yZ2FuaXph77+977+9bycsICdOYe+/ve+/vW8nLCAnRWR1Y2Hvv73vv71vJywgJ0NvbnN0cnXvv73vv71vJ1xuICAgIF07XG5cbiAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcblxuICAgIHJlbmRlcihcbiAgICAgIDxMYW5ndWFnZVByb3ZpZGVyPlxuICAgICAgICA8ZGl2PlxuICAgICAgICAgIHt0ZXh0V2l0aERpYWNyaXRpY3MubWFwKCh0ZXh0LCBpKSA9PiAoXG4gICAgICAgICAgICA8c3BhbiBrZXk9e2l9IGRhdGEtdGVzdGlkPXtgZGlhY3JpdGljLSR7aX1gfT57dGV4dH08L3NwYW4+XG4gICAgICAgICAgKSl9XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9MYW5ndWFnZVByb3ZpZGVyPlxuICAgICk7XG5cbiAgICBjb25zdCByZW5kZXJUaW1lID0gcGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWU7XG4gICAgZXhwZWN0KHJlbmRlclRpbWUpLnRvQmVMZXNzVGhhbihwZXJmb3JtYW5jZVRocmVzaG9sZHMucmVuZGVyVGltZS5nb29kKTtcblxuICAgIC8vIFZlcmlmeSBhbGwgZGlhY3JpdGljcyByZW5kZXJlZCBjb3JyZWN0bHlcbiAgICB0ZXh0V2l0aERpYWNyaXRpY3MuZm9yRWFjaCgodGV4dCwgaSkgPT4ge1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRlc3RJZChgZGlhY3JpdGljLSR7aX1gKSkudG9IYXZlVGV4dENvbnRlbnQodGV4dCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QoJ1BvcnR1Z3Vlc2UgZmxhZyBjb2xvcnMgcmVuZGVyIGVmZmljaWVudGx5JywgKCkgPT4ge1xuICAgIGNvbnN0IHBvcnR1Z2FsQ29sb3JzID0gWycjMDA2NjAwJywgJyNGRjAwMDAnLCAnI0ZGRDcwMCddOyAvLyBHcmVlbiwgUmVkLCBHb2xkXG5cbiAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcblxuICAgIHJlbmRlcihcbiAgICAgIDxkaXY+XG4gICAgICAgIHtwb3J0dWdhbENvbG9ycy5tYXAoKGNvbG9yLCBpKSA9PiAoXG4gICAgICAgICAgPGRpdlxuICAgICAgICAgICAga2V5PXtpfVxuICAgICAgICAgICAgZGF0YS10ZXN0aWQ9e2Bjb2xvci0ke2l9YH1cbiAgICAgICAgICAgIHN0eWxlPXt7IGJhY2tncm91bmRDb2xvcjogY29sb3IsIHdpZHRoOiAxMDAsIGhlaWdodDogNTAgfX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICBQb3J0dWd1ZXNlIENvbG9yIHtpICsgMX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSl9XG4gICAgICA8L2Rpdj5cbiAgICApO1xuXG4gICAgY29uc3QgcmVuZGVyVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgIGV4cGVjdChyZW5kZXJUaW1lKS50b0JlTGVzc1RoYW4ocGVyZm9ybWFuY2VUaHJlc2hvbGRzLnJlbmRlclRpbWUuZ29vZCk7XG5cbiAgICAvLyBWZXJpZnkgYWxsIGNvbG9ycyByZW5kZXJlZFxuICAgIHBvcnR1Z2FsQ29sb3JzLmZvckVhY2goKF8sIGkpID0+IHtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXN0SWQoYGNvbG9yLSR7aX1gKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwibmFtZXMiOlsiamVzdCIsIm1vY2siLCJ1c2VSb3V0ZXIiLCJwdXNoIiwiZm4iLCJwcmVmZXRjaCIsInVzZVNlYXJjaFBhcmFtcyIsImdldCIsIk1vY2tQb3J0dWd1ZXNlQ29tcG9uZW50IiwiZGl2IiwiZGF0YS10ZXN0aWQiLCJNb2NrRXZlbnRDYXJkIiwiTW9ja0N1bHR1cmFsR2FsbGVyeSIsImRlc2NyaWJlIiwicGVyZm9ybWFuY2VUZXN0ZXIiLCJiZWZvcmVFYWNoIiwiUGVyZm9ybWFuY2VUZXN0ZXIiLCJkb2N1bWVudCIsImRvY3VtZW50RWxlbWVudCIsImNsYXNzTmFtZSIsImFmdGVyRWFjaCIsInRlc3QiLCJzdGFydFRpbWluZyIsImNvbXBvbmVudCIsInJlbmRlciIsIkxhbmd1YWdlUHJvdmlkZXIiLCJyZW5kZXJUaW1lIiwibWVhc3VyZVJlbmRlclRpbWUiLCJleHBlY3QiLCJ0b0JlTGVzc1RoYW4iLCJwZXJmb3JtYW5jZVRocmVzaG9sZHMiLCJhY2NlcHRhYmxlIiwic2NyZWVuIiwiZ2V0QnlUZXN0SWQiLCJ0b0JlSW5UaGVEb2N1bWVudCIsInN0YXJ0VGltZSIsInBlcmZvcm1hbmNlIiwibm93IiwiY29tcG9uZW50cyIsIkFycmF5IiwiZnJvbSIsImxlbmd0aCIsIl8iLCJpIiwicG9vciIsImdldEFsbEJ5VGV4dCIsInRvSGF2ZUxlbmd0aCIsInN0YXRzIiwicG9ydHVndWVzZUJ1bmRsZU9wdGltaXplciIsImdldE9wdGltaXphdGlvblN0YXRzIiwiaW5pdFRpbWUiLCJ0b0hhdmVQcm9wZXJ0eSIsImxvYWRQb3J0dWd1ZXNlQ29udGVudEJ1bmRsZSIsImxvYWRUaW1lIiwiZ29vZCIsImNyaXRpY2FsUHJvbWlzZSIsImxvd1ByaW9yaXR5UHJvbWlzZSIsImNyaXRpY2FsVGltZSIsInRvdGFsVGltZSIsInRvQmVHcmVhdGVyVGhhbiIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5Iiwid2luZG93Iiwid3JpdGFibGUiLCJjb25maWd1cmFibGUiLCJ2YWx1ZSIsIm5hdmlnYXRvciIsImVmZmVjdGl2ZVR5cGUiLCJzYXZlRGF0YSIsIm9wdGltaXplRm9yTW9iaWxlIiwib3B0aW1pemF0aW9uVGltZSIsIm9wdGltaXphdGlvbnNBcHBsaWVkIiwidG9Db250YWluIiwiYnV0dG9uIiwiYSIsImhyZWYiLCJyb2xlIiwibGluayIsInBvcnR1Z3Vlc2VUZXh0IiwiaDEiLCJwIiwic3BhbiIsImdldEJ5VGV4dCIsImNhdGVnb3JpZXMiLCJsb2FkVGltZXMiLCJjYXRlZ29yeSIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsIk1hdGgiLCJyYW5kb20iLCJ2YWx1ZXMiLCJmb3JFYWNoIiwidGltZSIsImtleXMiLCJpbml0aWFsTWVtb3J5IiwibWVtb3J5IiwidXNlZEpTSGVhcFNpemUiLCJ1bm1vdW50IiwiZmluYWxNZW1vcnkiLCJtZW1vcnlJbmNyZWFzZSIsImxhcmdlRGF0YVNldCIsImlkIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInNsaWNlIiwibWFwIiwiaXRlbSIsImgzIiwibm90IiwibWV0cmljcyIsImdldE1ldHJpY3MiLCJ0b0JlIiwiZXhjZWxsZW50IiwibW9iaWxlIiwidG91Y2hSZXNwb25zZVRpbWUiLCJ0ZXh0V2l0aERpYWNyaXRpY3MiLCJ0ZXh0IiwidG9IYXZlVGV4dENvbnRlbnQiLCJwb3J0dWdhbENvbG9ycyIsImNvbG9yIiwic3R5bGUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJ3aWR0aCIsImhlaWdodCJdLCJtYXBwaW5ncyI6IjtBQUtBLHNCQUFzQjtBQUN0QkEsS0FBS0MsSUFBSSxDQUFDLG1CQUFtQixJQUFPLENBQUE7UUFDbENDLFdBQVcsSUFBTyxDQUFBO2dCQUNoQkMsTUFBTUgsS0FBS0ksRUFBRTtnQkFDYkMsVUFBVUwsS0FBS0ksRUFBRTtZQUNuQixDQUFBO1FBQ0FFLGlCQUFpQixJQUFPLENBQUE7Z0JBQ3RCQyxLQUFLUCxLQUFLSSxFQUFFO1lBQ2QsQ0FBQTtJQUNGLENBQUE7Ozs7O3VCQWQrQjtrQ0FDMEI7aUNBQ3hCOzJDQUNTO0FBYTFDLDBDQUEwQztBQUMxQyxNQUFNSSwwQkFBMEIsa0JBQU0scUJBQUNDO1FBQUlDLGVBQVk7a0JBQXFCOztBQUM1RSxNQUFNQyxnQkFBZ0Isa0JBQU0scUJBQUNGO1FBQUlDLGVBQVk7a0JBQWE7O0FBQzFELE1BQU1FLHNCQUFzQixrQkFBTSxxQkFBQ0g7UUFBSUMsZUFBWTtrQkFBbUI7O0FBRXRFRyxTQUFTLDhCQUE4QjtJQUNyQyxJQUFJQztJQUVKQyxXQUFXO1FBQ1RELG9CQUFvQixJQUFJRSxtQ0FBaUI7UUFDekMseUJBQXlCO1FBQ3pCQyxTQUFTQyxlQUFlLENBQUNDLFNBQVMsR0FBRztJQUN2QztJQUVBQyxVQUFVO1FBQ1JOLG9CQUFvQjtJQUN0QjtJQUVBRCxTQUFTLG1DQUFtQztRQUMxQ1EsS0FBSyxzRUFBc0U7WUFDekVQLGtCQUFrQlEsV0FBVztZQUU3QixNQUFNQyxZQUFZO2dCQUNoQkMsSUFBQUEsYUFBTSxnQkFDSixzQkFBQ0MsaUNBQWdCOztzQ0FDZixxQkFBQ2pCO3NDQUNELHFCQUFDRztzQ0FDRCxxQkFBQ0M7OztZQUdQO1lBRUEs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