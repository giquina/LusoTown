'use client'

import { motion } from 'framer-motion'
import Image from 'next/image'
import { StarIcon } from '@heroicons/react/24/solid'
import { ChatBubbleLeftIcon } from '@heroicons/react/24/outline'
import { getImagesByCategory, getImageWithFallback, getAltTextWithFallback } from '@/lib/profileImages'
import { useLanguage } from '@/context/LanguageContext'

const testimonials = {
  en: [
    {
      name: "Carlos Silva",
      age: "28",
      location: "Camden, London",
      imageId: "carlos-silva",
      quote: "Organized my first Portuguese business networking at British Museum through LusoTown - 150 almas portuguesas appeared! Started with saudade for Portuguese business culture, now I host monthly 'Negócios & Pastéis' meetups at Casa do Bacalhau, connecting entrepreneurs over bifanas and vinho verde. From feeling isolated to building nossa business family in London!",
      rating: 5,
      relationship: "Portuguese Business Community Builder"
    },
    {
      name: "Ana Ferreira",
      age: "34", 
      location: "Stockwell, London",
      imageId: "ana-ferreira",
      quote: "Minha alma brasileira was homesick until LusoTown helped me organize Festa Junina at Vauxhall Park - 300+ Portuguese families dancing quadrilha under London sky! From missing São João in Salvador to recreating Brazilian joy with Portuguese hearts. Now nossa festa is annual tradition, mixing canjica with pastéis de nata, proving que nossa alegria conquers any London grey day!",
      rating: 5,
      relationship: "Brazilian Joy & Portuguese Heart Organizer"
    },
    {
      name: "Miguel Santos",
      age: "32",
      location: "Elephant & Castle, London", 
      imageId: "miguel-santos",
      quote: "Through LusoTown found magical fado evening at Southbank Centre that cured my London saudade. Listening to 'Lágrima' under Thames stars, surrounded by Portuguese souls sharing the same ache for home... tears of recognition, not sadness. Now we meet monthly at Taberna Real do Fado in Bermondsey, our voices joining ancient melodies. Fado taught me: saudade shared becomes love multiplied.",
      rating: 5,
      relationship: "Fado Soul & Saudade Healer"
    },
    {
      name: "Joana Silva",
      age: "29",
      location: "Canary Wharf, London",
      imageId: "joana-silva",
      quote: "Started 'Sabores da Nossa Terra' at Borough Market through LusoTown with just 20 almas and minha avó's receitas. Six months later, 500+ people queue for our pastéis de nata, bifanas, and caldeirada! Watching British faces light up tasting nossa cultura, while Portuguese hearts feel proud... this is how we keep heritage alive. From corporate banker to keeper of Portuguese flavors!",
      rating: 5,
      relationship: "Guardian of Portuguese Flavors"
    },
    {
      name: "Pedro Costa",
      age: "41",
      location: "Hampstead, London",
      imageId: "pedro-costa",
      quote: "Lost in London's tech scene until LusoTown showed me 'Programadores Portugueses.' From Shoreditch startup pitches over galão to City networking with bifanas and Super Bock - finally found tech minds who understand both coding brilliance and Portuguese soul. We solve algorithms while sharing saudade, debug code while preserving cultura. Technology with coração português!",
      rating: 5,
      relationship: "Tech Mind & Portuguese Heart"
    },
    {
      name: "Teresa Rodrigues",
      age: "37",
      location: "Brixton, London",
      imageId: "teresa-rodrigues",
      quote: "From playing morna alone in my Brixton flat, missing Cabo Verde's musical soul, to organizing 'Noites de Cabo Verde' for 10 homesick friends. LusoTown connected me with Portuguese music lovers hungry for African rhythms. Now 'Festival da Música Lusófona' at Alexandra Palace draws 400+ souls dancing to morna, fado, kizomba, and samba. Music heals saudade, community amplifies joy!",
      rating: 5,
      relationship: "Cape Verdean Music & Portuguese Soul Keeper"
    },
    {
      name: "Ricardo Oliveira",
      age: "30",
      location: "Greenwich, London",
      imageId: "ricardo-oliveira",
      quote: "I organize Portuguese football viewing parties at local pubs and barbecues in Greenwich Park. Started with 8 friends, now we're 200+ strong! LusoTown connected me with Portuguese families across London.",
      rating: 5,
      relationship: "Sports & Social Event Organizer"
    },
    {
      name: "Fernanda Santos",
      age: "26",
      location: "King's Cross, London",
      imageId: "fernanda-santos",
      quote: "Found amazing Portuguese language exchange events and dance workshops through LusoTown. As a Brazilian in London, the platform helped me discover our thriving Portuguese-speaking community here.",
      rating: 5,
      relationship: "Language & Dance Event Attendee"
    },
    {
      name: "António Pereira",
      age: "45",
      location: "City of London",
      imageId: "antonio-pereira",
      quote: "Organized the first Portuguese business expo at ExCeL London using LusoTown's event tools. Connected 80+ Portuguese entrepreneurs and attracted 300 attendees from across the UK.",
      rating: 5,
      relationship: "Business Expo Organizer"
    }
  ],
  pt: [
    {
      name: "Carlos Silva",
      age: "28",
      location: "Camden, Londres",
      imageId: "carlos-silva",
      quote: "Organizei o primeiro networking português no British Museum pela LusoTown - apareceram 150 almas portuguesas! Comecei com saudade da cultura empresarial portuguesa, agora organizo 'Negócios & Pastéis' mensais na Casa do Bacalhau, conectando empreendedores com bifanas e vinho verde. De isolado a construir nossa família empresarial em Londres!",
      rating: 5,
      relationship: "Construtor da Comunidade Empresarial Portuguesa"
    },
    {
      name: "Ana Ferreira",
      age: "34", 
      location: "Stockwell, Londres",
      imageId: "ana-ferreira",
      quote: "Como coordenadora cultural, a LusoTown ajudou-me a organizar celebrações de Festa Junina no Vauxhall Park que juntaram 300+ famílias portuguesas. A plataforma tornou a promoção e construção de comunidade sem esforço.",
      rating: 5,
      relationship: "Organizadora de Eventos Culturais"
    },
    {
      name: "Miguel Santos",
      age: "32",
      location: "Elephant & Castle, Londres", 
      imageId: "miguel-santos",
      quote: "Encontrei uma noite de fado incrível no Southbank Centre através da LusoTown. Conectei-me com falantes de português de toda Londres que se tornaram amigos para a vida. A comunidade londrina é incrível!",
      rating: 5,
      relationship: "Membro da Comunidade Portuguesa de Londres"
    },
    {
      name: "Joana Silva",
      age: "29",
      location: "Canary Wharf, Londres",
      imageId: "joana-silva",
      quote: "Comecei a organizar festivais de comida portuguesa no Borough Market usando a LusoTown. De 20 pessoas para 500+ participantes em apenas 6 meses. O apoio da comunidade portuguesa de Londres tem sido incrível!",
      rating: 5,
      relationship: "Organizadora de Festivais Gastronómicos"
    },
    {
      name: "Pedro Costa",
      age: "41",
      location: "Hampstead, Londres",
      imageId: "pedro-costa",
      quote: "Através da LusoTown, descobri encontros de tecnologia portugueses acontecendo por Londres. De eventos em Shoreditch a networking na City - sempre encontro a minha comunidade tech portuguesa!",
      rating: 5,
      relationship: "Profissional de Tecnologia & Participante em Eventos"
    },
    {
      name: "Teresa Rodrigues",
      age: "37",
      location: "Brixton, Londres",
      imageId: "teresa-rodrigues",
      quote: "De organizar pequenas noites de música cabo-verdiana a organizar festivais culturais portugueses de 400 pessoas no Alexandra Palace - a LusoTown deu-me as ferramentas e comunidade para crescer além dos meus sonhos.",
      rating: 5,
      relationship: "Organizadora de Eventos Musicais & Culturais"
    },
    {
      name: "Ricardo Oliveira",
      age: "30",
      location: "Greenwich, Londres",
      imageId: "ricardo-oliveira",
      quote: "Organizo festas para ver futebol português em pubs locais e churrascos no Greenwich Park. Começámos com 8 amigos, agora somos 200+ fortes! A LusoTown conectou-me com famílias portuguesas por toda Londres.",
      rating: 5,
      relationship: "Organizador de Eventos Desportivos & Sociais"
    },
    {
      name: "Fernanda Santos",
      age: "26",
      location: "King's Cross, Londres",
      imageId: "fernanda-santos",
      quote: "Encontrei eventos incríveis de intercâmbio de língua portuguesa e workshops de dança através da LusoTown. Como brasileira em Londres, a plataforma ajudou-me a descobrir a nossa próspera comunidade de língua portuguesa aqui.",
      rating: 5,
      relationship: "Participante de Eventos de Língua & Dança"
    },
    {
      name: "António Pereira",
      age: "45",
      location: "City de Londres",
      imageId: "antonio-pereira",
      quote: "Organizei a primeira expo de negócios portuguesa no ExCeL London usando as ferramentas de eventos da LusoTown. Conectei 80+ empreendedores portugueses e atraí 300 participantes de todo o Reino Unido.",
      rating: 5,
      relationship: "Organizador de Expo de Negócios"
    }
  ]
}

const containerVariants = {
  hidden: { opacity: 0 },
  visible: {
    opacity: 1,
    transition: {
      staggerChildren: 0.15
    }
  }
}

const cardVariants = {
  hidden: { opacity: 0, y: 30 },
  visible: {
    opacity: 1,
    y: 0,
    transition: {
      duration: 0.6,
      ease: "easeOut"
    }
  }
}

export default function TestimonialsNew() {
  const { t, language } = useLanguage()
  const currentTestimonials = testimonials[language as keyof typeof testimonials] || testimonials.en

  return (
    <section className="py-20 bg-gradient-to-br from-white via-gray-50 to-secondary-50 relative overflow-hidden">
      {/* Background decorations */}
      <div className="absolute inset-0">
        <div className="absolute top-20 left-10 w-40 h-40 bg-gradient-to-br from-accent-200 via-coral-100 to-secondary-100 rounded-full opacity-30 animate-pulse"></div>
        <div className="absolute bottom-20 right-10 w-32 h-32 bg-gradient-to-tr from-secondary-200 via-accent-100 to-action-100 rounded-full opacity-25 animate-pulse animation-delay-400"></div>
        <div className="absolute top-1/2 left-1/2 w-56 h-56 bg-gradient-to-r from-accent-100 via-secondary-100 to-coral-100 rounded-full opacity-20 transform -translate-x-1/2 -translate-y-1/2 animate-pulse animation-delay-200"></div>
        <div className="absolute top-1/4 left-1/4 w-6 h-6 bg-secondary-400 rounded-full opacity-40"></div>
        <div className="absolute top-3/4 right-1/3 w-4 h-4 bg-accent-400 rounded-full"></div>
        <div className="absolute bottom-1/3 left-2/3 w-3 h-3 bg-action-400 rounded-full opacity-50"></div>
      </div>

      <div className="container-width section-padding relative z-10">
        {/* Section Header */}
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          whileInView={{ opacity: 1, y: 0 }}
          viewport={{ once: true }}
          transition={{ duration: 0.8 }}
          className="text-center max-w-3xl mx-auto mb-16"
        >
          <div className="inline-flex items-center gap-2 bg-white/80 backdrop-blur-sm rounded-full px-4 py-2 text-primary-600 font-medium mb-6 border border-white/30">
            <StarIcon className="h-4 w-4 text-yellow-400" />
            {t('testimonials.badge')}
          </div>
          <h2 className="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold text-gray-900 mb-6">
            <span className="gradient-text">{t('testimonials.title')}</span>
          </h2>
          <p className="text-base sm:text-lg md:text-xl text-gray-600 leading-relaxed">
            {t('testimonials.subtitle')}
          </p>
        </motion.div>

        {/* Testimonials Grid - Enhanced Multi-Column Responsive Layout */}
        <motion.div
          variants={containerVariants}
          initial="hidden"
          whileInView="visible"
          viewport={{ once: true }}
          className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3 gap-4 sm:gap-6 md:gap-7 lg:gap-8 xl:gap-10"
        >
          {currentTestimonials.map((testimonial, index) => (
            <motion.div
              key={testimonial.name}
              variants={cardVariants}
              className="group"
            >
              <div className="card p-4 sm:p-6 md:p-7 lg:p-8 h-full hover:scale-105 transition-all duration-300 group-hover:shadow-2xl bg-white/80 backdrop-blur-sm border border-white/50">
                {/* Quote Icon */}
                <div className="mb-6">
                  <ChatBubbleLeftIcon className="h-8 w-8 text-primary-300" />
                </div>

                {/* Rating */}
                <div className="flex gap-1 mb-4">
                  {[...Array(testimonial.rating)].map((_, i) => (
                    <StarIcon key={i} className="h-5 w-5 text-yellow-400" />
                  ))}
                </div>

                {/* Testimonial Text */}
                <blockquote className="text-gray-700 leading-relaxed mb-6 text-sm sm:text-base">
                  "{testimonial.quote}"
                </blockquote>

                {/* Author Info */}
                <div className="flex items-center gap-4">
                  <div className="w-14 h-14 rounded-full overflow-hidden shadow-lg ring-2 ring-white">
                    <Image 
                      src={getImageWithFallback(testimonial.imageId)} 
                      alt={getAltTextWithFallback(testimonial.imageId)}
                      className="w-full h-full object-cover"
                      loading="lazy"
                    />
                  </div>
                  <div>
                    <h4 className="font-semibold text-gray-900">
                      {testimonial.name}, {testimonial.age}
                    </h4>
                    <p className="text-sm text-gray-500 mb-1">
                      {testimonial.location}
                    </p>
                    <p className="text-xs text-primary-600 font-medium">
                      {testimonial.relationship}
                    </p>
                  </div>
                </div>
              </div>
            </motion.div>
          ))}
        </motion.div>

        {/* Community Showcase */}
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          whileInView={{ opacity: 1, y: 0 }}
          viewport={{ once: true }}
          transition={{ delay: 0.4, duration: 0.8 }}
          className="mt-16"
        >
          <div className="text-center mb-12">
            <h3 className="text-2xl sm:text-3xl font-bold text-gray-900 mb-4">
              Meet Your <span className="gradient-text">London Portuguese Community</span>
            </h3>
            <p className="text-lg text-gray-600 max-w-2xl mx-auto">
              Join thousands of Portuguese speakers across London who are organizing events, building communities, and connecting throughout the city.
            </p>
          </div>
          
          {/* Photo Grid - Enhanced Multi-Column Layout */}
          <div className="grid grid-cols-2 xs:grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-8 gap-2 xs:gap-3 sm:gap-4 md:gap-5 mb-12">
            {getImagesByCategory('community').map((member, index) => (
              <motion.div
                key={member.id}
                initial={{ opacity: 0, scale: 0.8 }}
                whileInView={{ opacity: 1, scale: 1 }}
                viewport={{ once: true }}
                transition={{ delay: 0.1 * index, duration: 0.5 }}
                whileHover={{ scale: 1.05, y: -5 }}
                className="aspect-square rounded-2xl overflow-hidden shadow-lg ring-2 ring-white hover:ring-primary-200 transition-all duration-300"
              >
                <Image 
                  src={member.path}
                  alt={member.alt}
                  className="w-full h-full object-cover"
                  loading="lazy"
                />
              </motion.div>
            ))}
          </div>
        </motion.div>

        {/* Community Stats */}
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          whileInView={{ opacity: 1, y: 0 }}
          viewport={{ once: true }}
          transition={{ delay: 0.6, duration: 0.8 }}
          className="mt-16 text-center"
        >
          <div className="bg-white/80 backdrop-blur-sm rounded-2xl p-8 border border-white/50 shadow-lg">
            <div className="grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6 md:gap-8">
              <div>
                <p className="text-4xl font-bold text-primary-500 mb-2">4.9/5</p>
                <p className="text-gray-600">Average Rating</p>
              </div>
              <div>
                <p className="text-4xl font-bold text-secondary-500 mb-2">8K+</p>
                <p className="text-gray-600">London Members</p>
              </div>
              <div>
                <p className="text-4xl font-bold text-accent-500 mb-2">32+</p>
                <p className="text-gray-600">London Boroughs</p>
              </div>
            </div>
          </div>
        </motion.div>

        {/* Call to Action */}
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          whileInView={{ opacity: 1, y: 0 }}
          viewport={{ once: true }}
          transition={{ delay: 0.6, duration: 0.8 }}
          className="text-center mt-12"
        >
          <h3 className="text-2xl font-semibold text-gray-900 mb-4">
            Ready to Connect with Portuguese Speakers in London?
          </h3>
          <p className="text-lg text-gray-600 mb-8 max-w-2xl mx-auto">
            Join thousands of Portuguese speakers across London who are organizing events, building communities, and creating lasting connections throughout the city.
          </p>
          <a href="/signup" className="btn-primary text-lg px-10 py-4 shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-200 inline-block">
            Join the London Community
          </a>
        </motion.div>
      </div>
    </section>
  )
}