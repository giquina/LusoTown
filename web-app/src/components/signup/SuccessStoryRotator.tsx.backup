"use client";\n\nimport { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport Image from 'next/image';\nimport { useLanguage } from '@/context/LanguageContext';\nimport { \n  HeartIcon, \n  BuildingOffice2Icon, \n  StarIcon,\n  MusicalNoteIcon\n} from '@heroicons/react/24/outline';\nimport { getImageWithFallback } from '@/lib/profileImages';\n\ninterface SuccessStory {\n  id: string;\n  name: string;\n  age: string;\n  location: string;\n  story: {\n    en: string;\n    pt: string;\n  };\n  type: 'business' | 'romantic' | 'cultural';\n  avatar: string;\n  result?: string;\n  timeframe?: string;\n}\n\ninterface SuccessStoryRotatorProps {\n  selectedAudience?: 'business' | 'romantic' | 'both' | '';\n  className?: string;\n}\n\nexport function SuccessStoryRotator({ \n  selectedAudience = '', \n  className = '' \n}: SuccessStoryRotatorProps) {\n  const { language } = useLanguage();\n  \n  const allStories: SuccessStory[] = [\n    // Business Success Stories\n    {\n      id: 'carlos-entrepreneur',\n      name: 'Carlos M.',\n      age: '34',\n      location: 'Canary Wharf',\n      story: {\n        en: \"Connected with 3 Portuguese business partners through LusoTown's elite networking. Now running a successful import business between London and Porto!\",\n        pt: \"Conectei-me com 3 parceiros empresariais portugueses através da rede de elite da LusoTown. Agora dirijo um negócio de importação bem-sucedido entre Londres e Porto!\"\n      },\n      type: 'business',\n      avatar: getImageWithFallback('carlos-entrepreneur'),\n      result: '£2M+ annual revenue',\n      timeframe: '6 months'\n    },\n    {\n      id: 'ana-tech',\n      name: 'Ana S.',\n      age: '28',\n      location: 'Shoreditch',\n      story: {\n        en: \"Found my co-founder at a LusoTown tech networking event. Our fintech startup just got Series A funding from Portuguese investors!\",\n        pt: \"Encontrei meu co-fundador num evento de networking de tecnologia da LusoTown. Nossa startup de fintech acabou de receber financiamento Série A de investidores portugueses!\"\n      },\n      type: 'business',\n      avatar: getImageWithFallback('ana-tech'),\n      result: '€5M Series A',\n      timeframe: '8 months'\n    },\n    {\n      id: 'ricardo-consulting',\n      name: 'Ricardo L.',\n      age: '41',\n      location: 'City of London',\n      story: {\n        en: \"LusoTown's executive network opened doors I never imagined. Landed 5 major Portuguese corporate clients for my consulting firm.\",\n        pt: \"A rede executiva da LusoTown abriu portas que nunca imaginei. Consegui 5 grandes clientes corporativos portugueses para minha empresa de consultoria.\"\n      },\n      type: 'business',\n      avatar: getImageWithFallback('ricardo-consulting'),\n      result: '500% revenue growth',\n      timeframe: '1 year'\n    },\n    \n    // Romantic Success Stories\n    {\n      id: 'maria-love',\n      name: 'Maria & João',\n      age: '29 & 32',\n      location: 'Stockwell',\n      story: {\n        en: \"Met at a LusoTown Fado night. He understood my saudade, I fell for his guitar playing. Married last month in a beautiful Portuguese ceremony!\",\n        pt: \"Conhecemo-nos numa noite de Fado da LusoTown. Ele entendeu a minha saudade, eu apaixonei-me pelo seu tocar guitarra. Casámos no mês passado numa linda cerimónia portuguesa!\"\n      },\n      type: 'romantic',\n      avatar: getImageWithFallback('maria-joao-couple'),\n      result: 'Married 2024',\n      timeframe: '14 months'\n    },\n    {\n      id: 'sofia-romance',\n      name: 'Sofia P.',\n      age: '26',\n      location: 'Camden',\n      story: {\n        en: \"Found my soulmate through LusoTown's cultural compatibility matching. He's from Cape Verde, I'm from Portugal - our love transcends islands!\",\n        pt: \"Encontrei a minha alma gêmea através da compatibilidade cultural da LusoTown. Ele é de Cabo Verde, eu de Portugal - o nosso amor transcende ilhas!\"\n      },\n      type: 'romantic',\n      avatar: getImageWithFallback('sofia-romance'),\n      result: 'Engaged',\n      timeframe: '9 months'\n    },\n    {\n      id: 'pedro-connection',\n      name: 'Pedro & Luiza',\n      age: '35 & 28',\n      location: 'Kensington',\n      story: {\n        en: \"Both divorced, both Portuguese heritage. LusoTown helped us find love again with someone who truly understands our culture and values.\",\n        pt: \"Ambos divorciados, ambos de herança portuguesa. LusoTown ajudou-nos a encontrar o amor novamente com alguém que realmente entende nossa cultura e valores.\"\n      },\n      type: 'romantic',\n      avatar: getImageWithFallback('pedro-luiza-couple'),\n      result: 'Living together',\n      timeframe: '11 months'\n    },\n    \n    // Cultural Success Stories\n    {\n      id: 'teresa-cultural',\n      name: 'Teresa F.',\n      age: '45',\n      location: 'Vauxhall',\n      story: {\n        en: \"My children were losing touch with Portuguese culture. LusoTown's family events brought our heritage back to life. They speak Portuguese fluently now!\",\n        pt: \"Os meus filhos estavam a perder o contacto com a cultura portuguesa. Os eventos familiares da LusoTown trouxeram a nossa herança de volta à vida. Agora falam português fluentemente!\"\n      },\n      type: 'cultural',\n      avatar: getImageWithFallback('teresa-family'),\n      result: '3 children fluent',\n      timeframe: '2 years'\n    },\n    {\n      id: 'miguel-musician',\n      name: 'Miguel C.',\n      age: '31',\n      location: 'Greenwich',\n      story: {\n        en: \"Started performing Fado at LusoTown events. Now have a record deal and performing at major UK venues. Dreams do come true!\",\n        pt: \"Comecei a cantar Fado nos eventos da LusoTown. Agora tenho um contrato discográfico e atuo em grandes venues do Reino Unido. Os sonhos tornam-se realidade!\"\n      },\n      type: 'cultural',\n      avatar: getImageWithFallback('miguel-musician'),\n      result: 'Record deal',\n      timeframe: '18 months'\n    }\n  ];\n\n  // Filter stories based on selected audience\n  const getFilteredStories = () => {\n    if (selectedAudience === 'business') {\n      return allStories.filter(story => story.type === 'business');\n    } else if (selectedAudience === 'romantic') {\n      return allStories.filter(story => story.type === 'romantic');\n    } else if (selectedAudience === 'both') {\n      return allStories.filter(story => story.type === 'business' || story.type === 'romantic');\n    } else {\n      return allStories; // Show all stories\n    }\n  };\n\n  const stories = getFilteredStories();\n  const [currentIndex, setCurrentIndex] = useState(0);\n\n  useEffect(() => {\n    if (stories.length === 0) return;\n    \n    const timer = setInterval(() => {\n      setCurrentIndex((prev) => (prev + 1) % stories.length);\n    }, 5000); // 5 seconds per story\n    \n    return () => clearInterval(timer);\n  }, [stories.length]);\n\n  if (stories.length === 0) return null;\n\n  const currentStory = stories[currentIndex];\n  \n  const getStoryIcon = (type: string) => {\n    switch (type) {\n      case 'business':\n        return <BuildingOffice2Icon className=\"h-5 w-5 text-blue-500\" />;\n      case 'romantic':\n        return <HeartIcon className=\"h-5 w-5 text-red-500\" />;\n      case 'cultural':\n        return <MusicalNoteIcon className=\"h-5 w-5 text-purple-500\" />;\n      default:\n        return <StarIcon className=\"h-5 w-5 text-yellow-500\" />;\n    }\n  };\n\n  const getTypeLabel = (type: string) => {\n    switch (type) {\n      case 'business':\n        return language === 'pt' ? 'Sucesso Empresarial' : 'Business Success';\n      case 'romantic':\n        return language === 'pt' ? 'Amor Encontrado' : 'Love Found';\n      case 'cultural':\n        return language === 'pt' ? 'Herança Cultural' : 'Cultural Heritage';\n      default:\n        return language === 'pt' ? 'Sucesso' : 'Success';\n    }\n  };\n\n  return (\n    <div className={`${className}`}>\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.6 }}\n        className=\"mb-4\"\n      >\n        <h3 className=\"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2\">\n          <StarIcon className=\"h-5 w-5 text-yellow-500\" />\n          {language === 'pt' ? 'Histórias de Sucesso' : 'Success Stories'}\n        </h3>\n      </motion.div>\n\n      <div className=\"relative\">\n        <AnimatePresence mode=\"wait\">\n          <motion.div\n            key={currentStory.id}\n            initial={{ opacity: 0, x: 20 }}\n            animate={{ opacity: 1, x: 0 }}\n            exit={{ opacity: 0, x: -20 }}\n            transition={{ duration: 0.5 }}\n            className=\"bg-white/80 backdrop-blur-sm rounded-xl p-6 border border-white/70 shadow-lg\"\n          >\n            {/* Story Type Badge */}\n            <div className=\"flex items-center justify-between mb-4\">\n              <div className=\"flex items-center gap-2 bg-gray-100 rounded-full px-3 py-1 text-xs font-medium\">\n                {getStoryIcon(currentStory.type)}\n                <span>{getTypeLabel(currentStory.type)}</span>\n              </div>\n              \n              {currentStory.result && (\n                <div className=\"text-xs font-bold text-green-600 bg-green-50 px-2 py-1 rounded-full\">\n                  {currentStory.result}\n                </div>\n              )}\n            </div>\n\n            {/* User Info */}\n            <div className=\"flex items-start gap-4 mb-4\">\n              <div className=\"relative\">\n                <Image\n                  src={currentStory.avatar}\n                  alt={currentStory.name}\n                  width={48}\n                  height={48}\n                  className=\"w-12 h-12 rounded-full object-cover ring-2 ring-white shadow-sm\"\n                />\n                {/* Success indicator */}\n                <div className=\"absolute -bottom-1 -right-1 w-5 h-5 bg-green-500 rounded-full border-2 border-white flex items-center justify-center\">\n                  <span className=\"text-white text-xs font-bold\">✓</span>\n                </div>\n              </div>\n              \n              <div className=\"flex-1\">\n                <div className=\"flex items-center gap-2 mb-1\">\n                  <h4 className=\"font-semibold text-gray-900\">{currentStory.name}</h4>\n                  <span className=\"text-sm text-gray-500\">• {currentStory.age}</span>\n                  {currentStory.timeframe && (\n                    <span className=\"text-xs text-blue-600 bg-blue-50 px-2 py-0.5 rounded-full\">\n                      {currentStory.timeframe}\n                    </span>\n                  )}\n                </div>\n                <p className=\"text-xs text-gray-500\">{currentStory.location}</p>\n              </div>\n            </div>\n\n            {/* Story Content */}\n            <blockquote className=\"text-sm text-gray-700 italic leading-relaxed mb-4\">\n              \"{currentStory.story[language]}\"\n            </blockquote>\n            \n            {/* Rating */}\n            <div className=\"flex items-center gap-1\">\n              {[...Array(5)].map((_, i) => (\n                <StarIcon key={i} className=\"w-4 h-4 text-yellow-400 fill-current\" />\n              ))}\n              <span className=\"text-xs text-gray-500 ml-2\">\n                {language === 'pt' ? 'Verificado' : 'Verified'}\n              </span>\n            </div>\n          </motion.div>\n        </AnimatePresence>\n\n        {/* Story Navigation Dots */}\n        <div className=\"flex items-center justify-center gap-2 mt-4\">\n          {stories.map((_, index) => (\n            <button\n              key={index}\n              onClick={() => setCurrentIndex(index)}\n              className={`w-2 h-2 rounded-full transition-colors duration-300 ${\n                index === currentIndex ? 'bg-primary-500' : 'bg-gray-300 hover:bg-gray-400'\n              }`}\n              aria-label={`Story ${index + 1}`}\n            />\n          ))}\n        </div>\n        \n        {/* Auto-progression indicator */}\n        <div className=\"mt-2\">\n          <div className=\"h-1 bg-gray-200 rounded-full overflow-hidden\">\n            <motion.div\n              className=\"h-full bg-primary-500\"\n              initial={{ width: '0%' }}\n              animate={{ width: '100%' }}\n              transition={{ duration: 5, ease: 'linear' }}\n              key={currentIndex}\n            />\n          </div>\n        </div>\n      </div>\n\n      {/* CTA based on story type */}\n      <motion.div\n        initial={{ opacity: 0 }}\n        animate={{ opacity: 1 }}\n        transition={{ delay: 0.5, duration: 0.5 }}\n        className=\"mt-6 text-center\"\n      >\n        <p className=\"text-sm text-gray-600 mb-3\">\n          {language === 'pt' \n            ? 'Sua história de sucesso começa aqui' \n            : 'Your success story starts here'\n          }\n        </p>\n        \n        <div className=\"flex items-center justify-center gap-4 text-xs text-gray-500\">\n          <div className=\"flex items-center gap-1\">\n            <div className=\"w-2 h-2 bg-green-500 rounded-full\" />\n            <span>{language === 'pt' ? 'Verificado' : 'Verified'}</span>\n          </div>\n          <div className=\"flex items-center gap-1\">\n            <div className=\"w-2 h-2 bg-blue-500 rounded-full\" />\n            <span>{language === 'pt' ? 'Real' : 'Real'}</span>\n          </div>\n          <div className=\"flex items-center gap-1\">\n            <div className=\"w-2 h-2 bg-purple-500 rounded-full\" />\n            <span>{language === 'pt' ? 'Recente' : 'Recent'}</span>\n          </div>\n        </div>\n      </motion.div>\n    </div>\n  );\n}\n\nexport default SuccessStoryRotator;